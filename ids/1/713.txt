* [CODE(DOMi)@en[Document]] オブジェクト (DOM)

[2] [CODE(DOM)[Document]] 界面は、 [[HTML]] 又は [[XML]]
の文書自体を表します。

[CODE(DOM)[Document]] は、
文書中の全ての[[節]]の大元の[[根]]です。新しい節を作るには、
[CODE(DOMi)[Document]] の method を使うことが出来ます。

[1] [RUBYB[文書節] [Document node]]の子になれる[[節]]は:
:[[Element]]:最大1個 [DOM1]
:[[ProcessingInstruction]]:[DOM1]
:[[Comment]]:[DOM1]
:[[DocumentType]]:[DOM1]

[3] [[DOM0]] の [[JavaScript]] 束縛 (HTML の [[script]]
要素の中などで使う場合。) では、物体
[CODE(JS)[window.document]] が当該窓で表示中の文書を表します。 
この [CODE(JS)[document]] 物体は DOM の [CODE(DOMi)[Document]]
界面の実現値です。

DOM の[[節]]の [CODE(DOMattr)[[[ownerDocument]]]]
は、その節が所属する文書 ([CODE(DOM)[Document]])
を返します。
- [5] [CODE(DOM)[Document]] 物体を作る方法は、 DOM 1 の範囲ではありません。 DOM 2 [WEAK[(で、 HTML のみの実装でない)]] なら、 [CODE[[VAR(DOMi)[[[DOMImplementation]]]].[CODE(DOMmethod)[[[createDocument]]]]]] で作成できます。
- [6] >>5 その他にも、実装によってそれぞれ [CODE(DOM)[Document]] 物体を作ったり取得したりする方法があるかもしれません。例えば、 [[DOM0]] では、 [CODE(JS)[[CODE(DOM)[window]].[CODE(DOMattr)[document]]]] などが使えます。
- [7] [[WWWブラウザ]]のような実装では、 [CODE(DOM)[Document]] 物体で [CODE(DOMi)[Document]] 界面のみならず [CODE(DOMi)[[[DocumentView]]]] 界面も実装されていることが期待されます。

** 仕様書

[REFS[
- [10] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-03-05 09:33:40 +09:00]] 版) <https://html.spec.whatwg.org/#concept-document-window>
- [29] [CITE@en[Touch Events]] ([TIME[2013-10-12 10:35:42 +09:00]] 版) <https://dvcs.w3.org/hg/webevents/raw-file/v1/touchevents.html#h2_extensions-to-the-document-interface>
]REFS]

** メンバー

[9] 次の状態を持ちます。
[FIG(list members)[
:関連付けられた [CODE(DOMi)@en[[[Window]]]]:[[閲覧文脈]]中にある[[文書]]が持ちます [SRC[>>10]]。
:[[ready for post-load tasks]] 状態:
:[[completely loaded]] 状態:
:[[print when loaded]] フラグ:
:[[起源]]:
:[[実効スクリプト起源]]:
:[[文書のドメイン]]:
:[[active sandboxing flag set]]:
:[[forced sandboxing flag set]]:
:[CODE(DOMi)@en[[[History]]]]:
:[[latest entry]]:
]FIG]

[8] 次の動的に計算される状態があります。
[FIG(short list)[
- [[完全に活性]]
]FIG]

[33] [CODE(DOMi)@en[[[Document]]]] の中には、それを[[継承]]する[[インターフェイス]]である
[CODE(DOMi)@en[[[XMLDocument]]]] を[[実装]]するものもあります。

;; [34] [[XML文書]]がすべて [CODE(DOMi)@en[[[XMLDocument]]]] になるわけではありません。
限られた方法で作ったもののみが [CODE(DOMi)@en[[[XMLDocument]]]] となります。

[35] [CODE(DOMm)@en[[[getSVGDocument]]]] においては、
[[navigate]] において [[sniffed type]] が [CODE(MIME)@en[[[image/svg+xml]]]]
だったため作られた [CODE(DOMi)@en[[[Document]]]] かどうかで、
動作が変わります。

[18] [CITE[Results for document (an HTML document object)]] ([TIME[2009-02-28 14:01:23 +09:00]] 版) <http://suika.fam.cx/gate/test-results/list/enum-document/all>
もご覧ください。

[4] [CODE(DOMi)@en[[[Node]]]],
[CODE(DOMi)@en[[[EventTarget]]]],
[CODE(DOMi)@en[[[DocumentView]]]],
[CODE(DOMi)@en[[[DocumentWindow]]]],
[CODE(DOMi)@en[[[DocumentCSS]]]],
[CODE(DOMi)@en[[[DocumentTraversal]]]],
[CODE(DOMi)@en[[[HTMLDocument]]]],
[CODE(DOMi)@en[[[SVGDocument]]]],
[CODE(DOMi)@en[[[MathMLDocument]]]]
,[CODE(DOMa)@en[[[activeElement]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[addBinding]]]]
,[CODE(DOMm)@en[[[adoptNode]]]],[[DOM3]]
,[CODE(DOMa)@en[[[alinkColor]]]],[[DOM0]]
,[CODE(DOMa)@en[[[all]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[anchors]]]],
,[CODE(DOMa)@en[[[applets]]]],[[HTML5]]
,[CODE(DOMm)@en[[[attachEvent]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[baseUrl]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMm)@en[[[captureEvents]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMa)@en[[[charset]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[classes]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMm)@en[[[clear]]]]	,[CODE(DOMi)@en[[[Document]]]] ([[WinIE 3]])
,[CODE(DOMa)@en[[[compatMode]]]]
,[CODE(DOMa)@en[[[contentType]]]],[[DOM0]]
,[CODE(DOMm)@en[[[contextual]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMa)@en[[[cookie]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMm)@en[[[createDocumentFromUrl]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMm)@en[[[createElement]]]]	,"[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]]), [CODE(DOMi)@en[[[Document]]]] ([[DOM水準1中核]])"
,[CODE(DOMm)@en[[[CreateEventObject]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMm)@en[[[createExpression]]]],[[Gecko]]
,[CODE(DOMm)@en[[[createNodeIterator]]]],[[DOM2]]
,[CODE(DOMm)@en[[[createNSResolver]]]],[[DOM3]]
,[CODE(DOMm)@en[[[createRange]]]],[[DOM2]]
,[CODE(DOMm)@en[[[createRenderStyle]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMm)@en[[[createStyleSheet]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
- [CODE(DOMm)@en[[[createTouch]]]]
- [CODE(DOMm)@en[[[createTouchList]]]]
,[CODE(DOMa)@en[[[defaultCharset]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[detachEvent]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[dir]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,読取専用属性	,[[doctype]]	,文書型	,[DOM1]
,[CODE(DOMa)@en[[[domain]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.1]])
,[CODE(DOMm)@en[[[elementFromPoint]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[enableDownload]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMm)@en[[[enableStyleSheetsForSet]]]],[[CSSOM]]
,[CODE(DOMm)@en[[[evaluate]]]]
,[CODE(DOMm)@en[[[execCommand]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[execCommandShowHelp]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[expando]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[fgColor]]]],[[HTML5]]
,[CODE(DOMa)@en[[[fileCreatedTime]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[fileModifiedTime]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[fileUpdatedTime]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[FireEvent]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[all]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[fileSize]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[focus]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMm)@en[[[getAnonymousElementByAttribute]]]],[[Gecko]]
,[CODE(DOMm)@en[[[getAnonymousNodes]]]],[[Gecko]]
,[CODE(DOMm)@en[[[getBindingParent]]]],[[Gecko]]
,[CODE(DOMm)@en[[[getBoxObjectFor]]]],[[Gecko]] (非推奨)
,[CODE(DOMm)@en[[[getElementsByClassName]]]],[[HTML5]]
,[CODE(DOMa)@en[[[getSelection]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMm)@en[[[handleEvent]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMa)@en[[[height]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMa)@en[[[ids]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,読取専用属性	,[[implementation]]	,DOM 実装	,[DOM1]
,読取専用属性	,[[documentElement]]	,文書要素	,[DOM1]
,method	,[[createElementNS]]	,要素作成	,[DOM2]
,method	,[[createDocumentFragment]]	,文書断片作成	,[DOM1]
,method	,[[createTextNode]]	,文節作成	,[DOM1]
,method	,[[createComment]]	,注釈作成	,[DOM1]
,method	,[[createCDATASection]]	,文字データ区間作成	,[DOM1]
,method	,[[createProcessingInstruction]]	,処理指令作成	,[DOM1]
,method	,[[createAttribute]]	,属性作成	,[DOM1]
,method	,[[createAttributeNS]]	,属性作成	,[DOM2]
,method	,[[createEntityReference]]	,実体参照作成	,[DOM1]
,[CODE(DOMm)@en[[[focus]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,method	,[[getElementById]]	,識別子による子要素取得	,[DOM2]
,method	,[[getElementsByTagName]]	,要素型名による子要素取得	,[DOM1]
,method	,[[getElementsByTagNameNS]]	,要素型名による子要素取得	,[DOM2]
,[CODE(DOMm)@en[[[hasFocus]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[inheritStyleSheets]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[lastStyleSheetSet]]]],[[CSSOM]]
,[CODE(DOMa)@en[[[lastModified]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMm)@en[[[loadBindingDocument]]]],[[Gecko]]
,[CODE(DOMa)@en[[[location]]]]	,"[CODE(DOMa)@en[[[document]]]] ([[JavaScript]] [[非推奨]], [[WinIE 3]])"
,[CODE(DOMa)@en[[[media]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[mimeType]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[nameProp]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[namespaces]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onactivate]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onafterupdate]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onbeforeactivate]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onbeforedeactivate]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onbeforeeditfocus]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onbeforeupdate]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[oncellchange]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onclick]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[oncontextmenu]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[oncontrolselect]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[ondataavailable]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[ondatasetchanged]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[ondatasetcomplete]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[ondblclick]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[ondeactivate]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[ondragstart]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onerrorupdate]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onfocusin]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onfocusout]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onhelp]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onkeydown]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[onkeypress]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[onkeyup]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[onload]]]],[[Opera]]
,[CODE(DOMa)@en[[[onmousedown]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[onmouseup]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMa)@en[[[onmousewheel]]]]	,[CODE(DOMi)@en[[[HTMLDocument5]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onpropertychange]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onreadystatechange]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[removeBinding]]]]
,[CODE(DOMa)@en[[[onrowexit]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onrowenter]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onrowsdelete]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onrowsinserted]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onselectionchange]]]]	,[CODE(DOMi)@en[[[HTMLDocument4]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onselectstart]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[onstop]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[parentDocument]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[parentWindow]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[plugins]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.1]])
,[CODE(DOMm)@en[[[postMessage]]]]
,[CODE(DOMa)@en[[[preferredStyleSheetSet]]]],[[CSSOM]]
,[CODE(DOMa)@en[[[protocol]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandEnabled]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandIndeterm]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandState]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandSupported]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandText]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[queryCommandValue]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMm)@en[[[recalc]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMa)@en[[[readyState]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[referrer]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.0]])
,[CODE(DOMm)@en[[[releaseCapture]]]]	,[CODE(DOMi)@en[[[HTMLDocument3]]]] ([[Trident]])
,[CODE(DOMm)@en[[[releaseEvents]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMm)@en[[[removeBinding]]]],[[Gecko]]
,[CODE(DOMm)@en[[[routeEvent]]]]	,[CODE(DOMa)@en[[[document]]]] ([[JavaScript 1.2]])
,[CODE(DOMa)@en[[[security]]]]	,[CODE(DOMi)@en[[[HTMLDocument2]]]] ([[Trident]])
,[CODE(DOMa)@en[[[selection]]]]	,[CODE(DOMi)@en