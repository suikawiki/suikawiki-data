[1] [DFN[[CODE(HTTP)[[[422]]]]]] ([DFN[[[Unprocessable Entity]]]])
は、[[要求]]の [[payload body]] に含まれているデータが構文的には正しいものの、
内容が仕様的に正しくなく処理できないことを表す[[状態符号]]です。

* 仕様書

[REFS[
- [3] '''[CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-11.2>'''
- [12] [CITE@en[RFC 5789 - PATCH Method for HTTP]] ([TIME[2014-09-22 15:11:26 +09:00]] 版) <http://tools.ietf.org/html/rfc5789#section-2.2>
]REFS]

* 意味

[4] [CODE(HTTP)[[[422]]]] は、[[鯖]]が[[要求]]の [[payload body]] の
[[MIME型]]は理解でき、構文的には正しかったものの、
記述されている指示に従って処理することはできなかったことを表す[[状態符号]]です [SRC[>>3]]。

;; [2] [[MIME型]]に対応していない時は、 [CODE(HTTP)[[[415]]]] がより適当です [SRC[>>3]]。

;; [5] [[payload body]] が構文的に正しくない時は、 [CODE(HTTP)[[[400]]]]
がより適当です [SRC[>>3]]。

[EG[
[6] 例えば [[XML]] が[[整形式]]ではあるものの、[[要素]]の構造が仕様上正しくない時に使うことができます。
]EG]

;; [11] [[整形式]]であっても[[要素]]の構造が仕様上正しくない時には [CODE(HTTP)[[[400]]]]
を返すともされており、 [CODE(HTTP)[[[422]]]] との使い分けはよくわかりません。
([[[CODE(HTTP)@en[PROPFIND]]]>>44]参照。)

;; [10] [[外部実体参照]]が含まれ、[[鯖]]がこれを拒絶したい時は、
[CODE(HTTP)[[[403]]]] を使うことになっています。

* 文脈

[13] [CODE(HTTP)@en[[[PATCH]]]] [[要求]]の [[payload body]] を理解できるものの、
処理はできない場合には、 [CODE(HTTP)[[[422]]]] [[応答]]を返す[['''べきです''']] [SRC[>>12]]。

[EG[
[14] 例えば[[パッチ文書]]を適用した結果 [[XML文書]]が[[整形式]]でなくなるなら、
[CODE(HTTP)[[[422]]]] [[応答]]を返すことができます [SRC[>>12]]。
]EG]

* 歴史

[FIG(quote)[
[FIGCAPTION[
[7] RFC 2518 (WebDAV) 10.3 422 Unprocessable Entity
]FIGCAPTION]

> The 422 (Unprocessable Entity) status code means the server
understands the content type of the request entity (hence a
415(Unsupported Media Type) status code is inappropriate), and the
syntax of the request entity is correct (thus a 400 (Bad Request)
status code is inappropriate) but was unable to process the contained
instructions.  For example, this error condition may occur if an XML
request body contains well-formed (i.e., syntactically correct), but
semantically erroneous XML instructions.

[CODE(HTTP)[422]] (処理不能実体) 状態符号は、
サーバーが要求実態の内容型は理解した
(従って [CODE(HTTP)[[[415]]]] (未対応の媒体型) 状態符号は不適切である)
し、要求実体は正しい (従って [CODE(HTTP)[[[400]]]] (悪い要求)
状態符号は不適切である) ものの含まれている指示を処理することができなかったことを意味します。
例えば、 XML 要求本体が整形式である (つまり構文的には正しい)
が意味的に誤っている XML 指示のときにこの誤り状況が発生するかもしれません。
]FIG]

[8] [[S-HTTP]] は別の意味 ([DFN[[[SHTTP Proxy Authentication Required]]]])
で使っていました [SRC[>>423]]。

[REFS[
- [423] [CITE@en[RFC 2660 - The Secure HyperText Transfer Protocol]]
( ([TIME[2013-07-20 22:21:48 +09:00]] 版))
<http://tools.ietf.org/html/rfc2660#section-5.2.4>
]REFS]

* 実装

[9] [[要求]]で [[JSON]] を求める [[Web API]] で、入力が期待される構造でなかった時に
[CODE(HTTP)[[[422]]]] [[応答]]が返されることがよくあります。