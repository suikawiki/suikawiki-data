* 構文

[[ISO/IEC2022]] 1994 15.4

=DOCS = ESC %x25 [I] F  ;; DESIGNATE OTHER CODING SYSTEM
=I = I-foreign / %x20-2E
=I-foreign = %x2F
=F = %x40-%x7E

ISO/IEC 2022 に適合しない符号化体系 Coding System
を指示・呼び出ししたり、 ISO/IEC 2022 に戻ってきたりします。

=return-to-ISO2022 = ESC %x25 %x40

ESC 02/05 04/00 で戻ってきたときには、[[告知]], [[指示]],
[[呼び出し]]の状態は元に戻ります。[[現在位置]]など他の状態が
戻るかは未定義です。

中間バイトが 02/15 の時は、呼び出された符号化体系は
ISO/IEC 2022 に復帰するのに return-to-ISO2022 を使いません。
他の方法で戻ってきたとしても上述の状態も戻るかは未定義ですし、
そもそも戻る方法が無いかもしれません。

他の中間バイトを使うか、または中間バイト無しの時は、
return-to-ISO2022 を使って ISO/IEC 2022 に復帰できます。

[17] [DFN@en[[CODE[5F]]]] 型[[エスケープ・シーケンス]]は、
[[符号化システム]]の[[指示]]
([CODE(charname)@en[[[DESIGNATE OTHER CODING SYSTEM]]]])
に使われます。

[18] 
仕様書:
- [[JIS X 0202]]:1998
--[CSECTION[表 3.b nF 型エスケープ・シーケンス及び対応機能]]


[19] 
- [CODE(ABNF)[[DFN[エスケープ・シーケンス]] /= 5F 型エスケープ・シーケンス]]
- [CODE(ABNF)[[DFN[5F 型エスケープ・シーケンス]] := DOCS / 5F 型予約エスケープ・シーケンス]]
- [CODE(ABNF)[[DFN@en[DOCS]] := 標準 DOCS / 私用 DOCS [CODE(comment)[;; [CODE(charname)@en[[[DESIGNATE OTHER CODING SYSTEM]]]]]]]]
- [CODE(ABNF)[[DFN[標準 DOCS]] := [CODE(charname)@en[[[ESC]]]] %x25 [%x2F] [%x21-23 *[[I]]] [[Ft]]]]
- [CODE(ABNF)[[DFN[私用 DOCS]] := [CODE(charname)@en[[[ESC]]]] %x25 *[[I]] [[Fp]]]]
- [CODE(ABNF)[[DFN[5F 型予約エスケープ・シーケンス]] := [CODE(charname)@en[[[ESC]]]] %x21 (%x20 / %x24-2E / %x2F (%x20 / %x24-2F)) *[[I]] [[Ft]]]]
- [CODE(ABNF)[[DFN@en[I]] := %x20-2F [CODE(comment)[;; 中間バイト]]]]
- [CODE(ABNF)[[DFN@en[Fp]] := %x30-3F [CODE(comment)[;; 私用終端バイト]]]]
- [CODE(ABNF)[[DFN@en[Ft]] := %x40-7E [CODE(comment)[;; 標準終端バイト]]]]







*ESC 02/05 Ft

,ESC 02/05,4  ,5  ,6  ,7
,0        ,000
,1        ,108
,2        ,178
,3        ,131
,4        ,145
,5        ,160
,6        ,161
,7        ,196
,8        ,188
,9        ,
,10       ,
,11       ,
,12       ,
,13       ,
,14       ,
,15       ,   ,   ,   ,---

,000,ESC 02/15 04/00,[[ISO/IEC 2022]]
,108,ESC 02/15 04/01,[[NAPLPS]]
,178,ESC 02/15 04/02,[[UTF-1]]
,131,ESC 02/15 04/03,Data Syntax I of [[CCITT]] Rec. T.101.
,145,ESC 02/15 04/04,Data Syntax II of CCITT Rec. T.101.
,160,ESC 02/15 04/05,Photo-Videotex Data Syntax of CCITT Recommendation T.101.
,161,ESC 02/15 04/06,Audio Data Syntax of CCITT Recommendation T.101.
,196,ESC 02/15 04/07,[[UTF-8]] with standard return (実装水準指定なし)
,186,ESC 02/15 04/08,VEMMI Data Syntax of (draft) ITU-T Recommendation

*ESC 02/05 02/15 Ft

,ESC 02/05 02/15,4  ,5  ,6  ,7
,0        ,162
,1        ,163
,2        ,125
,3        ,174
,4        ,175
,5        ,176
,6        ,177
,7        ,190
,8        ,191
,9        ,192
,10       ,193
,11       ,194
,12       ,195
,13       ,
,14       ,
,15       ,   ,   ,   ,---

,162,ESC 02/05 02/15 04/00,"ISO/IEC 10646:1993, UCS-2, Level1",ESC U+0025 U+0040
,163,ESC 02/05 02/15 04/01,"ISO/IEC 10646:1993, UCS-4, Level1",ESC U+0025 U+0040
,125,ESC 02/05 02/15 04/02,Virtual Terminal Service Transparent Set,復帰なし
,174,ESC 02/05 02/15 04/03,"ISO/IEC 10646:1993, UCS-2, Level2",ESC U+0025 U+0040
,175,ESC 02/05 02/15 04/04,"ISO/IEC 10646:1993, UCS-4, Level2",ESC U+0025 U+0040
,176,ESC 02/05 02/15 04/05,"ISO/IEC 10646:1993, UCS-2, Level3",ESC U+0025 U+0040
,177,ESC 02/05 02/15 04/06,"ISO/IEC 10646:1993, UCS-4, Level3",ESC U+0025 U+0040
,190,ESC 02/05 02/15 04/07,"UTF-8 level 1, without standard return",ESC U+0025 U+0040
,191,ESC 02/05 02/15 04/08,"UTF-8 level 2, without standard return",ESC U+0025 U+0040
,192,ESC 02/05 02/15 04/09,"UTF-8 level 3, without standard return",ESC U+0025 U+0040
,193,ESC 02/05 02/15 04/10,"UTF-16 level 1, without standard return",ESC U+0025 U+0040
,194,ESC 02/05 02/15 04/11,"UTF-16 level 2, without standard return",ESC U+0025 U+0040
,195,ESC 02/05 02/15 04/12,"UTF-16 level 3, without standard return",ESC U+0025 U+0040

[7] 
UCS 系符号化体系では ISO/IEC 2022 への復帰に ESC(U+001B) U+0025 U+0040
を使います。 [[UCS-2]], [[UTF-16]] では 0x001B 0x0025 0x0040 に、
[[UCS-4]] では 0x0000001B 0x00000025 0x00000040 になります。
[[UTF-8]] では 0x1B 0x24 0x40 になります。



[6] [[ISO/IEC 10646におけるエスケープシーケンス]]も参照。

-*-*-

[4] [[ISO-IR]] 125 Virtual Terminal Service Transparent Set は、
8ビットの1バイト符号化文字集合で、 ISO [[OSI]] 仮想端末規格で利用します。
仮想端末サービス (VTS) の利用者が VTS の適用範囲外たる意味を
一部又は全部の値に割り当てます。 VTS はその意味や解釈の責任を有しません。
ISO/IEC 2022 符号化体系に復帰する手段はありません。
(ISO 9040, ISO 9041)

[2] [[終端バイト]] [[7/14]] については[[空集合 (ISO/IEC 2022)]]参照。

* 終端バイトと符号のビット数

[10] 
初期の [[ISO 2022]] 
では[[終端バイト]]が[[指示]]・[[呼び出し]]する[[符号]]の[[ビット数]]によって割り当てることになっていました。
すなわち、
[SRC[>>9]]

- 3/[VAR[c]] ([VAR[[[Fp]]]]) - 任意のビット数
- 4/[VAR[c]] - 7ビット[[未満]]
- 5/[VAR[c]] - 7ビット
- 6/[VAR[c]] - 8ビット
- 7/[VAR[c]] - 8ビット[[超]]

[11] 
ビット長の異なるデータをどのように混在させる想定だったのかは不明です。

[12] 
当時の [[ISO 2022]] には [[ISO 2022]] への復帰のシーケンスが規定されていませんでした。
[[ISO 2022]] 自身の[[7ビット符号]]と[[8ビット符号]]の切り替えの方法も用意されていませんでした。


[16] 
[[JIS X 4151]]
が
[SAMP(SGML)[ESC 2/5 4/0]] を未登録の128文字の文字集合と説明するのは、
この時代の仕様に基づく説明っぽいです。
[SEE[ [[公開テキスト指示シーケンス]] ]]


[20] 
実際にはこの規定に基づき [[ISO-IR]] に登録された[[終端バイト]]は1つもありません。


[REFS[
- [9] [CITE[[[ECMA-35]]_1st_edition_december_1971.pdf]], [TIME[2021-01-16T09:57:02.000Z]], [TIME[2022-05-01T05:17:03.679Z]] <https://www.ecma-international.org/wp-content/uploads/ECMA-35_1st_edition_december_1971.pdf#page=17>
]REFS]

* 文脈

[1] [[SGML]] の[[公式公開識別子]]の[[公開文指示シーケンス]]における [CODE(char)[DOCS]] の用法についての話は [CODE(WikiPage)[[[CHARSET]]]] を参照。

* メモ




[5] [CITE[Kiyokazu in (hopefully) hacker mode (multi octet character encoding handling library)]], [TIME[2020-10-25T00:25:49.000Z]] <http://pub.ks-and-ks.ne.jp/prog/libmoe/>


[3] [CITE[Compound Text Encoding]], [TIME[2010-12-20T07:36:19.000Z]], [TIME[2022-04-30T07:37:11.422Z]] <https://www.x.org/releases/X11R7.6/doc/xorg-docs/specs/CTEXT/ctext.html#Non_Standard_Character_Set_Encodings>


[8] [CITE[Man page of CONSOLE_CODES]], [TIME[2022-04-29T09:33:30.000Z]], [TIME[2022-04-30T10:06:40.770Z]] <https://linuxjm.osdn.jp/html/LDP_man-pages/man4/console_codes.4.html>

ESC 2/5 3/8 [[UTF-8]] (旧式)

[SEE[ [[VT][VT100]] ]]

- [13] [CITE[Digital Ansi-Compliant Print Protocol Lev 2 Program. Ref. Man. - PPLV2PMB.PDF]], [TIME[1995-08-31T14:32:02.000Z]], [TIME[2022-05-02T12:20:35.927Z]] <http://sup.xenya.si/sup/info/digital/MDS/jun99/Cd3/PRINTER/PPLV2PMB.PDF#page=108>
-- [14] <http://sup.xenya.si/sup/info/digital/MDS/jun99/Cd3/PRINTER/PPLV2PMB.PDF#page=160>
-- [15]  <http://sup.xenya.si/sup/info/digital/MDS/jun99/Cd3/PRINTER/PPLV2PMB.PDF#page=170>
