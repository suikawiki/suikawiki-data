[1] [DFN[IDNA [RUBYB[写像表]@en[Mapping Table]]]]は、 [[UTS #46]] で規定されている[[算法]]
[[Unicode IDNA互換性処理]]で使われる表です。[[Unicode]] の[[符号位置]]に対して[[状態値]]と[[写像値]]が示されており、
[[算法]]中の「[[写像]]」の[[段階]]や、
[[ラベル]]の[[妥当性]]の定義で用いられています。

* 仕様書

[REFS[
- [2] [CITE@en-us[UTS #46: Unicode IDNA Compatibility Processing]] ([TIME[2010-10-30 01:01:25 +09:00]] 版) <http://www.unicode.org/reports/tr46/#IDNA_Mapping_Table>
- [20] [CITE[Index of /Public/idna]] <http://www.unicode.org/Public/idna/>
-- [11] ([TIME[2016-06-21 07:22:40 +09:00]]) <http://www.unicode.org/Public/idna/latest/IdnaMappingTable.txt>
]REFS]

* 写像表

[25] [[IDNA写像表]]は、 
([[Unicode符号位置]]、[VAR[[[UseSTD3ASCIIRules]]]]) から ([[状態値]]、[[写像値]])
への[[写像]]です。

* 状態値

[3] [[Unicode]] のすべての[[符号位置]]に対して、
[DFN[[RUBYB[状態値]@en[status value]]]]が定義されています [SRC[>>2]]。

[26] [[状態値]]には、次のものがあります。

[FIG(switch)[
: [4] [DFN[[RUBYB[[[妥当]]]@en[valid]]]] [SRC[>>2]] :
[[Unicode IDNA互換性処理]]で変更されずにそのまま出力されます。
: [5] [DFN[[RUBYB[[[無視]]]@en[ignored]]]] [SRC[>>2]] :
[[Unicode IDNA互換性処理]]で削除されます。
: [6] [DFN[[RUBYB[[[写像]]]@en[mapped]]]] [SRC[>>2]] :
[[Unicode IDNA互換性処理]]で他の[[文字列]]に置き換えられます。
: [7] [DFN[[RUBYB[[[偏差]]]@en[derivation]]]] [SRC[>>2]] :
[[Unicode IDNA互換性処理]]で[[写像]]のように他の文字列に置き換えられるか、
[[妥当]]のようにそのまま出力されます。
どちらかは[[Unicode IDNA互換性処理]]の[VAR[処理オプション]]が[[移行的処理]]か[[非移行的処理]]かによります。
([[IDNA2003]] と [[IDNA2008]] とで扱いが異なる4[[文字]]がこの値になっています。)
: [8] [DFN[[RUBYB[[[禁止]]]@en[disallowed]]]] [SRC[>>2]] :
[[Unicode IDNA互換性処理]]でそのまま出力されますが、
[[誤り]]とみなされます。
]FIG]


[16] [VAR[[[UseSTD3ASCIIRules]]]] はほとんど影響しませんが、
次に該当する[[符号位置]]は、 [VAR[[[UseSTD3ASCIIRules]]]] によって[[状態値]]が変化します。

[FIG(switch)[
: [17] [DFN[[[disallowed_STD3_valid]]]] :
[VAR[[[UseSTD3ASCIIRules]]]] が[[真]]なら[[禁止]]ですが、
[[偽]]なら[[妥当]]として扱うことができます。 [SRC[>>2]]
: [18] [DFN[[[disallowed_STD3_mapped]]]] :
[VAR[[[UseSTD3ASCIIRules]]]] が[[真]]なら[[禁止]]ですが、
[[偽]]なら[[写像]]として扱うことができます。 [SRC[>>2]]
]FIG]

;; [[UseSTD3ASCIIRules]] を参照。

* 写像値

[19] [[状態値]]が[[写像]]、[[disallowed_STD3_mapped]]、[[偏差]]の[[符号位置]]には、
[DFN[[RUBYB[[[写像値]]]@en[mapping value]]]]も規定されています。 [SRC[>>2]]

* 安定性

[9] [[Unicode 5.1]] 以降で[[写像表]]が定義されており、以後、
前の版で[[禁止]]だった[[符号位置]]のみ新しい版で[[状態値]]や[[写像値]]が変更される可能性があります
[SRC[>>2]]。

* ファイル

[21] [[IDNA写像表]]は >>20 で配布されています。

[22] 配布されているファイルの形式は <http://www.unicode.org/reports/tr46/#IDNA_Mapping_Table>
で、導出方法は <http://www.unicode.org/reports/tr46/#Mapping_Table_Derivation> で説明されています。

[10] なお、 [[UTS #46]] にはこの表の導出方法の説明もありますが、その説明ではなく、
この配布されているファイル自体が正式なものとされています。

* 歴史

[23] [CITE@en-US[XBL 2.0]]
( ([TIME[2012-05-03 02:23:03 +09:00]] 版))
<http://dev.w3.org/2006/xbl2/Overview.html#ignoring>

[24] [CITE@en-US[XML Binding Language (XBL) 2.0]]
( ([TIME[2007-03-16 22:20:16 +09:00]] 版))
<http://www.w3.org/TR/2007/CR-xbl-20070316/#ignoring>