Creating a Secure Voice over IP Infrastructure
--- Using Check Point VPN-1 Pro to Enable Secyre VoIP Communications

- 内線電話の VoIP への移行
   - 専用の電話網 → データと共用の IP 網
      ○ 新しいサービス
         - e.g. ボイス・メールを出張中の社員に電子メールで転送
      ○ コスト削減
      × セキュリティ
   - 従来のセキュリティ対策では VoIP に対応できない
- Check Point VPN-1 Pro
   - ファイアウォールと VPN を統合した製品
   - VoIP に対応
   <http://www.checkpoint.com/products/downloads/vpn-1_power_datasheet.pdf>
- VoIP のセキュリティ問題
   - 複雑・多種多様な VoIP プロトコルへの対応
   - Converged network の保護
   - 高い音声品質の実現
   - NAT 問題の解決
- 複雑・多種多様な VoIP プロトコル
   - VoIP のためのプロトコルは複数存在する
      - H.323, SIP, MGCP, SCCP
   - 1つの呼だけでも複数のプロトコルを使用する
      - シグナリング用
      - メディア用
   - 各プロトコルに複数のバージョンがある

H.323

IP
  TCP
     H.225
     H.245
     T.120
  UDP
     RTCP
     H.225
     RTP
        音声・動画圧縮

IP
  TCP
    SIP
      SDP
  UDP
    RTCP
    RTP
      音声・動画圧縮

   - 1つの組織で複数に対応する必要があることも多い
      - 合併によりネットワークが統合された
      - 部署毎に異なるシステムを導入した
      - 新製品を導入していった
- VoIP とファイアウォール
   - 従来の多くのプロトコル: 特定のポートだけを使用
   - VoIP: 静的なポートの他に、動的なポートを使用
      → 従来のファイアウォールでは対応できない
- Check Point の答え
   - たくさんの VoIP プロトコルに対応する
      - 現在使われているほとんどのプロトコルに対応している
      - RFC 3261, RFC 3372, RFC 3311, RFC 2976, RFC 3515,
        RFC 3265, RFC 3266, RFC 3262, RFC 3428, RFC 3435,
        H.323 V2, V3, V4, H.255 V2, V3, V4,
        H.245 V3, V5, V7, J.171, SCCP
   - セッションの状態を把握し、動的にポートを管理する
      - セッションの進行に従い動的にポートを開く
      - 転送や保留にも対応している
- Converged network のリスク (1)
   (データ・音声兼用のネットワーク)
   - データ用ネットワークの脅威が VoIP にも存在する
   - ある会社は VoIP を導入して成功していたが、
     ワームが IP 網と従来の電話網の間の IP-PBX を攻撃したため、
     顧客電話窓口が停止し、データが破壊された
- Converged network のリスク (2)
   - VoIP 構成要素への攻撃
      - VoIP 機器のオペレーティング・システムの脆弱性を突く
      - VoIP の実装自体の脆弱性を突く
         - VoIP のプロトコル自体が新しいため、未知の脆弱性が存在するかも
         - 例えば、メディア用チャンネルを開いたまま制御用チャンネルを閉じ、
           通話料を安くできるかも
   - DoS 攻撃
   - ソフト・フォンの問題
      - ソフト・フォン: ソフトウェアによる VoIP の電話機
         - 利用例: 出張中の社員に持たせる
      - ソフト・フォンの入った計算機から社内に侵入されるかも
      - インターネット上を流れるトラフィックは通常暗号化されない
- Check Point の答え
   - VoIP プロトコルを深く理解する
      - プロトコルの規定に適合するか検査する
      - 異常なトラフィックは除去し、攻撃を防ぐ
   - 通話確立直後に切断した発信者からの要求は、以後拒否する
   - Integrity SecureClient
      - パーソナル・ファイアウォール兼 VPN クライアント
      - 管理者が利用可能アプリケーションを一元管理できる
      - VoIP トラフィックは VPN で暗号化される
- 高い音声品質の実現
   - 最低限従来の電話の品質を確保できないと受け入れられない
   - 遅延やジッター (揺らぎ) が品質低下の主な要因である
   - その原因 (セキュリティ関連) は:
      - トラフィックの検査
      - 暗号化・復号
- Check Point の答え
   - QoS 制御によりセキュリティのための遅延やジッターを最小化する
      - 低遅延キューイング (LLQ)
         - 遅延の影響を受けやすいトラフィックを優先処理する
      - 帯域保障
         - VoIP トラフィック専用に帯域幅の一部を割り当てる
      - 重み付き優先度
         - トラフィックの種類により優先度を決める
         - 例えば、輻輳状態では VoIP とファイル共有に 10:1
           の帯域幅を割り当てる
      - DiffServ
   - ハードウェア処理により高速化する
      - ハードウェアによる暗号処理
- NAT の問題
   - NAT は IP パケット内の IP アドレスを書き換える
   - VoIP ではアプリケーション層メッセージにも IP アドレスが書かれている
   - 1つの外部 IP アドレスへの着信を数百~数千の内部 IP 
     アドレスに振り分ける必要がある
- Check Point の答え
   - VoIP ユーザ・データベースを用いてアドレス変換する
      - VoIP 電話機は通話前に自身を VoIP 信号ルーティング装置に登録する
      - その登録要求を読んで内部データベースに記録する
- まとめ
   - VoIP 導入には様々なセキュリティ上の問題が存在する
   - Check Point の優れたソリューションにより、
     VoIP とセキュリティを両立できる
