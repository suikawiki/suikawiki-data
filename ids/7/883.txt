* 仕様書

[REFS[
- [406] [CITE@en[RFC 2616 - Hypertext Transfer Protocol -- HTTP/1.1]] ([TIME[2012-01-09 20:55:20 +09:00]] 版) <http://tools.ietf.org/html/rfc2616#section-10.4.8>
- [1] [CITE@en[RFC 7235 - Hypertext Transfer Protocol (HTTP/1.1): Authentication]] ([TIME[2014-09-11 10:01:28 +09:00]] 版) <https://tools.ietf.org/html/rfc7235#section-2.1>
- [410] [CITE@en[RFC 2617 - HTTP Authentication: Basic and Digest Access Authentication]] ([TIME[2012-01-09 21:04:30 +09:00]] 版) <http://tools.ietf.org/html/rfc2617#section-1.2>
- [411] [CITE@en[RFC 2617 - HTTP Authentication: Basic and Digest Access Authentication]] ([TIME[2012-01-09 21:04:30 +09:00]] 版) <http://tools.ietf.org/html/rfc2617#page-4>
]REFS]

* ヘッダー

[404] [[串]]は [CODE(HTTP)@en[[[Proxy-Authenticate:]]]] 欄を返さ[['''なければなりません''']]
[SRC[>>402, >>405, >>410, >>411]]。

* 文脈

[2] 認証が必要な[[串]]は、[[要求]]で[[串]]についての [[credentials]] がなかったり、
非妥当な [[credentials]] (例えば誤った[[パスワード]]) が指定されていたり、
不完全な [[credentials]] (例えば複数回の往復が必要な認証方式の途中の段階)
が指定されていたりする場合には、最低1つの (おそらくは新しい)
[[challenge]] が指定された [CODE(HTTP)@en[[[Proxy-Authenticate:]]]]
[[ヘッダー]]を含む [CODE(HTTP)[[[407]]]] [[応答]]を送信する[['''べきです''']] [SRC[>>1]]。

* 歴史

** RFC

[REFS[
- [402] '''[CITE@en[RFC 2068 - Hypertext Transfer Protocol -- HTTP/1.1]] ([TIME[2012-02-18 23:30:14 +09:00]] 版) <http://tools.ietf.org/html/rfc2068#section-10.4.8>'''
- [405] '''[CITE@en[RFC 2616 - Hypertext Transfer Protocol -- HTTP/1.1]] ([TIME[2012-01-09 20:55:20 +09:00]] 版) <http://tools.ietf.org/html/rfc2616#section-10.4.8>'''
]REFS]

[FIG[
[FIGCAPTION[
[403] RFC 2068 & 2616 (HTTP/1.1) 10.4.8 407 Proxy Authentication Required
]FIGCAPTION]

> This code is similar to 401 (Unauthorized), but indicates that the
client [DEL[MUST]] [INS[must]] first authenticate itself with the proxy. The proxy MUST
return a Proxy-Authenticate header field (section 14.33) containing a
challenge applicable to the proxy for the requested resource. The
client MAY repeat the request with a suitable Proxy-Authorization
header field (section 14.34). HTTP access authentication is explained
in [DEL[section 11]] [INS["HTTP Authentication: Basic and Digest Access Authentication" [43] ]].

この符号は、 [CODE(HTTP)[[[401]]]] (認証されていません) と同様ですが、
クライアントはまず串について認証しなければならないことを示します。
串は要求された資源について串に適用可能な[[誰何]]を含んだ
[CODE(HTTP)[[[Proxy-Authenticate]]]] 頭欄を返さなければ'''なりません'''。
クライアントは、適当な [CODE(HTTP)[[[Proxy-Authorization]]]]
頭欄をつけて要求を繰り返しても'''構いません'''。

* License
[[RFCのライセンス]]
]FIG]

[408] [[RFC 2069]] は[[串]]で認証が必要な時に [CODE(HTTP)@en[[[401]]]] を返すと書いていましたが、
同じ部分が [[RFC 2617]] では [CODE(HTTP)@en[[[407]]]] を返すと修正されています。

;; 元々は [[401]] を使う案だったのが、別の[[状態符号]]を使った方が良いとなったのでしょう。

[REFS[
- [407] [CITE@en[RFC 2069 - An Extension to HTTP : Digest Access Authentication]] ([TIME[2012-02-26 10:05:21 +09:00]] 版) <http://tools.ietf.org/html/rfc2069#section-2.5>
- [409] [CITE@en[RFC 2617 - HTTP Authentication: Basic and Digest Access Authentication]] ([TIME[2012-01-09 21:04:30 +09:00]] 版) <http://tools.ietf.org/html/rfc2617#section-3.6>
]REFS]