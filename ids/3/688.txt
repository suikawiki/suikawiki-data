
独り言。

例1: <input type="text" value=foo bar foo bar>

はもちろん間違いです。

例2: <input type="text" value="foo bar foo bar">

がおそらく意図したものです。

例3: <input type="text" value=foo&nbsp;bar&nbsp;foo&nbsp;bar>
例4: <input type="text" value=foo&#x20;bar&#x20;foo&#x20;bar>

とすれば一見正しく動作するように見えます([[UA]] によっては)。
しかし、 ([[W3C]]) [[HTML]] の [[SGML宣言]]に照らしてこれは間違いです。

仮に、 SGML 宣言で &, #, ; が生属性値に認められている
としましょう。 (そもそもこれは不思議マーク付けだ、 W3C
の定義に照らすのが間違いだ、ということで。)

そうすると、 value の値は 「foo&nbsp;bar...」とか
「foo&#x20;bar...」とかになります。そう、生属性値では
& は[[一般実体参照]]開始文字とはみなされないので、
単に「&」がそこにあるのだとみなされるのです。

例5: <input type="text" value="foo&nbsp;bar&nbsp;foo&nbsp;bar">
例6: <input type="text" value="foo&#x20;bar&#x20;foo&#x20;bar">

これはおそらく意図したように動くでしょうが、冗長なだけです。

ところで、別の次元での問題があります。例5と例6を含む
HTML 文書の [[form要素]]で、そのまま送信したとします。
で、その時の[[文字コード]]が [[Shift_JIS]] とか [[EUC-JP]]
だったとしましょう。さて、問題です。このとき必ず意図通りの
結果が得られるのは例5と例6のどちらでしょうか?
(意図していたのは [[SP]] だとします。我々が普段親しんでいる(?)
「 」←これです。)

答えは例6です。例6は例2と等価ですが、例5はそうではありません。
W3C HTML ([[不思議マーク付け]]派さん、またまたごめんなさい) では、
こんな風に定義されてます。

[PRE[
  <!ENTITY nbsp "&#xA0;" -- non-breaking space U+00A0 -->
]PRE]

(W3C の [[DTD]] からの引用じゃありません。いまでっちあげました。)

20 と A0 が違うのは誰の目にも明らかですよね?
・・・ってのじゃ説明になってないか。まあいいや。

この U+00A0 の文字は、 Shift_JIS や EUC-JP では定義されていない
ので、これを送ろうとした時の実装の動作は未定義です。
(送ることが出来る文字コードで送るのが([[電子メイル]]の場合)
普通なんですけど、そこまで賢くないみたい。)

聞く所に拠ると、 [[WinIE]] ではこれを &nbsp; として送るそうです。
本来そこだけ抜け落ちても仕方無いところなんですが、
情報を完全には損失しないように、っていう気配りで (いいかどうかは
別にして。) HTML 風に送っているということです。
(FORM 要素から送るデータは、特に指定が無い場合は HTML
ではありません。)

あるいは別の気配りの方法で、 U+00A0 は U+0020 (「 」←これ)
と「似た」文字だから、それに変えて送ってくれる UA も
あるらしいです。しかしだからといって、それが正しいわけじゃ
ありません。

最後に一言。あるものが上手く(意図通りに)動いたからといって、
それが正しい方法であったとは限りません。

わかば (誰に向かって説教してるんだろう)。

[1]
あsdがえgf
([[あsふぁs]] [あsdふぁs] [WEAK[2007-11-05 07:36:15 +00:00]])

[2]
あsdがえgf
([[あsふぁs]] [あsdふぁs] [WEAK[2007-11-05 07:36:20 +00:00]])


[3]
あsdがえgf
([[あsふぁs]] [あsdふぁs] [WEAK[2007-11-05 07:36:21 +00:00]])

