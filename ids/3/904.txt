[38] [DFN[[[TLS]]]] (旧 [DFN[[[SSL]]]]) は、[[TCP]] の上、
[[アプリケーション層プロトコル]]の下で動作する[[安全な輸送路]]を提供する[[プロトコル]]です。

* TLS/SSL の版

[14] 
[FIG(list)[
- [19] [[SSL/1.0]]: [[Netscape]], 1994 (未公開)
- [20] [[SSL/2.0]]: Netscape, 1995。
- [21] [[PCT]]: [[Microsoft]], 1995。 [[SSL/2.0]] を基にした。
- [22] [[SSL/3.0]]: Netscape, 1996。
- [23] [[TLS/1.0]]: [[ietf-tls]], 1999, [[RFC 2246]]。 [[SSL/3.0]] とほぼ同じ。
- [[TLS/1.1]]
- [[TLS/1.2]] ([[RFC 5246]])
]FIG]

[30] [[SSL/3.0]] までは[[脆弱性]]のため既に使うべきではないとされています。

* TLS の機能

[FIG(short list)[
- [[証明書]]
- [[EV SSL]]
- [[クライアント認証]]
- [[TLSハンドシェイク]]
- [[TLSセッション]]
- [[応用データ]]
- [[closure alert]]
- [[subjectAltName]]
- [[SNI]]
- [[NPN]]
- [[ALPN]]
- [[TLS-OBC]]
- [[TLSA]]
- [[incomplete close]]
- [[premature close]]
]FIG]

[39] [[Web]] では [[TLS]] 関連の次のような機能があります。

[FIG(short list)[
- [CODE(URI)@en[[[https:]]]]
- [CODE(URI)@en[[[wss:]]]]
- [[Cookie]] [CODE(HTTP)@en[[[Secure]]]]
- [[HSTS]]
- [[PKP]]
- [[Mixed Content]]
- [CODE(HTTP)@en[[[Upgrade:]]]]
- [CODE(URI)@en[[[shttp:]]]]
]FIG]

* 実装

[FIG(short list)[
- [[OpenSSL]]
- [[LibreSSL]]
- [[BoringSSL]]
]FIG]

* 関連団体

[FIG(short list)[
- [[IETF]]
- [[CA/Browser Forum]]
- [[CA]]
- [[Netscape]]
]FIG]

* アプリケーション

[54] [[アプリケーション層プロトコル]]によって [[TLS]] の使い方はいくつかの種類があります。

[55] 次の[[プロトコル]]は [[TCP]] のかわりに [[TLS]] over [[TCP]] を使います。
[FIG(short list)[
- [[HTTPS]]
- [[WebSockets]]
]FIG]

[56] 次の[[プロトコル]]は [CODE@en[[[STARTTLS]]]] やそれに類する仕組みで[[プロトコル]]内で[[平文]]から
[[TLS]] に切り替えます。
[FIG(short list)[
- [[FTP]]
- [[SMTP]]
- [[POP3]]
- [[IMAP4]]
- [[XMPP]]
- [[ACAP]]
- [[MySQL]]
]FIG]

[67] [[IETF]] は [[TLS]] over [[TCP]] で別の[[ポート]]を割り当てる方法は好ましくない [SRC[>>66]] と考えているようです。

[REFS[
- [66] [CITE@en[RFC 2595 - Using TLS with IMAP, POP3 and ACAP]] ([TIME[2014-09-14 14:37:22 +09:00]] 版) <http://tools.ietf.org/html/rfc2595#section-7>
]REFS]

* URL scheme

[36] [[SSL]] や [[TLS]] を使う場合の [[URL]] は、使わない場合の [[URL scheme]]
の末尾に [CODE[s]] を付け足すのが慣例となっています。

[EG[
[37] 例えば、 [[HTTP]] の [[URL scheme]] は [CODE(URI)@en[[[http:]]]] ですが、
[[HTTP]] と [[TLS]] を組み合わせる場合の [[URL scheme]] は [CODE(URI)@en[[[https:]]]]
です。
]EG]

* 歴史

** SSL/1.0

[87] [[SSL/1.0]] は1994年に [[Netscape]] 社内で開発されて、公開されていないと言われています。

** SSL/2.0

[80] 次の版が存在したようです [SRC[>>79, >>73]]。

[FIG(short list)[
- [TIME[1994-11-29]]
- [TIME[1994-12-22]]
- [TIME[1995-01-17]]
- [TIME[1995-01-24]]
- [TIME[1995-02-09]] >>79
- [TIME[1995-04]] >>73
]FIG]

[REFS[
- [79] [CITE[The SSL Protocol]]
([TIME[2015-03-03 23:42:25 +09:00]] 版)
<http://web.archive.org/web/19961027104907/http://www3.netscape.com/newsref/std/SSL_old.html>
- [81] [CITE[Security Issue]]
([TIME[2015-03-03 23:43:53 +09:00]] 版)
<http://web.archive.org/web/19970521032145/http://form.netscape.com/newsref/std/ssl_2.0_certificate.html>
- [73] [CITE@en[draft-hickman-netscape-ssl-00]]
([TIME[2015-03-03 16:21:19 +09:00]] 版)
<https://tools.ietf.org/html/draft-hickman-netscape-ssl-00>
]REFS]

** SSL/3.0

[FIG(short list)[
- [TIME[1995-12]] >>85
- [TIME[1996-03]] >>75, >>84
- [TIME[1996-11-18]] >>86, >>83
- [TIME[2011-01-26]]
- [TIME[2011-02-25]]
- [TIME[2011-04-01]]
- [TIME[2011-04-10]]
- [TIME[2011-05-16]]
- [TIME[2011-06-02]]
- [TIME[2011-06-10]]
- [TIME[2011-08]] >>35
]FIG]

[REFS[
- [85] [CITE@en[draft-freier-ssl-version3-00]] ([TIME[2015-01-18 17:12:30 +09:00]] 版) <https://tools.ietf.org/html/draft-freier-ssl-version3-00>
- [74] [CITE[Introduction to SSL]] ([TIME[2015-03-03 23:31:50 +09:00]] 版) <http://web.archive.org/web/20000616021359/http://devedge.netscape.com/docs/manuals/security/sslin/index.htm>
- [75] [CITE[SSL Protocol V. 3.0]]
([TIME[2015-03-03 23:34:21 +09:00]] 版)
<http://web.archive.org/web/20000229182903/http://home.netscape.com/eng/ssl3/ssl-toc.html>
- [84] [CITE@en[draft-freier-ssl-version3-01]] ([TIME[2015-01-27 10:03:41 +09:00]] 版) <https://tools.ietf.org/html/draft-freier-ssl-version3-01>
- [86] [CITE[The SSL Protocol Version 3.0]] ([TIME[2010-05-30 23:36:12 +09:00]] 版) <http://www7b.biglobe.ne.jp/~k-west/SSLandTLS/draft302.txt>
- [83] [CITE@en[draft-ietf-tls-ssl-version3-00 - The SSL Protocol Version 3.0]] ([TIME[2015-01-18 15:20:43 +09:00]] 版) <https://tools.ietf.org/html/draft-ietf-tls-ssl-version3-00>
- [35] [CITE@en[RFC 6101 - The Secure Sockets Layer (SSL) Protocol Version 3.0]]
( ([TIME[2014-06-02 03:42:59 +09:00]] 版))
<http://tools.ietf.org/html/rfc6101>
]REFS]

[FIG(quote)[
[FIGCAPTION[
[76] [CITE[SSL Version 3.0]]
([TIME[2015-03-03 23:41:10 +09:00]] 版)
<http://web.archive.org/web/19970709162834/http://home.netscape.com/newsref/std/SSL.html>
]FIGCAPTION]

> Netscape expects to ship products that conform to the March specification. Please note that Netscape server products with SSL V3.0 support both SSL 2.0 and SSL 3.0 protocols (SSL 3.0 was designed to allow this for transition purposes). SSL 2.0 has a limited lifetime.

]FIG]

[FIG(quote)[
[FIGCAPTION[
[77] [CITE[Netscape SSLRef 2.0]]
([TIME[2015-03-03 23:41:28 +09:00]] 版)
<http://web.archive.org/web/19970709162841/http://home.netscape.com/newsref/std/sslref.html>
]FIGCAPTION]

> SSLRef is a reference implementation from Netscape Communications of the SSL protocol. Available now and free for noncommercial use, SSLRef is intended to aid and accelerate developers' efforts to provide advanced security within TCP/IP applications using the SSL (Secure Sockets Layer) protocol. Netscape SSLRef consists of a software library distributed in ANSI C source-code form that can be compiled on a wide variety of platforms and operating systems and linked into any TCP/IP application program.

]FIG]

* 関連

[40] [[DTLS]] は [[TLS]] から派生した[[プロトコル]]ですが、
[[TCP]] ではなく [[UDP]] の上で動作します。

[57] [[SSL]] と [[SSH]] は関係ありません。

* メモ

[18] ''SSLの使い方'' <http://pc2.2ch.net/test/read.cgi/php/1016169881/>

[24] 現在は SSL/3.0 が主流らしい。

[25] SSL/TLS は基本的にはどんな[[応用層]]のインターネット・プロトコルとも組み合わせられるみたいですが、よく使われるのは [[HTTP]], [[POP]], [[IMAP]], [[NNTP]], [[FTP]] 辺りです。

[26] [CITE[スラッシュドット ジャパン | FirefoxがSSL 2.0のサポートを廃止へ]] <http://slashdot.jp/security/05/09/06/216212.shtml?topic=51>
([[名無しさん]] [WEAK[2005-09-07 16:29:52 +00:00]])

[27] [CITE@en[10 years of SSL in Opera - Implementer's notes - by Yngve Nys&#230;ter Pettersen]] ([TIME[2007-05-01 10:47:54 +09:00]] 版) <http://my.opera.com/yngve/blog/2007/04/30/10-years-of-ssl-in-opera>
([[名無しさん]] [WEAK[2007-05-01 01:50:56 +00:00]])

[28] [[SSL]] は無理矢理 [[OSI参照モデル]]に合わせて[[セッション層]]の[[プロトコル]]と説明されることもありますが、
実態としては [WEAK[([[TCP]] と組み合わせて成立する)]] [[トランスポート層]]の[[プロトコル]]と説明する方が正しいと思います。

[29] [CITE@ja[作ろうiモードコンテンツ:その他注意点 | サービス・機能 | NTTドコモ]]
([TIME[2010-08-15 16:18:55 +09:00]] 版)
<http://www.nttdocomo.co.jp/service/imode/make/content/ssl/notice/index.html>

[31] [CITE[Geekなぺーじ : イランからGoogleへのSSL通信が傍受されていた疑い。CAから発行された偽証明書が原因]]
([TIME[2011-08-31 14:27:20 +09:00]] 版)
<http://www.geekpage.jp/blog/?id=2011/8/31/1>

[32] [CITE[DigiNotar偽SSL証明書事件、「twitter.com」などにも拡大、全貌は未だ不明 -INTERNET Watch]]
( ([TIME[2011-09-07 00:25:39 +09:00]] 版))
<http://internet.watch.impress.co.jp/docs/news/20110906_475443.html>

[33] [CITE[Microsoft、不正SSL証明書問題に対処 Firefoxは再度更新 - ITmedia エンタープライズ]]
( ([TIME[2011-09-08 21:23:59 +09:00]] 版))
<http://www.itmedia.co.jp/enterprise/articles/1109/07/news017.html>

[34] [CITE@en-US[Certificate Authorities struggle to comply with Baseline Requirements | Netcraft]]
( ([TIME[2013-09-24 01:25:24 +09:00]] 版))
<http://news.netcraft.com/archives/2013/09/23/certificate-authorities-struggle-to-comply-with-baseline-requirements.html>

[1]
[CITE[スラッシュドット ジャパン | ApacheがSSLサーバのシェアでIISに追いついた?]] <http://slashdot.jp/articles/06/04/30/1530241.shtml>
([[名無しさん]] [WEAK[2006-05-01 12:29:50 +00:00]])

[2]
[[SMTP/TLS]] [[RFC 2487]]

[[HTTP/TLS]] [[RFC 2817]]

[[FTP/TLS]] [[RFC 4217]]
([[名無しさん]] [sage])

[3]
[[IMAP]] [[STARTTLS]] [[RFC 2595]]
([[名無しさん]])

[4]
[[POP3]] [CODE@en[[[STLS]]]] [[RFC 2595]]
([[名無しさん]])

[5]
[[ACAP]] [CODE@en[[[STARTTLS]]]] [[RFC 2595]]
([[名無しさん]])

[6]
[[SMTP]] [CODE@en[[[STARTTLS]]]] [[RFC 3207]]
([[名無しさん]])

[7]
[[RFC 3588]]
([[名無しさん]])

[8]
[[COPS/TLS]] [[RFC 4261]]
([[名無しさん]])


[9]
[[NNTP/TLS]] [[RFC 4642]]
([[名無しさん]] [WEAK[2006-10-26 23:34:01 +00:00]])

[10] [CITE[yebo blog: FSFがTLS Authorization ExtentionsのIETF標準化に反対]] ([TIME[2009-02-11 17:05:58 +09:00]] 版) <http://yebo-blog.blogspot.com/2009/02/fsftls-authorization-extentionsietf.html>

[11] [CITE[SSL - Dovecot Wiki]]
([TIME[2009-10-24 20:42:17 +09:00]] 版)
<http://wiki.dovecot.org/SSL>

[12] [CITE[SSL - Dovecot Wiki]]
([TIME[2009-10-24 20:42:17 +09:00]] 版)
<http://wiki.dovecot.org/SSL>

[13] [CITE[Web Security Context: User Interface Guidelines]]
([TIME[2010-08-04 20:09:50 +09:00]] 版)
<http://www.w3.org/TR/2010/REC-wsc-ui-20100812/>

[15] [CITE[なぜあなたがウェブサイトをHTTPS化するとサイトが遅くなってユーザーが逃げていくのか - 射撃しつつ前転]]
( ([TIME[2013-01-08 05:32:21 +09:00]] 版))
<http://d.hatena.ne.jp/tkng/20130108/1357610340>

[16] [CITE@en[RFC 6066 - Transport Layer Security (TLS) Extensions: Extension Definitions]]
( ([TIME[2013-11-15 13:40:26 +09:00]] 版))
<http://tools.ietf.org/html/rfc6066>

[17] [CITE@en[RFC 6125 - Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)]]
( ([TIME[2014-03-09 08:53:38 +09:00]] 版))
<https://tools.ietf.org/html/rfc6125>

[41] [CITE@en[HTTPS - IndieWebCamp]]
( ([TIME[2014-09-23 23:21:29 +09:00]] 版))
<https://indiewebcamp.com/HTTPS#Why>

[42] [CITE@en-us[Free SSL Certificate for Open Source Projects]]
( ([TIME[2014-09-23 23:54:48 +09:00]] 版))
<https://www.globalsign.com/ssl/ssl-open-source/>

[43] [CITE@en[RFC 5246 - The Transport Layer Security (TLS) Protocol Version 1.2]]
( ([TIME[2014-09-07 05:06:05 +09:00]] 版))
<http://tools.ietf.org/html/rfc5246>

[44] [CITE@en[RFC 7250 - Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)]]
( ([TIME[2014-06-27 00:54:48 +09:00]] 版))
<http://tools.ietf.org/html/rfc7250>

[45] [CITE@en[Adoption of TLS Extensions]]
( ([[Paul Querna]] 著, [TIME[2014-03-31 14:50:37 +09:00]] 版))
<https://journal.paul.querna.org/articles/2012/09/07/adoption-of-tls-extensions/>

[46] [CITE@en[RFC 5746 - Transport Layer Security (TLS) Renegotiation Indication Extension]]
( ([TIME[2014-07-21 03:11:33 +09:00]] 版))
<http://tools.ietf.org/html/rfc5746>

[47] [CITE[Introducing Universal SSL]]
( ([TIME[2014-09-29 11:15:20 +09:00]] 版))
<https://blog.cloudflare.com/introducing-universal-ssl/>

[48] [CITE[Qualys SSL Labs - Projects / SSL Server Test]]
( ([TIME[2014-10-07 02:30:07 +09:00]] 版))
<https://www.ssllabs.com/ssltest/index.html>

[49] [CITE@en[MySQL :: MySQL Internals Manual :: 14.5 SSL]]
( ([TIME[2014-10-12 04:07:49 +09:00]] 版))
<http://dev.mysql.com/doc/internals/en/ssl.html>

[50] [CITE@en[Security/Server Side TLS - MozillaWiki]]
( ([TIME[2014-10-15 03:48:55 +09:00]] 版))
<https://wiki.mozilla.org/Security/Server_Side_TLS>

[51] [CITE@en[Google Online Security Blog: This POODLE bites: exploiting the SSL 3.0 fallback]]
( ([TIME[2014-10-16 22:11:46 +09:00]] 版))
<http://googleonlinesecurity.blogspot.jp/2014/10/this-poodle-bites-exploiting-ssl-30.html>

[52] [CITE[ガラケー - SSLv3で問題になるフィーチャーフォンの対応 - Qiita]]
( ([TIME[2014-10-17 10:37:36 +09:00]] 版))
<http://qiita.com/harukasan/items/dee779c0a3f624758230>

[53] [CITE[Issue 244260 - chromium - Security: TLS Truncation attack on HTTP headers, including cookie flags - An open-source project to help move the web forward. - Google Project Hosting]]
( ([TIME[2014-10-18 09:06:03 +09:00]] 版))
<https://code.google.com/p/chromium/issues/detail?id=244260>

[58] [CITE[TLS: browser UI — Anne’s Blog]]
( ([TIME[2014-11-01 03:21:37 +09:00]] 版))
<https://annevankesteren.nl/2014/10/tls-browser-ui>

[59] [CITE@en[Deprecating Secure Sockets Layer Version 3.0]]
( ([TIME[2014-10-30 14:48:29 +09:00]] 版))
<https://unicorn-wg.github.io/sslv3-diediedie/>

[60] [CITE@en[RFC 6125 - Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)]]
( ([TIME[2014-10-27 18:05:46 +09:00]] 版))
<http://tools.ietf.org/html/rfc6125>

[61] [CITE@en[draft-balfanz-tls-channelid-01 - Transport Layer Security (TLS) Channel IDs]]
( ([TIME[2014-10-16 11:40:47 +09:00]] 版))
<http://tools.ietf.org/html/draft-balfanz-tls-channelid-01>

[62] [CITE@en[draft-reschke-objsec-01 - A Rationale for Fine-grained Intermediary-aware End-to-End Protocols]]
( ([TIME[2014-10-28 19:04:39 +09:00]] 版))
<https://tools.ietf.org/html/draft-reschke-objsec-01>

[63] [CITE@en[RFC 6176 - Prohibiting Secure Sockets Layer (SSL) Version 2.0]]
( ([TIME[2014-10-28 01:22:56 +09:00]] 版))
<http://tools.ietf.org/html/rfc6176>

[64] [CITE[Qualys SSL Labs - Projects / SSL Server Test]]
( ([TIME[2014-11-22 17:04:29 +09:00]] 版))
<https://www.ssllabs.com/ssltest/index.html>

[65] [CITE@ja[FacebookやTwitterがIE経由で繋がらない原因と対処法 - 道すがら講堂]]
( ([TIME[2014-11-25 23:23:51 +09:00]] 版))
<http://michisugara.jp/archives/2014/hb_tw_noaccess.html>

[68] [CITE@en[RFC 6749 - The OAuth 2.0 Authorization Framework]]
([TIME[2014-12-15 14:15:35 +09:00]] 版)
<http://tools.ietf.org/html/rfc6749#section-1.6>

[69] [CITE@en[RFC 6125 - Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)]]
([TIME[2014-12-31 00:31:45 +09:00]] 版)
<http://tools.ietf.org/html/rfc6125>

[70] [CITE@en[RFC 6749 - The OAuth 2.0 Authorization Framework]]
([TIME[2014-12-15 14:15:35 +09:00]] 版)
<http://tools.ietf.org/html/rfc6749#section-1.6>

[71] [CITE@en-US[mozilla-aurora: security/manager/ssl/src/IntolerantFallbackList.inc@e8f0fd3fbd3b]]
([TIME[2015-02-27 17:28:31 +09:00]] 版)
<https://hg.mozilla.org/releases/mozilla-aurora/file/tip/security/manager/ssl/src/IntolerantFallbackList.inc>

[72] [CITE@en[1133187 – Fallback whitelist update: mid-February 2015]]
([TIME[2015-02-27 17:29:38 +09:00]] 版)
<https://bugzilla.mozilla.org/show_bug.cgi?id=1133187>

[78] [CITE[Motoda's - Information about SSL]]
([TIME[2015-03-03 23:41:34 +09:00]] 版)
<http://web.archive.org/web/19990203185646/http://robin.sl.cae.ntt.co.jp/~motoda/SSL/>

[82] [CITE[<ねこだま> SSL関連情報のページ]]
([TIME[2015-03-04 00:24:29 +09:00]] 版)
<http://nekodama.com/SSL/>