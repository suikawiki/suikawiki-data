* Transport integration

[6] To construct the [[environment]], the rules to [[prepare metavariables]]
[MUST[MUST]] be used with [VAR[scheme key name]] [CODE[psgi.url_scheme]].

* Server state API

[1] A [[PSGI server]] [MAY[MAY]] set a [[value][hash value]] for the 
[[key][hash key]] [DFN[[CODE[manakai.server.state]]]] in the [[environment]].
If the [[key][hash key]] [CODE[exists]] and its [[value][hash value]] is [CODE[defined]],
it [MUST[MUST]] be a [[server state object]].

[2] A [DFN[server state object]] is a [[PSGI server]] dependent [[object]].

[8] Every invocation of a [[PSGI application]] within the same 
[[server session]] [MUST[MUST]] have the same [CODE[manakai.server.state]]
[[value][hash value]] in their [[environments][environment]].
How to determine the [DFN[server session]] is [[PSGI server]] dependent.

[EG[
[9] Typically, all the invocations of a [[PSGI application]] in a single worker process
of a preforking [[PSGI server]] implementation live in the same [[server session]].
]EG]

@@[10] 



* Terminology

[4] 
This specification depends on the [CITE[Infra Standard]].

[7] 
The terms
[DFN[hash key]],
[DFN[hash value]],
[DFN[[CODE[exists]]]],
[DFN[[CODE[defined]]]],
and
[DFN[object]]
are [[Perl]] terms.

[3] The terms
[DFN[PSGI server]],
[DFN[PSGI application]],
[DFN[environment]],
and
[DFN[[CODE[psgi.url_scheme]]]]
are defined by the [[PSGI]] specification.

[5] The term
[DFN[prepare metavariables]]
is defined by the [CITE[Web Transport Processing]] specification.
