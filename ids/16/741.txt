* 仕様書

[REFS[
- [2] [CITE@en[Final: OAuth Request Body Hash]] ([TIME[2009-04-12 08:08:27 +09:00]] 版) <http://oauth.googlecode.com/svn&l=52/spec/ext/body_hash/1.0/oauth-bodyhash.html>
]REFS]

* ハッシュ関数の選択

[3] [CODE(HTTP)@en[[[oauth_signature_method]]]] が [CODE(HTTP)@en[[[HMAC-SHA1]]]] か
[CODE(HTTP)@en[[[RSA-SHA1]]]] なら、 [[SHA1]] を使わなければ[['''なりません''']] [SRC[>>2]]。

[4] [CODE(HTTP)@en[[[PLAINTEXT]]]] なら、 [CODE(HTTP)@en[[[oauth_body_hash]]]]
を使う[['''べきではありません''']] [SRC[>>2]]。

[5] それ以外の[[署名]]方式を規定する際には、 [CODE(URI)@en[[[oauth_body_hash]]]]
の[[ハッシュアルゴリズム]]を規定する[['''べきです''']] [SRC[>>2]]。

* 値の計算

[6] [CODE(HTTP)@en[[[oauth_body_hash]]]] の値は、 [[payload body]]
(なければ[[空文字列]]) に[[ハッシュ関数]]を適用した結果を
[[RFC 4648]] [[Base64]] [[符号化]]したものとしなければ[['''なりません''']] [SRC[>>2]]。

* 歴史

[1] [CITE@en[Implementers' Draft: OAuth Request Body Hash 1.0 Draft 1]]
([TIME[2008-12-08 08:47:55 +09:00]] 版)
<http://oauth.googlecode.com/svn/spec/ext/body_hash/1.0/drafts/1/spec.html>