* 時刻系

[44] 
[CITE[1 目的 - 000068239.pdf]], [TIME[2023-04-13T13:58:51.000Z]], [TIME[2023-04-24T02:44:05.997Z]] <https://www.gsi.go.jp/common/000068239.pdf#page=19>

>
[LEFT[
GPST[BR[]]
(UTC(USNO)に準拠)
]LEFT]

>
[LEFT[
上記の差はユーザに提供さ[BR[]]
れている。MCS での GPST[BR[]]
と UTC(USNO)の差は 1μs[BR[]]
(modulo 1)
]LEFT]

* GPS 週

[36] [DFN[GPS [RUBY[週][しゅう][week]]]]は [[GPS時]]における[[週]]です。

[37] 
[[GPS時]]の[[基準点][元期]]である[TIME[1980-01-06T00:00Z]]から7日間が最初の[[週]]で、
以後7日ずつが[[週]]となります。

* GPS週ロールオーバー

[7] [CITE[GPSにおける週番号の決定と時刻表現に関連する諸問題]]
(測位航法学会論文誌 Vol. 2 (2011) No. 2 P 13-20, [TIME[2016-07-29 09:11:51 +09:00]])
<https://www.jstage.jst.go.jp/article/ipntj/2/2/2_2_13/_article/-char/ja/>

[56] 
[CITE@en[GPS week number rollover - Wikipedia]], [TIME[2023-11-21T14:17:07.000Z]], [TIME[2023-11-25T08:01:38.689Z]] <https://en.wikipedia.org/wiki/GPS_week_number_rollover>

** [TIME[1999-08-21]]

[FIG(quote)[
[FIGCAPTION[
[8] [CITE@ja[電子機器の時刻]]
([TIME[2017-01-09 16:18:24 +09:00]])
<http://www.ffortune.net/calen/calen/etime.htm>
]FIGCAPTION]

> 1999年8月21日には現在ではカーナビでおなじみの測位衛星GPSの内部時間の桁数があふれて0に戻るというのがあり、一部のGPS機器で実際に誤動作が起きました。GPSの時刻は次は2019年4月7日にも0に戻りますが、さすがに次はトラブルはないでしょう。

]FIG]


[12] [CITE@ja-jp[一足早くGPSの「1999年」問題|WIRED.jp]]
([TIME[2019-02-18 16:11:43 +09:00]])
<https://wired.jp/1999/08/06/%e4%b8%80%e8%b6%b3%e6%97%a9%e3%81%8fgps%e3%81%ae%e3%80%8c1999%e5%b9%b4%e3%80%8d%e5%95%8f%e9%a1%8c/>

** [TIME[2019-04-07]]

[13] ([TIME[2018-07-25 13:33:39 +09:00]])
<https://www.furuno.com/jp/gnss/datadownload/GNSS_Receiver_WeekNumberRollover_SE18-100-007-00_jp.pdf>

[FIG(quote)[
[FIGCAPTION[
[14] [CITE@ja[海上保安庁、ディファレンシャルGPSの運用を終了|ニュース/アーカイブ|みちびき(準天頂衛星システム:QZSS)公式サイト - 内閣府]]
([TIME[2019-03-13 13:29:50 +09:00]])
<http://qzss.go.jp/news/archive/kaiho-dgps_190304.html>
]FIGCAPTION]

> 今回の廃止を判断するに至った理由として、海上保安庁は次のように説明しています。
> [SNIP[]]
> GPS週数ロールオーバーにより、DGPS装置の時刻管理が不能となり、補正情報の信頼性を担保できない状況となる。

]FIG]

[15] [CITE@ja[19.6年周期の“GPS週数ロールオーバー”が4月7日にやって来る。古いGPS機器では不具合が発生する可能性も【地図と位置情報】- INTERNET Watch]]
([[株式会社インプレス]]著, [TIME[2019-03-14 14:34:03 +09:00]])
<https://internet.watch.impress.co.jp/docs/column/chizu3/1174262.html>

[16] [CITE@ja-JP[2019年4月 GPS週数ロールオーバーテストについて | Garmin サポートセンター]]
([TIME[2019-03-14 14:40:40 +09:00]])
<https://support.garmin.com/ja-JP/?faq=zWQY6Z2kFiAuY9kDnDBgZ6&searchQuery=KM1260447>

[17] [CITE['''['''tz''']''' GPS Week Number Rollover Apr 6/7]]
([TIME[2019-04-02 08:42:16 +09:00]])
<https://mm.icann.org/pipermail/tz/2019-April/027837.html>

[18] [CITE['''['''tz''']''' GPS Week Number Rollover Apr 6/7]]
([TIME[2019-04-02 08:42:16 +09:00]])
<https://mm.icann.org/pipermail/tz/2019-April/027838.html>

[19] [CITE['''['''tz''']''' GPS Week Number Rollover Apr 6/7]]
([TIME[2019-04-10 22:46:21 +09:00]])
<https://mm.icann.org/pipermail/tz/2019-April/027852.html>

[20] ([TIME[2018-04-10 23:22:13 +09:00]])
<https://ics-cert.us-cert.gov/sites/default/files/documents/Memorandum_on_GPS_2019.pdf>

[21] [CITE@ja[ChinaAviationReviewさんのツイート: "Multiple Boeing 787s in China experienced GPS 20 years rollover issue. Some aircrafts have to be grounded waiting for an update.… https://t.co/MvWpoDoqkU"]]
([TIME[2019-04-11 11:20:36 +09:00]])
<https://twitter.com/ChinaAvReview/status/1114802018919411712/photo/1>

[22] [CITE['''['''tz''']''' GPS Week Number Rollover Apr 6/7]]
([TIME[2019-04-10 22:46:21 +09:00]])
<https://mm.icann.org/pipermail/tz/2019-April/027852.html>

[11] [CITE@ja[GNSS受信機のロールオーバー状態について | 国土地理院]]
([TIME[2018-03-27 15:35:07 +09:00]])
<https://psgsv2.gsi.go.jp/koukyou/public/news/rollover.html>

[FIG(quote)[
[FIGCAPTION[
[31] [CITE@ja[iPhone や iPad のソフトウェアをアップデートして位置情報の問題を回避する - Apple サポート]]
([TIME[2019-10-28 03:22:49 +09:00]])
<https://support.apple.com/ja-jp/HT210239>
]FIGCAPTION]

> 2012 年以前に発売された一部のモデルの iPhone や iPad をお使いのお客様は、正確な GPS 位置情報を維持するため、協定世界時 (UTC) の 2019 年 11 月 3 日 午前 0 時 (日本時間の 2019 年 11 月 3 日 午前 9 時)* までに iOS をアップデートする必要があります。これは、いわゆる GPS 週数ロールオーバーの問題によるもので、他社メーカーの GPS 搭載製品では 2019 年 4 月 6 日頃から影響が出始めています。一部の Apple 製品もこの影響を受けますが、影響が出始めるのは協定世界時 (UTC) の 2019 年 11 月 3 日 午前 0 時 (日本時間の 2019 年 11 月 3 日 午前 9 時) 以降です。

]FIG]


[32] [CITE@ja[20年に1度GPS時間リセット 前回は混乱、今回は?:朝日新聞デジタル]]
([TIME[2019-11-08 13:09:38 +09:00]])
<https://www.asahi.com/articles/ASM423RZ2M42UTIL00W.html>

[33] [CITE@en[The Bug That Crashed New York’s Wireless Network - The New York Times]], [TIME[2020-01-16 10:12:22 +09:00]] <https://www.nytimes.com/2019/06/24/nyregion/wireless-network-crash-gps-rollover.html>


[34] [CITE@ja[4月7日(日本時間)に2度目の「GPS週数ロールオーバー」|ニュース/アーカイブ|みちびき(準天頂衛星システム:QZSS)公式サイト - 内閣府]], [TIME[2020-12-29T11:16:44.000Z]] <https://qzss.go.jp/column/gps-rollover_190225.html>


[35] [CITE[gps-rollover-android.pdf]], [TIME[2020-12-13T01:31:49.000Z]], [TIME[2021-01-11T12:02:18.081Z]] <https://www.au.com/content/dam/au-com/static/designs/developer/android/pdf/gps-rollover-android.pdf>

- [40] [CITE@en[Honda Clocks Are Stuck 20 Years In The Past; There Isn't A Fix]], [TIME[2023-01-01T12:11:35.000Z]] <https://jalopnik.com/honda-clocks-are-stuck-20-years-in-the-past-and-this-mi-1848306970>
- [41] [CITE@en-US[Shoddy coding has some Honda cars stuck in the year 2002 | Engadget]]
([TIME[2023-01-01T12:12:31.000Z]])
<https://www.engadget.com/honda-2002-gps-bug-190248626.html>

[42] 
[TIME[西暦2020年][2020]]の[[年始]]に年表示が[TIME[2002]]に [SRC[>>40, >>41]]。
rollover の影響はすぐに出るとは限らないらしい。
([[年]]が変わるまで前と同じ[[年]]のデータを保持してる?)

[43] 
なお[TIME[西暦2017年][2017]]にも[TIME[1998]]となる不具合があった模様 [SRC[>>41]]。


[38] 
前回は[TIME[平成11(1999)年][1999]]で、
[[西暦2000年問題]]の1年前で[[日時桁溢れ問題]]等[[日時処理]]に社会的注目が集まっていた頃。
その時多くの教訓が得られたはず。それなのにわずか20年でまた同じ過ちが繰り返されている。
社会的に深刻な影響が出なかったからいいものの、
情報技術関係の業界と[[ソフトウェア工学]]の研究者はその間いったい何をしてきたのか。

[39] 
きっと20年後にも同じ騒動を繰り返すのだろう。大きな事件が起こらないとしても、
何かあるかもしれないと騒ぎになって社会的コストを浪費することは確実。

-[46] 
[CITE@en-US[Honda & Acura owners with clock problems report, as of August 17, their time is self-correcting but many are still stuck with the wrong date - Alt Car news]], [[Paulo Acoba]], [TIME[2023-11-25T06:56:27.000Z]] <https://tiremeetsroad.com/2022/08/17/honda-acura-owners-clock-problems-are-reporting-as-of-august-17-time-is-self-correcting-many-still-stuck-with-wrong-date/>
-[47] 
[CITE@en[Time formatting and storage bugs - Wikipedia]], [TIME[2023-11-24T03:13:21.000Z]], [TIME[2023-11-25T06:56:49.064Z]] <https://en.wikipedia.org/wiki/Time_formatting_and_storage_bugs#Year_2022>

** 令和7年の事案

[58] 
[CITE@en-US[2020 outback touring XT: GPS time is right but date is about 20 years off. Error 8 android auto : r/Subaru_Outback]], [TIME[2025-02-04T02:19:39.000Z]] <https://www.reddit.com/r/Subaru_Outback/comments/1ggkaq5/2020_outback_touring_xt_gps_time_is_right_but/?rdt=56611>

[57] 
[CITE@ja[京都市役所前の時計ズレすぎ、2044年8月11日になってる→あまりのズレに原因の考察やロマンを感る皆さん「もはや何かのメッセージだろ」 - Togetter '''['''トゥギャッター''']''']], [TIME[2025-02-04T02:18:41.000Z]] <https://togetter.com/li/2506117>


** 13ビット週番号

[54] 
[CITE@en[GPS week roll over April 6th | Cyber.gov.au]], [TIME[2023-11-25T08:00:50.000Z]], [TIME[2019-10-20T07:57:14.108Z]] <https://web.archive.org/web/20191020075611/https://www.cyber.gov.au/news/gps-rollover>

>Modernised GPS clocks, and GPS navigation systems may be released with a 13-bit week field, allowing up to 8192 weeks, instead of 1023 weeks, before rolling over to 0. This will increase the time between GPS week roll overs from approximately 20 years, to around 150 years.

[55] [CITE@en[Time formatting and storage bugs - Wikipedia]], [TIME[2023-11-24T03:13:21.000Z]], [TIME[2023-11-25T08:01:08.092Z]] <https://en.wikipedia.org/wiki/Time_formatting_and_storage_bugs#Year_2137>

>GPS dates are expressed as a week number and a day-of-week number, with the week number initially using a ten-bit value and modernised GPS navigation messages using a 13-bit field. Ten-bit systems would roll over every 1024 weeks (about 19.6 years) after Sunday 6 January 1980 (the GPS epoch), and 13-bit systems roll over every 8192 weeks. Thirteen-bit systems will roll over to zero in 2137.[SNIP[]]

* 閏秒

[2] [CITE@ja[GPSはどのようにしてうるう秒を挿入するか | Nyanchew's Digital Life - ja1]]
([TIME[2016-07-29 08:32:59 +09:00]])
<http://nyanchew.com/jp/gps%E3%81%AF%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%A6%E3%81%86%E3%82%8B%E3%81%86%E7%A7%92%E3%82%92%E6%8C%BF%E5%85%A5%E3%81%99%E3%82%8B%E3%81%8B>

* 相対性理論

[FIG(quote)[
[FIGCAPTION[
[9] [CITE@ja[時間の遅れ - Wikipedia]]
([TIME[2017-01-24 05:43:53 +09:00]])
<https://ja.wikipedia.org/wiki/%E6%99%82%E9%96%93%E3%81%AE%E9%81%85%E3%82%8C>
]FIGCAPTION]

> 全地球測位システム(GPS)では、GPS衛星が地上へ正確な時間を伝達することで、地球上の正確な位置を測定している。しかし人工衛星は重力源である地球から離れた衛星軌道上を周回し、地上に比して重力場が弱い環境にあって、その分地上よりも時間の経過は早い。このため、衛星側の内蔵時計は毎秒100億分の4.45秒だけ遅く進むように調整されている。また、衛星から地上へ電波が伝わる経路も地球の重力場にあり、伝播の時間も影響を受ける。この分も調整して電波が発信される。

]FIG]

[23] [CITE[GPS と物理]]
([TIME[2009-06-10 20:19:33 +09:00]])
<http://maya.phys.kyushu-u.ac.jp/~knomura/museum/GPS/GPS.html>

* 標準時管理

[24] 世界中の[[保時]]機関で [[GPS]] は[[時刻]]供給、[[時刻]]比較に使われています。
[SEE[ [[標準時]]の各記事参照 ]]

* プロトコル

[25] いくつかの[[プロトコル]]は [[GPS]] の日時情報を扱う手段を提供しています。

[FIG(short list)[ 
- [[Exifの日時形式]]
]FIG]

* ISO 19108

[27] [[JIS X 7108:2004]] D.3.4 / 附属書D表7は、
[[GPS暦]]を次のように記述しています。

[FIG(list members)[ [28] [CODE[TM_Calendar]]

: [F[name][TM_ReferenceSystem]] :
[DFN[GPS暦]]
: [F[domainOfValidity][TM_ReferenceSystem]] :
[[地球]]全域
: [F[dateTrans]] :
[[暦日]] ([VAR[WN]], [VAR[DN]]) について、
[FIG(math)[
[VAR[J]] = 2444244.5 + 7 × [VAR[WN]] + [VAR[DN]]
]FIG]
... で得られる[[ユリウス日]] [VAR[J]]
: [F[julTrans]] :
[[ユリウス日]] [VAR[J]] について、
[FIG(math)[
[VAR[DL]] = [VAR[J]] - 2444244.5

[VAR[WN]] = [[INT]] ([FRAC[ [VAR[DL]] ][ 7 ]])

[VAR[DN]] = [[MOD]] ([VAR[DL]], 7)

]FIG]
.. で得られる[[暦日]] ([VAR[WN]], [VAR[DN]])
: [F[referenceFrame][TM_Calendar]] :
[FIG(list members)[ [29] [CODE[TM_CalendarEra]]

: [F[name][TM_CalendarEra]] : [[GPS暦]]
: [F[referenceEvent][TM_CalendarEra]] :
: [F[referenceDate][TM_CalendarEra]] : (0001, 01)
: [F[julianReference][TM_CalendarEra]] : [TIME[2444244.5][jd:2444244.5]]
: [F[epochOfUse][TM_CalendarEra]] :
[FIG(list members)[ [30] [CODE[TM_Period]]

: [F[begin][TM_Period]] : [TIME[2444244.5][jd:2444244.5]]
: [F[end][TM_Period]] : 現在

]FIG]

]FIG]

]FIG]

* 西暦1880年基準の日時形式

[51] 
[[GPS時間]]以外にも同じように[TIME[西暦1980年][1980]]が基準となった[[日時形式]]がいくつかあります。

[48] [CITE@en[Time formatting and storage bugs - Wikipedia]], [TIME[2023-11-24T03:13:21.000Z]], [TIME[2023-11-25T07:25:41.503Z]] <https://en.wikipedia.org/wiki/Time_formatting_and_storage_bugs#Year_2048>

>The ATSC system will have an issue similar to the DVB issue described above after 2048 due to its use of signed 32-bit GPS seconds that begin from 6 January 1980. 

[49] 
>>48 これだけだと意味がいまいちよくわからないけど、 [[GPS秒]]を本家 [[GPS]] の[[データ構造]]と違って32ビット整数で表している[[ってコト]]!?

[50] 
[TIME[1980-01-01T00:00:00Z]] + (2[SUP[31]] - 1) [[秒]] = [TIME[2048-01-24T03:14:07Z]]。


-*-*-

[52] 
[[DOSの日時形式]]は[TIME[西暦1980年][1980]]からを表現できます。
[[GPS時間]]と違って1月1日から記述可能です。


[53] 
[[SAP S/4HANAの日時]]も同様です。


* 派生

[45] [[QZSST]]

* メモ


- [1] [CITE[GPS Week]]
([TIME[2009-05-01 11:29:35 +09:00]])
<http://www2.nc-toyama.ac.jp/~mkawai/lecture/radionav/gpsweek.html>
-- 消滅確認 [TIME[2022-07-11T05:51:38.000Z]]
--[CITE[GPS Week]], [TIME[2022-07-11T05:51:27.000Z]], [TIME[2016-06-08T03:19:02.484Z]] <https://web.archive.org/web/20160608031850/http://www2.nc-toyama.ac.jp/~mkawai/lecture/radionav/gpsweek.html>

[3] [CITE@ja-jp[GPS時間 ‐ 通信用語の基礎知識]]
([TIME[2016-07-29 08:33:46 +09:00]])
<http://www.wdic.org/w/SCI/GPS%E6%99%82%E9%96%93>

[4] [CITE@ja-jp[GPS ‐ 通信用語の基礎知識]]
([TIME[2016-07-29 08:33:50 +09:00]])
<http://www.wdic.org/w/SCI/GPS#xE6x97xA5xE6x99x82>

[5] [CITE[日本標準時プロジェクト GPS時刻比較データ]]
([TIME[2015-03-27 16:14:37 +09:00]])
<http://jjy.nict.go.jp/QandA/data/gps.html>

[6] [CITE[次世代時空計測グループ - GPSを使用した時刻比較]]
([TIME[2016-04-01 15:54:09 +09:00]])
<http://www2.nict.go.jp/aeri/sts/stmg/koganei/gps.html>


[10] ([TIME[2018-08-14 14:28:08 +09:00]])
<https://www.jstage.jst.go.jp/article/ipntj/2/2/2_2_13/_pdf>

[FIG(quote)[ [26] [[JIS X 7108:2004]] 4.2

[DFN[TOW]] 週単位の時刻 (Time of Week)
[SNIP[]]
[DFN[WN]] 週数 (Week Number)
]FIG]


