* T.100

- [17] [CITE@en[T.100 : International information exchange for interactive Videotex]], [[tsbmail]], [TIME[2020-12-05T08:06:28.000Z]] <https://www.itu.int/rec/T-REC-T.100-198811-I/en>

* T.101

[13] [CITE@en[T.101 : International interworking for Videotex services]], [[tsbmail]], [TIME[2020-12-05T07:06:25.000Z]] <https://www.itu.int/rec/T-REC-T.101-199411-I/en>

[49] 
[[PDF]] は[[フォント]]が埋め込まれていないらしく[[非ASCII文字]]は信用してはいけない。

[27] 
[[Videotex]] は日米欧3規格の統合に失敗した結果
[[T.101]]
は3規格を「Data Syntax」と称して並列に規定することになりました。

;; [28] そして3規格すべて商業的に失敗しました。。。

- [2] [CITE[00000001.PDF - 137.pdf]], [TIME[2014-06-23T02:14:26.000Z]], [TIME[2020-12-05T06:20:29.654Z]] <https://www.itscj.ipsj.or.jp/iso-ir/137.pdf>
- [3] [CITE[00000001.PDF - 071.pdf]], [TIME[2014-06-23T02:18:21.000Z]], [TIME[2020-12-05T06:20:49.313Z]] <https://www.itscj.ipsj.or.jp/iso-ir/071.pdf>
- [4] [CITE[00000001.PDF - 070.pdf]], [TIME[2014-06-23T02:18:19.000Z]], [TIME[2020-12-05T06:21:43.569Z]] <https://www.itscj.ipsj.or.jp/iso-ir/070.pdf>
- [5] [CITE[00000001.PDF - 132.pdf]], [TIME[2014-06-23T02:14:17.000Z]], [TIME[2020-12-05T06:22:03.270Z]] <https://www.itscj.ipsj.or.jp/iso-ir/132.pdf>
- [6] [CITE[00000001.PDF - 134.pdf]], [TIME[2014-06-23T02:14:20.000Z]], [TIME[2020-12-05T06:22:20.129Z]] <https://www.itscj.ipsj.or.jp/iso-ir/134.pdf>
- [7] [CITE[00000001.PDF - 135.pdf]], [TIME[2014-06-23T02:14:22.000Z]], [TIME[2020-12-05T06:22:37.493Z]] <https://www.itscj.ipsj.or.jp/iso-ir/135.pdf>
- [8] [CITE[00000001.PDF - 133.pdf]], [TIME[2014-06-23T02:14:18.000Z]], [TIME[2020-12-05T06:23:00.539Z]] <https://www.itscj.ipsj.or.jp/iso-ir/133.pdf>
- [9] [CITE[00000001.PDF - 073.pdf]], [TIME[2014-06-23T02:18:25.000Z]], [TIME[2020-12-05T06:23:23.190Z]] <https://www.itscj.ipsj.or.jp/iso-ir/073.pdf>
- [10] [CITE[00000001.PDF - 056.pdf]], [TIME[2014-06-23T02:17:52.000Z]], [TIME[2020-12-05T06:23:43.100Z]] <https://www.itscj.ipsj.or.jp/iso-ir/056.pdf>
- [11] [CITE[00000001.PDF - 136.pdf]], [TIME[2014-06-23T02:14:24.000Z]], [TIME[2020-12-05T06:24:04.576Z]] <https://www.itscj.ipsj.or.jp/iso-ir/136.pdf>
- [18] [CITE[null]], [TIME[2014-06-23T02:14:09.000Z]], [TIME[2020-12-05T09:32:51.518Z]] <https://www.itscj.ipsj.or.jp/iso-ir/128.pdf>


[1] [CITE@en[Videotex character set - Wikipedia]], [TIME[2020-12-04T00:34:29.000Z]], [TIME[2020-12-05T06:14:06.372Z]] <https://en.wikipedia.org/wiki/Videotex_character_set>

[12] [CITE@en[Viewdata - Wikipedia]], [TIME[2020-11-21T02:02:06.000Z]], [TIME[2020-12-05T06:24:38.609Z]] <https://en.wikipedia.org/wiki/Viewdata>

** VideotexString


[20] 
"complete code" environment 
([[ISO/IEC 2022]] complete coding environment)
を切り替える [CODE(charname)@en[DOCS]]
[SRC[T.101 PDF1 p.18, p.20, p.41]]:

- [CODE(charname)@en[ESC]] 2/5 4/3 : Data Syntax I 
- [CODE(charname)@en[ESC]] 2/5 4/4 : Data Syntax II
- [CODE(charname)@en[ESC]] 2/5 4/1 : Data Syntax III 
- [CODE(charname)@en[ESC]] 2/5 4/0 : [[ISO/IEC 2022]]
- その他 [[ISO/IEC 9281]] で登録されたもの

[21] 
各 Data Syntax から
[CODE(charname)@en[PCD]] 
を使って
[[ISO/IEC 9281]] picture coding environment
の
audio mode,
photographic mode,
VEMMI mode
を利用可能。
[SRC[T.101 PDF1 p.41]]

[19] 
[[ASN.1]]
[DFN[VideotexString]]:
[[ISO/IEC 2022]],
Data Syntax I,
Data Syntax II,
Data Syntax III
[CODE(charname)@en[DOCS]] で相互に切替可能。
[SRC[T.101 PDF1 p.41]]

[29] 3規格を識別するのみならず相互切り替え可能にする必要性はあったのか、
需要はあったのか、実装可能だったのかは謎です。

[39] 
Data Syntax の方に言及がなく本体で規定される
[[ISO/IEC 9281]] picture coding への対応も、
実態はあったのでしょうかね?

[40] DI で識別される Data Syntax I と 
[CODE(charname)@en[PCD]] で始まる [[ISO/IEC 9281]]
は区別可能だけどアーキテクチャとしておかしい。
また Data Syntax I から他に切り替える時どこにどう
[CODE(charname)@en[DOCS]]
を挿入すればいいのか何も書いていない。
本体の状態遷移図に従うなら DI で識別されるバイト長が満了した後に
[CODE(charname)@en[DOCS]] や [CODE(charname)@en[PCD]]
を書けるということか。

[41] 本体の状態遷移図には Data Syntax I に切り替えたらまず
rank
を書く(?)とあるが、その構文が本体にも附属書にも書いてなく謎。
(rank という概念は Data Syntax I に存在してはいるのだが。)

** terminal identification 

[46] 
端末状態と照会・回答できる。 Data Syntax 共通。
[SRC[PDF1 p.36, PDF1 p.102, PDF2 p.379, PDF3 p.119]]




host 1/15 2/0 4/0 

terminal 1/15 2/0 [VAR[bytes]]

[VAR[bytes]] は [ [N[4/0]], [N[7/15]] ] の列

[VAR[bytes]] は [N[4/0]] で終端するか、
[N[7/15]] [ [N[6/0]], [N[7/15]] ]* [ [N[4/0]], [N[5/15]] ]
で終端する。




[64] 
Data Syntax II には [N[1/15]] に他の機能もある

** Data Syntax I

[22] 
Data Syntax I (CAPTAIN) - 日本向け
[SRC[PDF1 p.102]]

[31] 4モードあって、
DI (Data Identifier) 
で識別します。

- character mode
-- DI(C) 0b00100000
- transparent mode
-- DI(T) 0b00110000
-- DI(T-CNT) 0b00111111 (継続を表す)
- sound mode
-- DI(S) 0b01000001
- message mode
-- DI(M) 0b01000000

[32] 
[VAR[DI]], [VAR[LI]], [VAR[bytes]]
を1セットとして繰り返します。

[33] 
LI (Length Indicator) 
は
[ [N[0]], [N[254]] ]
の1バイトでバイト長を表すか、
[N[255]] の[[バイト]]に続く[[大エンディアン]]2バイトでバイト長を表します。
([ [N[0]], [N[254]] ] を1+2バイトで表すのも禁止されていない。)


[30] [[character mode]] (初期状態)

- [[ISO/IEC 2022]] [[7ビット符号]]、[[8ビット符号]]
- [[C0]] [N[4/9]]
- [[C1]] [N[4/4]]
- [[G0]] = [[GL]] (初期値 Japanese-Kanji set)
- [[G1]] (初期値 Primary set)
- [[G2]] = [[GR]] (初期値 Display control command set)
- [[G3]] (初期値 DRCS 1)
- [[固定シフト]]、[[単独シフト]]、[[指示シーケンス]]
- [[制御シーケンス]]
- [[94集合]] [N[4/10]] Primary Character set
-- [[JIS X 0201]] [[ラテン文字用図形文字集合]]相当
- [[94集合]] [N[4/9]] Katakana Character set
-- [[JIS X 0201]] [[片仮名用図形文字集合]]相当
- [[94集合]] [N[3/3]] Mosaic I set
- [[94集合]] [N[6/3]] Mosaic II set
- [[96集合]] [N[3/8]] Display Control set 
- [[96集合]] [N[5/7]] PDI set
- [[96集合]] [N[3/9]] MVI set
- [14] [[94[SUP[2]]集合]] [N[4/2]] [[改訂][IRR]] [N[4/0]] Kanji Character set (Japanese-Kanji Character Set)
-- [[JIS X 0208-1990]] 相当 + [[ARIB外字]]
-- [16] 「[[T.52]] との違い」
--- [24] 84区5点と6点は使用しない
---- [25] と書かれているが符号表にはこれらも掲載されている
--- [26] 92区から94区に169文字追加
- [[94集合]] [N[2/0]] [N[4/1]] : [[DRCS]] I set
- [[94[SUP[2]]集合]] [N[2/0]] [N[4/0]] : [[DRCS]] II set


[35] 
transparent mode は PDU (Phorographic Data Unit) の連続。

[36] 
PDU は opcode (1[[バイト]])、[VAR[LI]]、[VAR[bytes]]。

[34] 
DI(T) / DI(T-CNT) の境界と PDU の境界が一致していなければならないのか、
そうでないのかよくわからない。一致しなければならないとすると
DI(T-CNT) は不要に思えるので、一致しなくても良いのかも。

[38] 
sound mode

- [[ISO/IEC 2022]] [[7ビット符号]]/[[8ビット符号]]
- [[C0]]
- [[GL]] [[96[SUP[2]]集合]] Sound tone set
- [[C1]] Sound control

[44] Sound tone set : 
第1バイト Sound Tone Set (Pitch)、
第2バイト Sound Tone Set (Duration)

[45] Sound control  

,*  ,*8  ,*9
,* 0,SMC ,SLV
,* 1,SMP ,
,* 2,SRP ,
,* 3,    ,
,* 4,EMC ,
,* 5,EPT ,
,* 6,    ,
,* 7,    ,
,* 8,LBL ,LRT
,* 9,JMP ,
,*10,RPT ,
,*11,BRA ,
,*12,CTM ,

引数付き

- SMC 3/0 3/11 3/N 3/11
- SMP 3/P 3/11
- SRP 3/P 3/11
- LBL 3/N 3/11
- JMP 3/N 3/11
- RPT 3/M 3/11 3/N 3/11
- BRA 3/M 3/11 3/N 3/11
- SLV 3/L 3/11
- CTM 3/P 3/11
- LRT 3/N 3/11

(引数は1バイトとは限らない)

numeric parameter: [ [N[3/0]], [N[3/9]] ]+
delimiter: 3/11




[37] 
message mode 

- [[ISO/IEC 2022]] [[7ビット符号]]/[[8ビット符号]]
- [[C0]]
- [[C1]]
- [[GL]] = [[G0]]
- [[LS0]] Katakana character 
- [[LS1]] Japanese-Kanji character
- [[GR]] Primary character


[47] 
[[C0]] 引数付き

- 1/15 NSR >>36
- 1/4 KMC [VAR[P]]
- 1/12 APS [VAR[row]] [VAR[column]] (cursor position) 
-- 下位6ビット

[48] 
[[message mode]] の [[C1]] は [[character mode]] の [[C1]] の[[部分集合]]

[23] 
[[C1]] の [CODE(charname)@en[P-MACRO]] は
[[ARIB STD-B24]] の [CODE(charname)@en[MACRO]]
相当 + [CODE(charname)@en[P-MACRO]] [N[4/2]] [VAR[P]] でマクロ文を返送要求
(ただしこちらは[[96集合]]で [VAR[P]] は [N[2/0]] ... [N[7/15]])


[42] 
1バイト (左側) の[[引数]]が続く[[C1制御文字]]

- COL
- SZX 
- FLC
- CDC

[43] 
特殊文字の集合
Display Control set,
PDI set,
MVI set:
opcode が [ [N[2/0]], [N[3/0]] ],
operand が [ [N[4/0]], [N[7/15]] ]。
opcode の後、
opcode 依存の構文・長さで operand が続く。

- 固定 operand
- single-value operand : 下位6ビットが符号なし整数を表す
- multi-value operand : 
下位6ビット中、上位3ビットと下位3ビットがそれぞれ値を表す。
後続 operand バイトも同じ。
1 - 8 バイト。
-- coordinate operand - 上位が X、下位が Y。第1バイト1つ目が符号±、
2つ目が最上位ビット (0.5)、最終バイト3つ目が最下位ビットで、
符号付き[[2の補数]]を表す。
-- 色: 3ビットの上位から GRB の順で unsigned color value in RGB color system
を表す。 unsigned binary decimal, 0 が lowest intensity、 1が highest intensity を表す。

Display Control set

- P-RESET fixed 1バイト
- P-DOMAIN fixed 2バイト
- LOGICAL-PEL multi-value 2バイト
- DISPLAY MODE fixed 1バイト
- P-TEXT fixed 2バイト / multi-value 1バイト
- RASTER multi-value 1バイト
- HEADER RASTER multi-value 1バイト
- SET LUT single-value 1バイト / multi-value 1バイト
- P-BLINK single-value 2バイト / fixed 3バイト
- AREA multi-value 2バイト
- SET FRAME single-value 2[VAR[n]] ([VAR[n]] = # of frames)
- ASSIGN FRAME signle-value 1バイト

Display Control Command Set

,*  ,* 2         ,* 3  
,* 0,            ,
,* 1,P-RESET     ,
,* 2,P-DOMAIN    ,
,* 3,LOGICAL PEL ,
,* 4,DISPLAY MODE,P-TEXT
,* 5,AREA
,* 6,SET FRAME
,* 7,ASSIGN FRAME
,* 8,            ,RASTER HEADER
,* 9,            ,RASTER
,*10,            ,SET LUT
,*11,            ,
,*12,P-WAIT      ,P-BLINK
,*13,            ,
,*14,            ,
,*15,            ,

[N[4/0]] - [N[7/15]] NUMERIC DATA




** Data Syntax II

[50] 
Data Syntax II は欧州向け。

[51] 
VPDE (Videotex Presentation Data Element) の連続。

[52] 
VPDE は VPCE の後に VSCE (Videotex Service Control Element)。

[53] 
VPCE (Videotex Presentation Control Element)
は
[CODE(charname)@en[US]] = [N[1/15]] 
のあとに 
[VAR[P]],
[VAR[P]] は:

- [N[4/0]] - [N[7/15]] : alphamosaic data
-- ALPHAMOSAIC display data
- [N[2/0]] - [N[2/15]] : management data
-- 2/0 & 2/1 TERMINAL FACILITY IDENTIFIER
-- 2/3 Define DRCS
-- 2/6 Define COLOUR
-- 2/13 Define Format
-- 2/14 TIMING CONTROL
-- 2/15 RESET 
- [N[3/0]] - [N[3/15]] : other data
-- 3/0 Reserved for Geometric display data
-- 3/1 GEOMETRIC display data (3D)
-- 3/2 GEOMETRIC display data
-- 3/4 PHOTOGRAPHIC pixel data
-- 3/5 PHOTOGRAPHIC table data
-- 3/11 SOUND
-- 3/12 Reserved for private use
-- 3/14 TELESOFTWARE (Processable) data
-- 3/15 TRANSPARENT data

[56] [SRC[PDF2, PDF2 p.49, p.53]]

- [[7ビット符号]]/[[8ビット符号]]
- [[C0]] = The primary control function set
- [[C1]] = supplementary control function set 2種のいずれかが既定値
-- ESC 2/2 4/0 serial supplementary control function set
-- ESC 2/2 4/1 parallel supplementary control function set
--
[65] 
parallel/serial C1 切り替えで動作モードが変化
[SRC[PDF2 p.6]]
- [[GL]] = [[G0]] = The Latin primary set of graphic characters
- [[G1]] = The second supplementary set of mosaic characters
- [[GR]] = [[G2]] = The Latin supplementary set of graphic characters
- [[G3]] = The third supplementary set of mosaic characters
- L-set = The first supplementary set of mosaic characters
- [[固定シフト]]、[[単独シフト]]、[[指示シーケンス]]
- [[制御シーケンス]]
- [[94集合]] [N[4/0]] Latin Primary set 
-- [61] [[ISO/IEC 646の版]]相当の自由度
-- [60] [[終端バイト]]は本来 [[ISO/IEC 646]] [[旧IRV]]
- [[94集合]] [N[6/3]] Secondary mosaic set
- [[94集合]] [N[6/2]] Supplementary graphic set
- [[94集合]] [N[6/4]] Third supplementary mosaic set
- [[94集合]] [N[2/1]] [N[4/0]] Greek Primary set of graphic characters
- [[94集合]] [N[6/11]] Arabic Primary set of graphic characters
- [[94集合]] [N[4/8]] Hebrew Supplementary set of graphic characters
- [[94[SUP[2]]集合]] [N[4/5]] Chinse coded ideogram set for communication
-- [15] [[ISO-IR 165]]
- [[94集合]] [N[2/0]] [N[4/1]] Chinese graphic DRCS
- [[94集合]] [N[2/0]] [N[4/0]] Chinese character DRCS


[55] L-set [SRC[PDF2 p.40]]

- L-set に固定シフト (L-set activation)
-- "mosaic" (MBK MSR MSG MSY MSB MSM MSC MSW)
--- 次の row の先頭で G-set にシフトする
-- serial C1-controls [N[5/0]] - [N[5/7]]
- L-set から G-set にシフト (L-set deactivation)
-- FOREGROUND COLOUR "alpha" (ABK ANR ANG ANY ANB ANM ANC ANW)
-- serial C1-controls [N[4/0]] - [N[4/7]]
-- parallel C1-set の呼び出し
-- entering new line
-- [[GL]] に[[G集合]]の呼び出し

[57] [[C0]]

- 0/14 SO
- 0/15 SI
- 1/2 RPT
- 1/9 SS2
- 1/11 ESC
- 1/13 SS3
- 1/15 APA = US
- など

[54] 引数付き[[制御文字]]

- RPT [VAR[P]] (下位6ビット)
- APA [VAR[P]] [VAR[P]] (各下位6ビット)

[58] 
attributes 
FOREGROUND COLOUR,
BACKGROUND COLOUR, 
LINED, 
SIZE, 
FLASH, 
CONCEAL, 
INVERT,
WINDOW/BOX

- ESC 2/3 2/0 (Fe) = full screen attributes
- ESC 2/3 2/1 (Fe) = full row attributes

[VAR[Fe]] は parallel C1 set の [[ESC Fe]] の[[ビット組合せ]]、
例えば [N[4/1]] が Red foreground を表す。



[66] 
US 2/3 DRCS 関係 [SRC[PDF2 p.248]]

- US 2/3 2/0 [VAR[ICS]] [VAR[SDC]] [VAR[SCM]] [VAR[SSA]]
-- 引数すべて省略可能
-- [VAR[ICS]] = 2/[VAR[h]] [VAR[F]] ([VAR[F]] は[[指示]]用の[[中間バイト]] (なし、 [N[2/0]] 可能) + [[終端バイト]])
-- [VAR[SDC]] は 3/[VAR[h]] 4/[VAR[h]] 3/[VAR[h]] 4/[VAR[h]]
-- [VAR[SCM]] は 5/[VAR[h]]
-- [VAR[SSA]] は 6/[VAR[h]]
- pattern transfer unit = US 2/3 [VAR[Y]] [VAR[pattern data]]
-- [VAR[Y]] は[[ビット組合せ]] [ [N[2/1]], [N[7/14]] ]
-- [VAR[pattern data]]

[59] 
Geometric なデータの符号化
[SRC[PDF2 p.175]]

primitive は opcode の後に operand を何個かで表す。

opcode は [ [N[2/0]], [N[3/15]] ]

operand は [ [N[4/0]], [N[7/15]] ] または文字列

文字列 character string は [CODE[SOS]] から始まり [CODE[ST]] で終わる


[68] PHOTOGRAPHIC
[SRC[PDF2 p.223]] 

- [[C0]] videotex control codes
- [ [N[2/0]], [N[3/15]] ] photovideotex parameters
- [ [N[4/0]], [N[7/15]] ] Pixel Data



[69] 
TELESOFTWARE
[SRC[PDF2 p.322]]

TDU = CI field、LI field、Parameter field

ただし basic kernel (という実装水準) は一部 CI field のみの TDU を使う。

CI (Command Identifier) 種別を表す

LI (Length Indicator) 長さを表す。 1バイトで [ [N[0]], [N[254]] ]、
3バイト (先頭バイト [N[15/15]]) で [ [N[255]], [N[65534]] ]

Parameter fuekd は LI で指定された長さ。

[70] basic kernel のとき CI のみ: CI = 3/1, 3/2, 3/8, 3/6


[67] 
TRANSPARENT = US 3/15 
[SRC[PDF2 p.262]]

不透明データ。最初のバイト [VAR[N]] が長さを表す。

- [VAR[N]] = 0 : 無制限
- [VAR[N]] = [ [N[1]], [N[254]]] : バイト値の長さ
- [VAR[N]] = 255 : 未定義

バイト値が指定されていれば、 [VAR[N]] の次から数え始めてそのバイト数で終了。

バイト値に関わらず、次の VPCE が検知されたら終了 (中断)。

[CODE[US]] が出現すると次の VPCE とみなされる。回避するには2連続にする。
バイト数カウントは1バイト分になる。


[62] 
状態リセット: 各種状態 + 文字コード状態を変更
[SRC[p.264]] 

- General Display Reset
-- US 2/15 4/1 : serial C1 set を呼び出し
-- US 2/15 4/2 : parallel C1 set を呼び出し
-- Reset Control and Graphic Sets 相当の操作
-- その他状態リセット
- Reset Control and Graphic Sets 
-- 既定の図形文字集合を指示
-- G0 = GL
-- G2 = GR
-- alpha-mosaic data 状態に
-- US 2/15 4/3 : serial C1 set を呼び出し
-- US 2/15 4/4 : parallel C1 set を呼び出し
- Service Break to Row X
-- G0 = primary set of graphic characters
-- G2 = supplementary set of graphic characters
-- G0 = GL
-- G2 = GR
-- US 2/15 4/0 [VAR[RN]] : serial C1 set を呼び出し
-- US 2/15 4/5 [VAR[RN]] : parallel C1 set を呼び出し
-- [VAR[RN]] = [ [N[4/0]], [N[7/15]] ] : row (下位6ビット)
-- この後、 US 2/15 4/15 で変更前の状態にリセット


[63] [CODE[DOCS]] の直後にはプロファイルを記述する [SRC[p.398, PDF2 p.1]]

- ESC 2/5 4/4 [VAR[profile]] 6/0

[VAR[profile]]:

- [N[6/0]] alphamosaic profile 1
- [N[6/1]] alphamosaic profile 2
- [N[6/2]] alphamosaic profile 3
- [N[6/3]] alphamosaic profile 4
- [N[6/4]] alphamosaic profile 5
- [N[6/8]] geometric profile x 1
- [N[6/9]] geometric profile x 2
- [N[7/14]] [VAR[P]] ASCII display mode 
-- [VAR[P]] = [ [N[4/1]], [N[4/5]] ]


[VAR[profile]] は複数可


** Data Syntax III

[71] 北米向け

[72] [SRC[PDF3 p.8, p.109]]

- [[ISO/IEC 2022]] [[7ビット符号]]/[[8ビット符号]]
- C0 ESC 2/1 4/11
- C1 ESC 2/2 4/6
- GL = G0 primary set
- GR = G1 PDI
- G2 supplementary set
- G3 mosaic
- [[94集合]] 4/2 primary character set
- [[94集合]] 7/12 supplementary character set
- [[96集合]] ESC I 5/7 : PDI
- [[96集合]] ESC I 7/13 : Mosaic set
- [[96集合]] ESC I 7/10 ESC I 2/0 7/10 : Macro set
- [[96集合]] ESC I 7/11 ESC I 2/0 7/11 : DRCS
- [[96集合]]の [VAR[I]] は 2/9, 2/10, 2/11 / 2/13, 2/14, 2/15
- [[固定シフト]]、[[単独シフト]]、[[指示シーケンス]]
-- LS1R LS2R LS3R に ESC 7/14 7/13 7/12 のほか、 ESC 6/11 6/12 6/13
- [[ISO/IEC 9281]] [[PCD]]




* メモ