* Uniscribe の処理モデル

[2] 
[[Uniscribe]] は[[用字系]]ごとに [DFN[shaping engine]]
を持っています。
[SRC[>>1, >>3]]

[6] また, 特別に対応していない[[用字系]]用の
[[OpenType Layout]] [[shaping engine]] も持っています。
[SRC[>>1]]

[4] 
[[Uniscribe]] は入力の[[文字列]]を[[項目]]群, [[連なり]]群, [[クラスター]]群の3階層に分割します。
[SEE[ [[連なり]] ]]

[5] 
[[クラスター]]は[[用字系]]によって決まる、[[文字]]群の基本的な要素です。
[SRC[>>3]]
[[Unicode]] でいう[[書記素クラスター]]に相当する単位と思われますが、
同じかどうかは不明。

[7] 
[[Uniscribe]] は[RUBYB[文字の前処理][character preprocessing]]も行います。
入力 ([[Unicode]] の[[文字列]]) は[[論理順]]になっていますが、
前処理で[[グリフ]]処理に都合の良い順序に並べ替えます。
具体的には [[Unicode]] の規定によります。
[SRC[>>3]]

[EG[
[8] 
例えば[[基底文字]]の左右に[[結合文字]]が表示されるような場合でも
[[Unicode]] では必ず[[基底文字]]が先になりますが、
ここで左、[[基底文字]]、右の順序に並べ替えたりすることがあります。
]EG]

[11] 
[CODE[GSUB]] を駆使すれば文字前処理の並べ替えをしなくても[[フォント]]側で[[グリフ]]決定をすべて行うこともできるのでしょうが、
それでは[[フォント]]開発が大変になるようです。
文字前処理があるので[[フォント]]開発で複雑な条件をたくさん記述しなくてもよいのです
[SRC[>>3]]。

;; [12] そのかわり [[Uniscribe]] 相当の [[shaping]] をしていなかった古い実装で
[[shaping]] 前提の[[フォント]]を使っても正しく表示されないのです。

[9] 
結果得られた[[Unicode文字]]の列が [[OTLS]] に渡されます。
適宜[[機能][フォント機能]]を適用します。
[SRC[>>3]]

[EG[
[10] 
例えば[[アラビア文字]]の場合は[[単語]]の単位を検出して、
[[語頭形]]、[[語中形]]などを表す[[機能][フォント機能]]を各[[クラスター]]に適宜指定することになります。
]EG]


[REFS[
-
[1] [CITE@ja-jp[OpenType development (LEGACY INFORMATION) - Typography | Microsoft Docs]], [[nihar]], [TIME[2022-08-27T06:22:28.000Z]] <https://docs.microsoft.com/ja-jp/typography/develop/otdevinfo>
-
[3] [CITE@ja-jp[OpenType glyph processing (part 1) - Typography | [[Microsoft]] Docs]], [[alib-ms]], [TIME[2022-08-27T07:59:48.000Z]] <https://docs.microsoft.com/ja-jp/typography/develop/processing-part1#uniscribe>
]REFS]

* 歴史

[58] [[タグ文字]]による指定を
[[character shaping]]
に影響する指定に使える可能性があるとされていました。

* メモ