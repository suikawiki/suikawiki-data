* 仕様書

[REFS[
- [3] '''[CITE@en[DOM Standard]] ([TIME[2016-04-26 13:45:33 +09:00]] 版) <https://dom.spec.whatwg.org/#dom-element-attachshadow>'''
- [14] [CITE@en[DOM Standard]] ([TIME[2016-04-26 17:13:41 +09:00]] 版) <https://dom.spec.whatwg.org/#dictdef-shadowrootinit>
]REFS]

* 処理

[4] [CODE(DOMi)@en[Element]] [[インターフェイス]]の
[DFN[[CODE(DOMm)@en[attachShadow]]]] [[メソッド]]は、
次のようにしなければ[MUST[なりません]] [SRC[>>3]]。
[FIG(steps)[
= [5] [VAR[状態]]を、第1引数を[[辞書]] [CODE(DOMi)@en[ShadowRootInit]] として解釈した結果に設定します。
= [6] [[文脈オブジェクト]]が、[[影ホスト]]となれる[[要素]]のいずれかでなければ、
== [7] [CODE(DOMe)@en[NotSupportedError]] [[例外]]を[[投げ]]、ここで停止します。
= [8] [[文脈オブジェクト]]が[[影ホスト]]なら、
== [9] [CODE(DOMe)@en[InvalidStateError]] [[例外]]を[[投げ]]、ここで停止します。
= [10] [VAR[影]]を、[[影根]]に設定します。
[FIG(list members)[
: [F[節点文書]] : [[文脈オブジェクト]]の[F[節点文書]]
: [F[ホスト][host (DOM)]] : [[文脈オブジェクト]]
: [F[モード][ShadowRootMode]] : [VAR[状態]]の [CODE[mode][ShadowRootMode]]
]FIG]
= [11] [[文脈オブジェクト]]の[F[影根]]を、[VAR[影]]に設定します。
= [12] [VAR[影]]を返します。
]FIG]

[15] [[辞書]] [DFN[[CODE(DOMi)@en[ShadowRootInit]]]] [SRC[>>14]] は、
次の[[メンバー]]を持ちます。
[FIG(list members)[
- [CODE(DOMa)@en[mode][ShadowRootMode]] ([CODE(DOMi)@en[ShadowRootMode]]、[[必須]])
]FIG]

[13] [[影ホスト]]となれる[[要素]]は、次のものです [SRC[>>3]]。
[FIG(list short)[
- [[妥当なカスタム要素]]
- [CODE(HTMLe)@en[article]]
- [CODE(HTMLe)@en[aside]]
- [CODE(HTMLe)@en[blockquote]]
- [CODE(HTMLe)@en[body]]
- [CODE(HTMLe)@en[div]]
- [CODE(HTMLe)@en[footer]]
- [CODE(HTMLe)@en[h1]]
- [CODE(HTMLe)@en[h2]]
- [CODE(HTMLe)@en[h3]]
- [CODE(HTMLe)@en[h4]]
- [CODE(HTMLe)@en[h5]]
- [CODE(HTMLe)@en[h6]]
- [CODE(HTMLe)@en[header]]
- [CODE(HTMLe)@en[nav]]
- [CODE(HTMLe)@en[p]]
- [CODE(HTMLe)@en[section]]
- [CODE(HTMLe)@en[span]]
]FIG]

* 歴史

[1] [CITE@en[Shadow: define .attachShadow() and .shadowRoot · whatwg/dom@1699495]]
([TIME[2016-03-16 14:27:36 +09:00]] 版)
<https://github.com/whatwg/dom/commit/169949553da85cfee6b03df361ed3e8142ddc54e>

[2] [CITE@en[Shadow: define attachShadow() for custom elements · whatwg/dom@b8d2854]]
([TIME[2016-04-17 14:01:34 +09:00]] 版)
<https://github.com/whatwg/dom/commit/b8d2854152aaabc412063c67bcb4177d8a2607a1>