* API を使う

** 地図の表示範囲を指定したい

[6] Map オブジェクトの [CODE[panTo]] メソッドで指定できます。

** 線の一部区間だけ色を変えたい

[3] Polyline を区間ごとに分割してそれぞれの色を指定すれば良い。

** 線に縁取りしたい

[4] 太い Polyline の上に細い Polyline を重ねるしかない?

** 線に沿って文字を描きたい

[7] 難しそう。

** Poyline に tooltip を指定したい

[8] 無理そう。

[13] mouseover で地図を含む要素に title 属性を設定して、
mouseout で元に戻せばできるかも?

** マーカーをドラッグしたとき、ドロップ先をいくつかの座標候補に限定させたい

[5] API にそういう機能は無さそう。 drag イベントでドラッグ位置の直近の座標を自分で計算して Marker 位置を設定すれば良い。

** 右クリックでメニューを表示したい

[9] 右クリックされたことは [CODE[rightclick]] イベントで取得できます。

[11] 地図上の[[クリック]]も標準状態では地図の外側の [[DOM]] [[要素]]の[[イベント]]として[[伝播]]しますが、
[[Google Maps]] の [CODE[click]] や [CODE[rightclick]] のイベントにコールバック関数を登録していると、
地図外には伝播しなくなる (場合もある) ようです。

[10] コールバック関数の引数の [CODE[MouseEvent]] オブジェクトは、
ドキュメントによると [CODE[latLng]] プロパティーしかありませんが、
実際には ([CODE[Map]] オブジェクトの場合) [CODE[pixel]] プロパティーがあって、そこから [CODE[x]] と [CODE[y]]
の座標が取得できます。 (ドキュメントにないのですが、世間ではまま使われているようです。)
[CODE[Map]] 以外のオブジェクトでの右クリックだと [CODE[pixel]]
は利用できないことがあります。

[12] より安全・確実に地図画面上の座標を取得したいときは、少し面倒ですが、 OverlayView から
getProjection で取得できるオブジェクトを使うと良いようです。
(Map の getProjection は少し違っていて、同じことはできないようです。)

[FIG[
[PRE(js code)[
  var Overlay = function () { };
  Overlay.prototype = new google.maps.OverlayView();
  Overlay.prototype.onAdd = function () {
  };
  Overlay.prototype.draw = function () {
  };
  Overlay.prototype.onRemove = function () {
  };

  var overlay = new Overlay;
  overlay.setMap (map);

  object.addListener ('rightclick', function (ev) {
    var xy = map.getProjection ().fromLatLngToContainerPixel (ev.latLng);
    console.log (xy.x, xy.y);
  });
]PRE]
]FIG]

** 線の近く数ピクセルのクリックでも線をクリックしたことにしたい

[14] 無理そう。 Map の click などで自力でがんばればできる。

** 座標により細かくマウスカーソルを制御したい

[15] 無理そう。 OverlayView で自力でがんばればできるかも。

* メモ

[2] [CITE@en[Google Maps JavaScript API V3 Reference  |  Google Maps JavaScript API  |  Google Developers]] ([TIME[2016-06-01 10:39:27 +09:00]] 版) <https://developers.google.com/maps/documentation/javascript/reference>

[FIG(quote)[
[FIGCAPTION[
[1] [CITE@ja[Google Japan Blog: Google マップの不動産検索について]]
([TIME[2016-03-02 13:52:41 +09:00]] 版)
<http://googlejapan.blogspot.jp/2011/01/google_27.html>
]FIGCAPTION]

> 2009 年 7 月に米国で、2010 年 8 月に日本でも開始した Google マップの不動産検索機能は、「多くの物件情報を一度に地図上に表示する」というコンセプトを非常に高く評価していただきました。しかしながら、実際のサービスの利用増加にはなかなか繋がらず、様々な側面から検討した結果、断腸の思いではありますが、本年 2 月 11 日をもって、サービスを停止することになりました。サービスの停止は、日本を始め、今日同サービスを提供しているすべての地域(米国、オーストラリア、ニュージーランド、英国)が対象となります。

]FIG]
