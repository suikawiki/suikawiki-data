* 仕様書

[REFS[
- [11] [CITE@en[DOM Standard]] ([TIME[2016-04-22 01:14:08 +09:00]] 版) <https://dom.spec.whatwg.org/#shadow-tree-slots>
- [25] [CITE@en[DOM Standard]] ([TIME[2016-04-22 01:14:08 +09:00]] 版) <https://dom.spec.whatwg.org/#light-tree-slotables>
]REFS]

* スロット

[13] [[スロット]]は、 [CODE(HTMLe)@en[slot]] [[要素]]です [SRC[>>11]]。

[12] [[影木]]は、[[スロット]]をいくつか持つことがあります [SRC[>>11]]。

[4] [DFN[[RUBYB[既定スロット]@en[default slot]]]]は、
[[影木]]中、[F[名前][スロット名]]が[[空文字列]]の[[スロット]]のうち[[木順]]で最初のものです
[SRC[>>11]]。

[14] [[スロット]]は、次の状態を持ちます。
[FIG(list members)[
: [DFN[[F[[RUBYB[[[名前][スロット名]]]@en[name]]]]]] :
[[既定値]]は、[[空文字列]]です。 [SRC[>>11]]
: [DFN[[F[[RUBYB[割り当て済み節点群]@en[assigned nodes]]]]]] :
[[スロット可能]]の[[リスト]]です。[[既定値]]は、空です。 [SRC[>>11]]
]FIG]

[15] [[属性変更手順群]]は、次のようなものです [SRC[>>11]]。
[FIG(steps)[
= [16] 次の条件のすべてを満たす場合:
[FIG(list)[
- [18] [VAR[要素]]が [CODE(HTMLe)@en[slot]]
- [17] [VAR[局所名]]が [CODE(HTMLa)@en[name][<slot name>]] で[VAR[名前空間]]が [[null]]
- [19] 次のいずれかではない:
-- [VAR[値]]が[VAR[古い値]]と等しい
-- [VAR[値]]が [[null]] で[VAR[古い値]]が[[空文字列]]
-- [VAR[値]]が[[空文字列]]で[VAR[古い値]]が [[null]]
]FIG]
== [20] [VAR[値]]が [[null]] や[[空文字列]]なら、
=== [21] [VAR[要素]]の[F[名前][スロット名]]を、[[空文字列]]に設定します。
== [22] それ以外なら、
=== [23] [VAR[要素]]の[F[名前][スロット名]]を、[VAR[値]]に設定します。
== [24] [VAR[要素]]の[F[木]]について、[[木のスロット可能を割り当て]]します。
]FIG]

* スロット可能

[26] [DFN[[RUBYB[スロット可能]@en[slotable]]]]は、
[CODE(DOMi)@en[Element]] と [CODE(DOMi)@en[Text]] です [SRC[>>25]]。

[27] [[スロット]]も[[スロット可能]]です [SRC[>>25]]。

;; [41] [[スロット]]も[[スロット可能]]も共に同名の「[F[名前][スロット名]]」
を持ちますが、両者は別の内部状態と思われます。

[28] [[スロット可能]]は、次の状態を持ちます。
[FIG(list members)[
: [DFN[[F[[RUBYB[[[名前][スロット名]]]@en[name]]]]]] :
[[既定値]]は、[[空文字列]]です。 [SRC[>>25]]
: [DFN[[F[[RUBYB[[[割り当て済みスロット]]]@en[assigned slot]]]]]] :
[[スロット]]または [[null]]。[[既定値]]は [[null]] です。 [SRC[>>25]]
: [DFN[[F[[RUBYB[[[割り当て済み]]]@en[assigned]]]]]] :
[F[割り当て済みスロット]]が [[null]] でないことをいいます [SRC[>>25]]。
]FIG]

[29] [[属性変更手順群]]は、次のようなものです [SRC[>>25]]。
[FIG(steps)[
= [30] 次の条件のすべてを満たす場合:
[FIG(list)[
- [31] [VAR[局所名]]が [CODE[slot]] で[VAR[名前空間]]が [[null]]
- [32] 次のいずれかではない:
-- [VAR[値]]が[VAR[古い値]]と等しい
-- [VAR[値]]が [[null]] で[VAR[古い値]]が[[空文字列]]
-- [VAR[値]]が[[空文字列]]で[VAR[古い値]]が [[null]]
]FIG]
== [33] [VAR[値]]が [[null]] や[[空文字列]]なら、
=== [34] [VAR[要素]]の[F[名前][スロット名]]を、[[空文字列]]に設定します。
== [35] それ以外なら、
=== [36] [VAR[要素]]の[F[名前][スロット名]]を、[VAR[値]]に設定します。
== [37] [VAR[要素]]が[F[割り当て済み][割り当て済みスロット]]なら、
=== [38] [VAR[要素]]の[F[割り当て済みスロット]]について、[[スロット可能の割り当て]]をします。
== [39] それ以外なら、
=== [40] [VAR[要素]]について[[スロットの割り当て]]をします。
]FIG]

* 歴史

[1] [CITE@en[Shadow: define slots and slotables · whatwg/dom@a2b04df]]
([TIME[2016-03-24 21:51:28 +09:00]] 版)
<https://github.com/whatwg/dom/commit/a2b04df51b4342d7617c128e80e5aa892889d2e0>

[2] [CITE@en[Shadow: define assignedSlot of Element and Text · whatwg/dom@b8e1ccf]]
([TIME[2016-03-24 21:54:25 +09:00]] 版)
<https://github.com/whatwg/dom/commit/b8e1ccf857b6ac483f708336dff4b7ee48393191>

[3] [CITE@en[Shadow: define superglobal slot content attribute · whatwg/dom@e3d8291]]
([TIME[2016-03-24 21:56:23 +09:00]] 版)
<https://github.com/whatwg/dom/commit/e3d82914676ad1e1bf590e1042636e60feddb6ae>

[5] [CITE@en[Editorial: mention that step="" conformance requirements are out of s… · whatwg/dom@e996bdc]]
([TIME[2016-03-24 22:00:10 +09:00]] 版)
<https://github.com/whatwg/dom/commit/e996bdc52ef951113d2a6edc43828ec2dba23e83>

[6] [CITE@en[The DOM Standard defines the class, id, and slot attributes · whatwg/html@36c9938]]
([TIME[2016-03-24 22:01:06 +09:00]] 版)
<https://github.com/whatwg/html/commit/36c9938b102fecadf6029a248f40aae83ea099d2>

[7] [CITE@en[Shadow: define slotchange event · whatwg/dom@81566a3]]
([TIME[2016-04-20 12:29:10 +09:00]] 版)
<https://github.com/whatwg/dom/commit/81566a31a393d6fc07332f92a2a5d551dc7c96bd>

[8] [CITE@en[Editorial: distributed -> flattened · whatwg/dom@e35b570]]
([TIME[2016-04-20 12:32:04 +09:00]] 版)
<https://github.com/whatwg/dom/commit/e35b5706252b99f69a836e82e6ae9ebc76cdb2c7>

[9] [CITE@en[Editorial: add "shadow host" and "assigned" as terms · whatwg/dom@8ae8749]]
([TIME[2016-04-21 12:47:20 +09:00]] 版)
<https://github.com/whatwg/dom/commit/8ae87496beb249925a3a72cf62aee9987e3620eb>

[10] [CITE@en[Shadow: <slot> is now defined in HTML · whatwg/dom@fdad8cb]]
([TIME[2016-04-22 17:45:48 +09:00]] 版)
<https://github.com/whatwg/dom/commit/fdad8cb90a78b399cd2bdf5a20c1960649697462>