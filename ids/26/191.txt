[4] [[スクリプト]]は、[[利用者]]または[[利用者エージェント]]により、
実行途中で中断されることがあります。

* 仕様書

[REFS[
- [49] [CITE@en-US-x-hixie[HTML Standard]] ([TIME[2014-04-03 03:44:44 +09:00]] 版) <https://www.whatwg.org/specs/web-apps/current-work/#killing-scripts>
]REFS]

* 制限と中断

[51] [[閲覧文脈]]は[[スクリプトが有効]]、[[スクリプトが無効]]の状態を有しており、
[[利用者エージェント]]の対応状況、[[利用者]]の設定、[[著者]]の指定によってどちらであるかが決定します。
[[スクリプトが無効]]の場合、[[スクリプト]]が作成されなかったり、[[スクリプト]]の実行が実際の内容に関わらず
「何もしない」となったり (>>28) します。詳しくは[[スクリプトが無効]]の項をご覧ください。

[54] [[スクリプト]]の実行中に[[スクリプト]]が無効になったときは、ただちに[[スクリプト]]を終端する[['''べきです''']]
[SRC[>>49]]。

[52] [[利用者エージェント]]は、[[スクリプト]]に対して[[資源]]の制限を課して[['''構いません''']]。
例えば、[[CPU]] [[quota]]、[[メモリー]]の制限、合計実行時間の制限、[[帯域]]の制限などを課すことができます。 [SRC[>>49]]

[53] [[スクリプト]]が制限を超えた時は、 [CODE(DOMc)@en[[[QuotaExceededError]]]] [[例外]]を[[投げる]]か、
[[例外]]なしで中断するか、[[利用者]]に確認するか、[[スクリプト]]の実行に[RUBYB[[[絞り弁]]]@en[throttele]]を適用するかして[['''構いません''']]。
[SRC[>>49]]

;; [63] [[ハードウェア等の制約に関する条項]]も参照。

[68] [[ワーカー]]では、[[ワーカーを殺す]]操作や[[ワーカーの停止]]操作により、
[[スクリプト]]の実行が中断されることがあります。

* 実行との関係

[5] [[JavaScript]] の [CODE[[[ScriptEvaluation]]]] 
([[古典スクリプトの実行]]から呼び出されます。) や
[CODE[[[ModuleEvaluation]]]]
([[モジュールスクリプトの実行]]から呼び出されます。)
は、[[走っているスクリプトの実行中断]]により、
結果を返さずに途中で中断されることがあります。

;; [6] これらは [[HTML Standard]] では規定されていますが、
[[JavaScript]] の仕様書では明文化されていません。

* 歴史

[3] [[ブラクラ]]のような悪意ある[[スクリプト]]の濫用や、
悪意がなくても [[Webブラウザー]]や[[OS]]の動作を不安定にする
[[JavaScript]] [[アプリケーション]]から[[利用者]]を守るため、
00年代半ば頃から徐々に[[スクリプト]]の実行中断機能が [[Webブラウザー]]に実装されるようになってきました。

** HTML5

[58] [[スクリプト]]を実行途中で実行時間の長さなどを根拠に中断しても良いことは [[HTML5]]
で明文化されました。

** 2016年改訂

[2] 2016年2月には、更に明確化が行われました。

[1] [CITE@en[Fix #715: clarify how aborting a running script works · whatwg/html@6a48bfb]] ([TIME[2016-02-24 14:40:25 +09:00]] 版) <https://github.com/whatwg/html/commit/6a48bfbf1066034eab4786d62ba4017593c48430>