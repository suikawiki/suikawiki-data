* 仕様書

[REFS[
- [7] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-05-06 10:42:35 +09:00]] 版) <https://html.spec.whatwg.org/#dom-document-open>
- [31] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-05-06 10:42:35 +09:00]] 版) <https://html.spec.whatwg.org/#dom-open>
- [43] [CITE@en[CSSOM View Module]] ([TIME[2015-05-06 18:05:35 +09:00]] 版) <http://dev.w3.org/csswg/cssom-view/#the-features-argument-to-the-open()-method>
- [58] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-05-06 10:42:35 +09:00]] 版) <https://html.spec.whatwg.org/#an-overridden-reload>
]REFS]

* メソッド呼び出し

[8] [CODE(DOMi)@en[[[Document]]]] [[インターフェイス]]の
[DFN[[CODE(DOMm)@en[[[open]]]]]] [[メソッド]]は、次のように処理しなければ[['''なりません''']]
[SRC[>>7]]。
[FIG(steps)[
= [[引数]]が3つ[[以上]]あれば、
== 最初の3つの[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。
== 4つ目の[[引数]]は [CODE(IDL)@en[[[boolean]]]] として解釈します。既定値は[[偽]]とします。
== [[文脈オブジェクト]]の [CODE(DOMi)@en[[[Window]]]] [[オブジェクト]]があれば、
=== その [CODE(DOMi)@en[[[Window]]]] 用の処理を実行します。
= それ以外なら、
== 最初の[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。既定値は
[CODE(MIME)@en[[[text/html]]]] とします。
== 2つ目の[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。既定値は[[空文字列]]とします。
== [CODE(DOMi)@en[[[Document]]]] 用の処理を実行します。
]FIG]

;; [69] [CODE(JS)@en[[[document.open]]]] 相当の処理は、 [CODE(JS)@en[[[document.write]]]]
から呼び出されることがあります。

[32] [CODE(DOMi)@en[[[Window]]]] [[インターフェイス]]の
[DFN[[CODE(DOMm)@en[[[open]]]]]] [[メソッド]]は、次のように処理しなければ[['''なりません''']]
[SRC[>>31]]。
[FIG(steps)[
= 最初の[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。既定値は
[CODE(MIME)@en[[[about:blank]]]] とします。
= 2つ目の[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。既定値は
[CODE(HTML)@en[[[_blank]]]] とします。
= 3つ目の[[引数]]を [CODE(IDL)@en[[[DOMString]]]] として解釈します。既定値は[[空文字列]]とします。
ただし [[null]] は[[空文字列]]とします ([CODE(IDL)@en[[[TreatNullAs=EmptyString]]]])。
= 4つ目の[[引数]]は [CODE(IDL)@en[[[boolean]]]] として解釈します。既定値は[[偽]]とします。
= [CODE(DOMi)@en[[[Window]]]] 用の処理を実行します。
]FIG]

* [CODE(DOMi)@en[Window]] 用の処理

[33] 次のようにしなければ[['''なりません''']] [SRC[>>31]]。
[FIG(steps)[
= [[閲覧文脈]]の選択 (>>40) を行います。第2引数を[[閲覧文脈名]]として引き渡します。
= [[閲覧文脈]]が返されたなら、
== これを[VAR[対象閲覧文脈]]に設定します。
== [VAR[始点閲覧文脈]]が指定されていれば、その値を使います。
指定されていなければ、[VAR[始点閲覧文脈]]は[[入口設定群オブジェクト]]の[[有責閲覧文脈]]とします。
== [VAR[新しい]]フラグが指定されていれば、その値を使います。
指定されていなければ、[VAR[新しい]]は[[偽]]とします。
= そうでなければ、
== [CODE(DOMe)@en[[[InvalidAccessError]]]] [[例外]]を投げ、停止します。
= 第1引数が[[空文字列]]以外なら、
== 第1引数について[[入口設定群オブジェクト]]の[[API基底URL]]について[[URLの解決]]を行います。
== 解決が失敗したら、
=== 第1引数を[[空文字列]]に設定しても構いません。
=== そうでなければ、[VAR[新しい[[資源]]]]はエラーページとします ([[navigate]] の非文書の項を参照)。
== そうでなければ、
=== [VAR[新しい[[資源]]]]は、解決結果の [[URL]] とします。
= 第1引数が[[空文字列]]なら、
== [VAR[新しい]]が[[偽]]なら、
=== [VAR[対象閲覧文脈]]の [CODE(DOMi)@en[[[WindowProxy]]]] [[オブジェクト]]を返し、停止します。
== それ以外なら、
=== [VAR[新しい[[資源]]]]は、 [[URL]] [CODE(URI)@en[[[about:blank]]]] とします。
= [VAR[新しい[[資源]]]]が [[URL]] [CODE(URI)@en[[[about:blank]]]] で[VAR[新しい]]が[[真]]なら、
== [[タスク]]を[[タスクキュー]]に追加します。
[FIG(list members)[
[FIGCAPTION[
[[タスク]]
]FIGCAPTION]
:[[タスク源]]:?
:処理:
[FIG(steps)[
= [[単純イベントを発火]]します。
[FIG(list members short)[
[FIGCAPTION[
[[単純イベント]]
]FIGCAPTION]
:[[イベント型]]:[CODE(DOMe)@en[[[load]]]]
:[[対象]]:[VAR[対象閲覧文脈]]の [CODE(DOMi)@en[[[Window]]]] [[オブジェクト]]
:[[target override]]:[VAR[対象閲覧文脈]]の [CODE(DOMi)@en[[[Window]]]] [[オブジェクト]]の[[文書]]
]FIG]
]FIG]
]FIG]
= それ以外なら、
== [[navigate]] します。
[FIG(list members short)[
:[[navigate]] する[[閲覧文脈]]:[VAR[対象閲覧文脈]]
:新しい[[資源]]:[VAR[新しい[[資源]]]]
:[[例外有効]]:[[真]]
:[[置換有効]]:[VAR[新しい]]か否かと同じ
:[[始点閲覧文脈]]:[VAR[始点閲覧文脈]]
]FIG]
= [VAR[対象閲覧文脈]]の [CODE(DOMi)@en[[[WindowProxy]]]] [[オブジェクト]]を返します。
]FIG]

* 閲覧文脈の選択

[40] [CODE(JS)@en[[[window.open]]]] (相当) の実行時に、
[[利用者エージェント]]は[[利用者]]に [[navigate]] 先の[[閲覧文脈]]を指示する手段を提供できます
[SRC[>>31]]。

[EG[
[34] 例えば [KBD[[[Ctrl]]]] + [[クリック]]で新しい[[タブ]]で[[リンク]]を開く[[利用者エージェント]]は、
[CODE[[[onclick]]]] 時に [KBD[[[Ctrl]]]] が押されていれば、
そこから呼び出された [CODE(JS)@en[[[window.open]]]] において新しい[[タブ]]の[[閲覧文脈]]が指示されたとみなすことができます [SRC[>>31]]。
]EG]

[41] [[利用者]]の指示があった場合には、その[[閲覧文脈]]を使います [SRC[>>31]]。
新しい[[最上位閲覧文脈]]との指示なら、新しい[[最上位閲覧文脈]]を作って、それを使います。
新しい[[最上位閲覧文脈]]の場合は、 [VAR[始点閲覧文脈]]を、選択された[[閲覧文脈]]の 
[[one permitted sandboxed navigator]] に、
[VAR[新しい]]フラグを[[真]]に設定しなければ[['''なりません''']] [SRC[>>31]]。

[42] [[利用者]]の指示が無い場合には、
[[rules for choosing a browsing context given a browsing context name]]
により選択しなければ[['''なりません''']] [SRC[>>31]]。
ただし[[閲覧文脈名]]として[[空文字列]]が指定された時は、
[CODE[[[_blank]]]] が指定されたとみなします [SRC[>>31]]。またこの結果、
該当する[[閲覧文脈]]無しとの結果になることもあります。
新しい[[最上位閲覧文脈]]が作られた場合は、[VAR[新しい]]フラグを[[真]]に設定しなければ[['''なりません''']] [SRC[>>31]]。

@@
[44] 新しい[[最上位閲覧文脈]]が作成された場合で、それが [[auxiliary browsing context]]
なら、
[[CSSOM View]] の規定を適用しなければ[['''なりません''']] [SRC[>>31, >>43]]。

* [CODE(DOMi)@en[Document]] 用の処理

[46] 次のようにしなければ[['''なりません''']]。

[FIG(steps)[
= 事前条件確認:
== [[文書]]が [[HTML文書]]でなければ、
=== [CODE(DOMe)@en[[[InvalidStateError]]]] [[例外]]を投げ、停止します [SRC[>>7]]。
== [[文書]]が[[活性文書]]でなければ、
=== [[文脈オブジェクト]]を返します。
=== 停止します [SRC[>>7]]。
== [[文書]]が[[活性構文解析器]]を持ち、その [[script nesting level]] が[[正]]なら、
=== [[文脈オブジェクト]]を返し、停止します [SRC[>>7]]。
== [[文書]]の [[ignore-opens-during-unload counter]] が[[正]]なら、
=== [[文脈オブジェクト]]を返し、停止します [SRC[>>7]]。
= [VAR[型]]:
== 第''1''引数が [CODE[[[replace]]]] ([[ASCII大文字・小文字不区別]]) なら、
=== [VAR[型]]を、 [[HTML]] に設定します [SRC[>>7]]。
== それ以外で、第1引数から [CODE[[[;]]]] とそれ以降を (あれば) 削除してから、
先頭と末尾から[[HTMLの空白文字]]を (あれば) 削除し、
[CODE(MIME)@en[[[text/html]]]] ([[ASCII大文字・小文字不区別]]) となれば、
=== [VAR[型]]を、 [[HTML]] に設定します [SRC[>>7]]。
== それ以外なら、
=== [VAR[型]]を、[[平文]]に設定します [SRC[>>7]]。
= [VAR[置換]]:
== 第2引数が [DFN[[CODE[[[replace]]]]]] ([[ASCII大文字・小文字不区別]]) なら、
=== [VAR[置換]]を、[[真]]に設定します [SRC[>>7]]。
== それ以外で、
[FIG(list)[
- [[文書]]の[[閲覧文脈]]の[[セッション履歴]]が[[文書]]を1つだけ含み、
- それが[[閲覧文脈]]作成時の [CODE(URI)@en[[[about:blank]]]] [[文書]]で、
- その[[文書]]について [[unload a document]] が呼ばれていないなら、
]FIG]
=== [VAR[置換]]を、[[真]]に設定します [SRC[>>7]]。
== それ以外なら、
=== [VAR[置換]]を、[[偽]]に設定します [SRC[>>7]]。
=== [56] [VAR[新しい[[セッション履歴エントリー]]]]を作成します。
[FIG(list members)[
[FIGCAPTION[
[[セッション履歴エントリー]]
]FIGCAPTION]
:[[navigate]] の[[引数]]の新しい[VAR[資源]]:[[応答]]は、
[FIG(list members)[
[FIGCAPTION[
[[応答]]
]FIGCAPTION]
:[CODE(HTTP)@en[[[Content-Type]]]]:[CODE(MIME)@en[[[text/html]]]]
:[[本体]] ([[文字列]]):[[文書]]の[[構文解析器]]の[[構文解析]]したテキスト [SRC[>>7]] (≒ [[reload override buffer]])
]FIG]
:[[文書]]:なし [SRC[>>7]]
:その他:現在の[[文書]]の状態 [SRC[>>7]]
:[[上書きURL]]:[[文書の番地]] [SRC[明記されておらず]]
:[[reload override flag]]:[[真]] [SRC[明記されておらず]]
]FIG]
= [[unload]]:
== [[ストレージミューテックス]]を解放します [SRC[>>7]]。
== [[文書]]の [[''salvageable'']] を[[偽]]に設定します [SRC[>>7]]。
== [[prompt to unload a document]] を実行します [SRC[>>7]]。
== [[refused to allow the document to be unloaded]] が返されたら、
=== [CODE(JS)@en[[[document.write]]]] からの呼び出しなら、
[[refused to allow the document to be unloaded]] を返します。
=== それ以外なら、[[文脈オブジェクト]]を返します [SRC[>>7]]。
=== 停止します [SRC[>>7]]。
== [[unload a document]] を実行します。 [VAR[recycle]] は[[真]]とします。 [SRC[>>7]]
= [[文書]]の新規化:
== [[文書のabort]] を実行します [SRC[>>7]]。
== [[文書節点]]およびそのすべての[[子孫]]に登録された[[イベントリスナー]]を削除します [SRC[>>7]]。
== [[文書]]と関連付けられた[[タスク]]をすべて[[タスクキュー]]から削除します [SRC[>>7]]。
== [[文書]]から[[子供]]をすべて削除します [SRC[>>7]]。
== [[文書]]の [[singleton]] をすべて新しいものに置き換えます (>>47)。
== [[文書の文字符号化]]を [[utf-8]] に変更します [SRC[>>7]]。
== [[文書]]の [[''salvageable'']] を[[真]]に設定します [SRC[>>7]]。
== [[文書の番地]]を[[入口設定群オブジェクト]]の[[有責文書]]の[[文書の番地]]に設定します [SRC[>>7]]。
= [[文書]]が [[ready for post-load tasks]] なら、
== [[文書]]の [[reload override flag]] を設定します [SRC[>>7]]。
== [[文書]]の [[reload override buffer]] を[[空文字列]]に設定します [SRC[>>7]]。
= [[文書]]の [[iframe load in progress]] フラグが設定されていれば、
== [[文書]]の [[mute iframe load]] フラグを設定します [SRC[>>7]]。
= 新しい[[HTML構文解析器]]を作成し、[[文書]]に関連付けます [SRC[>>7]]。
[FIG(list members)[
[FIGCAPTION[
[[HTML構文解析器]]
]FIGCAPTION]
:[[script-created parser]]:[[真]]
:[[confidence]]:[[irrelevant]]
]FIG]
= [[文書]]の[[現在文書準備度]]を [CODE[[[loading]]]] とします [SRC[>>7]]。
= [VAR[型]]が[[平文]]なら、[[テキストファイルのDOM構築]]を開始します [SRC[>>7]]。
= [[文書]]の[[閲覧文脈]]の[[セッション履歴]]の[[エントリー]]のうち、[[現在エントリー]]よりも後のものを
(あれば) 削除します。 ([[現在エントリー]]は含みません。) [SRC[>>7]]
= [[文書]]の[[閲覧文脈]]の[[セッション履歴]]の[[閲覧文脈]]の[[最上位閲覧文脈]]の[[文書族]]の[[文書]]に関連付けられた[[履歴探索タスク源]]の[[タスク]]を (あれば) [[タスクキュー]]から削除します。 [SRC[>>7]]
= [[文書]]の[[閲覧文脈]]の[[セッション履歴]]の[[エントリー]]のうち、[[現在エントリー]]より前で[[文書]]が同じものを (あれば) 削除します。 [SRC[>>7]]
= [VAR[置換]]が[[偽]]なら、
== [[文書]]の[[閲覧文脈]]の[[セッション履歴]]の[[現在エントリー]]の前に[VAR[新しい[[セッション履歴エントリー]]]]を挿入します。 [SRC[>>7]]
= [[文書]]の[[構文解析器]]の[[挿入点]]を[[入力ストリーム]]の末尾に設定します。 [SRC[>>7]]
= [[文脈オブジェクト]]を返します。 [SRC[>>7]]
]FIG]

[45] [[文書]]は、 [DFN[[[ignore-opens-during-unload counter]]]] を持ちます [SRC[>>7]]。
初期値は 0 です [SRC[>>7]]。 [[prompt to unload a document]] や
[[unload a document]] からの [CODE(JS)@en[[[document.open]]]] を抑制するために使われます。

[51] 第1引数の元々の意図は [[MIME型]]の指定だったようですが、実際には [[HTML]]
かどうかの区別の意味しか無くなっているようです。

[52] しかも元の[[文書]]の[[HTML構文解析器]]の動作中には必ず [[HTML]]
と解釈されるようです。 [[IE]] と [[Firefox]] は[[構文解析器]]の停止後には[[平文]]にも対応するようですが、
[[Chrome]] は常に [[HTML]] と解釈します。 [TIME[2015-05-06T13:57:53.00Z]]

;; [53] [[IE]] は [CODE(URI)@en[[[javascript:]]]] の [[navigate]]
なら正しく処理できますが、 [CODE(DOMa)@en[[[onclick]]]] ではなぜか
[CODE(JS)@en[[[document.write]]]] が反映されずに真っ白な状態になります。

;; [54] デモ:
[REFS[
- [50] [CITE[Index of /~wakaba/test/web/dom/document/writing/open]] ([TIME[2015-05-06 22:54:55 +09:00]] 版) <http://suika.suikawiki.org/~wakaba/test/web/dom/document/writing/open/>
]REFS]

* 文書の singleton オブジェクトの置き換え

[47] [[文書]]の [[singleton]] を置き換える際、具体的にどの[[オブジェクト]]が該当するかは、
例示にとどまっていて、完全なリストはありません。

[48] 次のものが該当します。
[FIG(list short)[
- [CODE(DOMi)@en[[[Window]]]] と[[環境設定群オブジェクト]] [SRC[>>7]]
- [CODE(DOMi)@en[[[Location]]]] [SRC[>>7]]
- [CODE(DOMi)@en[[[History]]]] [SRC[>>7]]
- [CODE(DOMi)@en[[[ApplicationCache]]]] [SRC[>>7]]
- [CODE(DOMi)@en[[[Navigator]]]] [SRC[>>7]]
- 各種 [CODE(DOMi)@en[[[BarProp]]]] [SRC[>>7]]
- 両 [CODE(DOMi)@en[[[Storage]]]] [SRC[>>7]]
- 各種 [CODE(DOMi)@en[[[HTMLCollection]]]] [SRC[>>7]]
- [CODE(DOMi)@en[[[Selection]]]] [SRC[>>7]]
- [[Web IDL]] [[プロトタイプ]] [SRC[>>7]]
]FIG]

[49] [[大域オブジェクト]]も置き換わるので、他のフラグの再設定も合わせて、
[CODE(DOMa)@en[[[document]]]] [[オブジェクト]]への参照がすべて別の[[文書]]に書き換わったのとほぼ同じ結果となるようです。しかし引き継がれる状態もあるようです。

[62] 自[[文書]]を [CODE(JS)@en[[[document.open]]]] する[[スクリプト]]の
[CODE(JS)@en[[[document.open]]]] 前に [CODE(DOMa)@en[[[window]]]] の [[expando]]
を設定し、後に参照すると、 [[IE]] と [[Firefox]] では [CODE(JS)@en[[[undefined]]]]
になっていますが (仕様通り)、 [[Chrome]] では前と同じ値が得られます。
[TIME[2015-05-07T00:32:37.800Z]]

[63] [CODE(JS)@en[[[var]]]] で宣言した変数はどのブラウザーでも前後同じ値が得られます。
前に [CODE(JS)@en[[[var]]]] で宣言した変数に後で [CODE(JS)@en[[[window]]]]
からアクセスしてもどのブラウザーでも [CODE(JS)@en[[[undefined]]]] になります。
前に [[expando]] で設定したのと同じ名前の [CODE(JS)@en[[[var]]]] に後でアクセスしても、
どのブラウザーでも [CODE(JS)@en[[[undefined]]]] になります。
[TIME[2015-05-07T00:37:34.100Z]]

[64] [[Chrome]] では [CODE(JS)@en[[[history]]]] や [CODE(JS)@en[[[location]]]]
や [CODE(JS)@en[[[document.forms]]]] にアクセスしても、前と同じ値が得られます。
[[IE]] と [[Firefox]] では違う値になります。 [TIME[2015-05-07T00:42:56.400Z]]

* 履歴移動

[60] [CODE(JS)@en[[[document.open]]]] で作られた[[文書]]の再読込や履歴の移動も、
あたかも通常のページであるかのように扱われることが意図されているようですが、
実装も仕様書も不安定な状態のようです。

[65] [[閲覧文脈]]の[[再読込]]は、 [CODE(JS)@en[[[document.open]]]] 後の時、
通常の処理ではなく [[overridden reload]] となります。
[DFN[[[overridden reload]]]] は次のようにしなければ[['''なりません''']]。

[FIG(steps)[
= [[navigate]] します。
[FIG(list members)[
:[[navigate]] する[[閲覧文脈]]:[[閲覧文脈]]
:新しい[[資源]]:[[応答]]は、
[FIG(list members)[
[FIGCAPTION[
[[応答]]
]FIGCAPTION]
:[CODE(HTTP)@en[[[Content-Type]]]]:[CODE(MIME)@en[[[text/html]]]]
:[[本体]] ([[文字列]]):[[閲覧文脈]]の[[活性文書]]の [[reload override buffer]] の値 [SRC[>>58]]
]FIG]
:[[始点閲覧文脈]]:[[引数]]として指定されたもの [SRC[>>58]]
:[[reload override flag]]:[[真]] [SRC[>>58]]
:[[上書きURL]]:[[閲覧文脈]]の[[活性文書]]の[[文書の番地]] [SRC[>>58]]
:キャッシュ上書き:[[引数]]として指定されたもの
]FIG]
]FIG]

;; [66] [[HTML Standard]] はキャッシュ上書きフラグに言及していませんが、
本 [[nabigate]] が作成した[[文書]]からの [[fetch]] に影響するかもしれません
(ししないかもしれません)。

;; [67] [CODE(JS)@en[[[location.reload]]]] も参照。

[59] [[文書]]は、 [DFN[[[reload override flag]]]] と
[DFN[[[reload override buffer]]]] を持ちます [SRC[>>58]]。
初期状態では未設定で [SRC[>>58]]、 [CODE(JS)@en[[[document.open]]]] 
などが設定することがあります。

[61] [[IE]] と [[Firefox]] は [[overridden reload]] に対応しているようですが、
[[Chrome]] は対応していないようです。 [TIME[2015-05-06T08:14:43.800Z]]

[55] [[IE]] は[[平文]]を [CODE(JS)@en[[[location.reload]]]] した後も[[平文]]として扱うようです。
[[Firefox]] は[[平文]]でも [CODE(JS)@en[[[location.reload]]]] 後に [[HTML]]
にしてしまうようです。現在の [[HTML Standard]] は [[Firefox]]
の動作です。 [TIME[2015-05-06T14:10:21.200Z]]

[68] [CODE(JS)@en[[[document.open]]]] で作られた[[文書]]から他の[[文書]]に移動したら、
元の[[文書]]は通常通り処理されます。 [CODE(JS)@en[[[document.open]]]]
から再度 [CODE(JS)@en[[[document.open]]]] を再度実行したら、
前の状態は [CODE(JS)@en[[[document.write]]]] で生成されたソースコードで保存されます
(>>56)。

[57] >>56 は [[Firefox]] の動作で、 [[IE]] は[[文書]]の [[reload override flag]]
が[[偽]]なら [[navigate]] の新しい[[資源]]をソースでなく [[URL]] としているようです。
(最初の [CODE(JS)@en[[[document.open]]]] より前の[[セッション履歴エントリー]]に戻った時にネットワークアクセスが発生します。そちらの仕様なら、 [[script-created parser]] でない普通の[[構文解析器]]の時に、[[構文解析]]したテキストを保持し続けずに済みます。)
[TIME[2015-05-06T15:18:32.400Z]]

* 歴史

[5]
[CITE[Latest topics > Chromeウィンドウを最前面にする・最背面にする - outsider reflex]] ([[Piro(SHIMODA Hiroshi)]] 著, [CODE[2007-09-29 12:59:12 +09:00]] 版) <http://piro.sakura.ne.jp/latest/blosxom/mozilla/xul/2007-09-26_zlevel.htm>
([[名無しさん]])

[6]
[[Firefox]] 2、[[Safari]] 3.1.1、[[Opera]] 9.27 
のいずれも、
[CODE(DOMm)@en[[[createDocument]]]] で作成した [CODE(DOMi)@en[[[Document]]]]
は [CODE(DOMi)@en[[[HTMLDocument]]]] ではなく、したがって
[CODE(JS)@en[[[document]].[[open]]()]] は使えないようです。


[9]
[CITE@ja[ブラウザごとのwindowオブジェクトの違いを理解する :CodeZine]] ([TIME[2008-10-25 14:23:50 +09:00]] 版) <http://codezine.jp/article/detail/3065?p=4>

[10] [CITE[Bug 325352 – document.open doesn't clear the document]] ([TIME[2008-11-30 18:28:19 +09:00]] 版) <https://bugzilla.mozilla.org/show_bug.cgi?id=325352>

[11] [CITE[window.openでポップアップブロックされた時の挙動はブラウザによって違う - SEの行き着くところ…]] ([TIME[2009-04-19 17:07:23 +09:00]] 版) <http://d.hatena.ne.jp/AWAWA/20090414/1239691058>

[12]
>>11 <http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#dom-open>,
<http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name>

[CODE(JS)@en[[[null]]]] を返すのが仕様上正しい実装かな。不可視の[[閲覧文脈]]が選ばれているとみなすなら [[Opera]] も正しいといえるかも。

[13] [CITE@en[Web Applications 1.0 r7304     Fix an infinite loop. There's no interop here, really, so I tried to find a compromise between what browsers do and keeping the requirements sane and simple. Tests at: http://www.hixie.ch/tests/adhoc/dom/level0/document/open/unload/ -- See also IRC ranting starting at http://krijnhoetmer.nl/irc-logs/whatwg/20120831#l-67 and ending at http://krijnhoetmer.nl/irc-logs/whatwg/20120901#l-140]]
( ([TIME[2012-09-01 08:46:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7303&to=7304>

[14] [CITE[IRC logs: freenode / #whatwg / 20120831]]
( ([TIME[2012-09-07 20:52:20 +09:00]] 版))
<http://krijnhoetmer.nl/irc-logs/whatwg/20120831>

[15] [CITE[''''''[''''''whatwg'''''']'''''' Details on window.open]]
( ([TIME[2012-12-19 08:53:20 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2012-December/038408.html>

[16] [CITE@en[Web Applications 1.0 r7593 Try to better define how popup blockers work.]]
( ([TIME[2012-12-19 08:48:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7592&to=7593>

[17] [CITE@en[Web Applications 1.0 r7626     Make document.open() do nothing on non-active documents]]
( ([TIME[2012-12-31 14:16:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7625&to=7626>

[18] [CITE@en[Web Applications 1.0 r7729     document.open() legacy hack for compat]]
( ([TIME[2013-03-05 10:07:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7728&to=7729>

[19] [CITE@en[Web Applications 1.0 r8201     Make the parser not execute scripts pending for the document after document.open() has been called on it.]]
( ([TIME[2013-10-02 03:46:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=8200&to=8201>

[20] [CITE@en[Bug 25709 – Take over open() features argument spec http://dev.w3.org/csswg/cssom-view/#the-features-argument-to-the-open()-method]]
( ([TIME[2014-05-17 05:29:27 +09:00]] 版))
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=25709>

[21] [CITE@en-US[Window.open - Web API Interfaces | MDN]]
( ([TIME[2014-03-27 08:00:30 +09:00]] 版))
<https://developer.mozilla.org/en-US/docs/Web/API/Window.open>

[22] [CITE[解決:window.open()を使いつつIEでRefererを渡す方法 - @blog.justoneplanet.info]]
( ([TIME[2014-07-25 00:52:00 +09:00]] 版))
<http://blog.justoneplanet.info/2007/07/18/windowopen%E3%82%92%E4%BD%BF%E3%81%84%E3%81%A4%E3%81%A4ie%E3%81%A7referer%E3%82%92%E6%B8%A1%E3%81%99%E6%96%B9%E6%B3%95/>

[23] [CITE@en[Web Applications 1.0 r8701     Defer to CSSOM View for window.open(..., ..., features, ...)]]
( ([TIME[2014-08-05 03:57:00 +09:00]] 版))
<http://html5.org/r/8701>

[24] [CITE[IRC logs: freenode / #whatwg / 20140820]]
( ([TIME[2014-08-21 02:29:23 +09:00]] 版))
<http://krijnhoetmer.nl/irc-logs/whatwg/20140820#l-856>

[25] [CITE@en[Web Applications 1.0 r8777 Recast window.open() in terms of an algorithm.]]
( ([TIME[2014-09-17 06:23:00 +09:00]] 版))
<https://html5.org/r/8777>

[26] [CITE@en[Web Applications 1.0 r8778 Simplify window.open even further]]
( ([TIME[2014-09-17 06:26:00 +09:00]] 版))
<https://html5.org/r/8778>

[27] [CITE@en[Web Applications 1.0 r8779     Fix window.open('') to be more like deployed browsers rather than defaulting to 'about:blank'.]]
( ([TIME[2014-09-17 06:36:00 +09:00]] 版))
<https://html5.org/r/8779>

[28] [CITE@en[Web Applications 1.0 r8795     Match browsers better]]
( ([TIME[2014-09-20 06:21:00 +09:00]] 版))
<https://html5.org/r/8795>

[29] [CITE@en[Web Applications 1.0 r8816     Make window.open() match browsers better]]
( ([TIME[2014-09-25 07:21:00 +09:00]] 版))
<https://html5.org/r/8816>

[30] [CITE@en[RE: Figuring out the behavior of WindowProxy in the face of  non-configurable properties]]
( ([[Travis Leithead]] 著, [TIME[2015-01-15 10:49:45 +09:00]] 版))
<https://lists.w3.org/Archives/Public/public-script-coord/2015JanMar/0033.html>

[FIG(quote)[
[FIGCAPTION[
[1] [CITE@ja[IE11 の環境で DPI が既定値から変更されていると HTML アプリケーション (.hta) が縮小表示される]]
([TIME[2015-02-16 12:47:44 +09:00]] 版)
<http://support.microsoft.com/kb/2923604/ja>
]FIGCAPTION]

> Internet Explorer 11 の環境で、DPI 値 を既定の 100% から変更していると、HTML アプリケーション (.hta) が縮小表示される場合があります。
> HTML アプリケーションが frame 構造で、frame 内のコンテンツより window.open を使用して同一 frame 内にコンテンツを表示する場合、縮小表示される現象が発生します。 

]FIG]

[3] [[Gecko]]、[[Opera]] は [CODE(JS)@en[[[document.open]]]] [[メソッド]]で開かれた[[文書]]の
[[charset]] を [[UTF-8]]、 [[WinIE]] は [[UTF-16]] ([CODE(charset)@en[[[unicode]]]])
にしますが、 [[WebKit]] は元(?)の [[charset]] を引き継ぎます。

[2] [CITE[Part2 - browsersec - Browser Security Handbook, part 2 - Browser Security Handbook - Google Project Hosting]]
([TIME[2015-03-31 16:48:24 +09:00]] 版)
<https://code.google.com/p/browsersec/wiki/Part2#Window_appearance_restrictions>

[4] [CITE@en[717339 – Selection's Ranges should be removed on document.open()]]
([TIME[2015-05-05 19:42:43 +09:00]] 版)
<https://bugzilla.mozilla.org/show_bug.cgi?id=717339>

[35] [CITE[Bug 9726 – Spec the features argument]]
( ([TIME[2010-09-29 01:57:54 +09:00]] 版))
<http://www.w3.org/Bugs/Public/show_bug.cgi?id=9726>

[36] [CITE[Inline Images on Web Pages]]
( ([TIME[2005-10-31 14:52:43 +09:00]] 版))
<http://elf.org/essay/inline-image.html>

[37] [CITE[''''''[''''''whatwg'''''']'''''' location.reload() on document.open()ed documents]]
( ([TIME[2010-12-08 08:41:11 +09:00]] 版))
<http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2010-December/029360.html>

[38] [CITE@en[Web Applications 1.0 r8058     Try to match reality a bit better for popup blockers.]]
( ([TIME[2013-07-16 05:45:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=8057&to=8058>

[39] [CITE[''''''[''''''whatwg'''''']'''''' Details on window.open]]
( ([TIME[2013-07-16 07:02:49 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-July/040083.html>