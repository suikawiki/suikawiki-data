[1] 
[[e-Stat]]
の
[[API]]
は独自の[[日時形式]]を定めています。

* 仕様書

[REFS[
- [2] [CITE[API-specVer1.0.pdf]], [TIME[2018-05-17T07:52:34.000Z]], [TIME[2020-11-28T06:18:16.910Z]] <https://www.e-stat.go.jp/api/sites/default/files/uploads/2014/12/API-specVer1.0.pdf#page=4>
- [7] [TIME[2020-03-23T05:26:14.000Z]], [TIME[2020-11-28T06:28:48.235Z]] <http://api.e-stat.go.jp/rest/1.0/schema/GetMetaInfo.xsd>
- [8] [CITE[API-specVer2.0.pdf]], [TIME[2018-05-17T07:53:42.000Z]], [TIME[2020-11-28T06:30:31.170Z]] <https://www.e-stat.go.jp/api/sites/default/files/uploads/2015/04/API-specVer2.0.pdf#page=6>
- [11] [TIME[2020-03-23T05:26:20.000Z]], [TIME[2020-11-28T06:35:26.009Z]] <http://api.e-stat.go.jp/rest/2.0/schema/GetMetaInfo.xsd>
- [12] [CITE[API-specVer2.1.pdf]], [TIME[2018-05-17T07:55:30.000Z]], [TIME[2020-11-28T06:36:39.234Z]] <https://www.e-stat.go.jp/api/sites/default/files/uploads/2016/07/API-specVer2.1.pdf#page=6>
- [13] [TIME[2020-03-23T05:26:24.000Z]], [TIME[2020-11-28T06:39:47.366Z]] <http://api.e-stat.go.jp/rest/2.1/schema/GetMetaInfo.xsd>
- [14] [CITE[API-specVer3.0.pdf]], [TIME[2019-07-25T00:19:10.000Z]], [TIME[2020-11-28T06:48:40.209Z]] <https://www.e-stat.go.jp/api/sites/default/files/uploads/2019/07/API-specVer3.0.pdf#page=6>
- [15] [TIME[2019-02-26T09:11:02.000Z]], [TIME[2020-11-28T06:59:57.805Z]] <http://api.e-stat.go.jp/rest/3.0/schema/GetStatsDatas.xsd>


]REFS]

* 年

[3] 
「単年検索」
が構文
[VAR[yyyy]]
で表されます。
[SRC[>>2, >>8, >>12, >>14]]

[18] 説明がまったくありませんが、 [VAR[yyyy]] は[[西暦年]]と思われます。

* 年月

[4] 
「単月検索」
が構文
[VAR[yyyy]][VAR[mm]]
で表されます。
[SRC[>>2, >>8, >>12, >>14]]

[19] 説明がまったくありませんが、
[VAR[mm]]
は[[2桁月番号]]と思われます。

* 年月日

[9] 
「単日検索」
が構文
[VAR[yyyy]][VAR[mm]][VAR[dd]]
で表されます。
[SRC[>>8, >>12, >>14]]

[20] 説明がまったくありませんが、
[VAR[dd]]
は[[2桁日番号]]と思われます。


[16] 
[[XML]]
や
[[JSON]]
の値では
[CODE[xs:date]]
が使われています。
[SRC[>>15]]

[17] [[XML Schema]] では [CODE[xs:string]]
になっていても、
実際には [CODE[xs:date]]
らしい値が設定されていることがあります。

* 日時

[6] [[XML]] や
[[JSON]]
の値では
[CODE[xs:dateTime]]
が使われています。 [SRC[>>7, >>11, >>13]]

* 範囲


[5] 
「範囲検索」
が構文
[VAR[yyyy]][VAR[mm]]-[VAR[yyyy]][VAR[mm]]
[SRC[>>2, >>8, >>12, >>14]]、
構文
[VAR[yyyy]][VAR[mm]][VAR[dd]]-[VAR[yyyy]][VAR[mm]][VAR[dd]]
[SRC[>>8, >>12, >>14]]
で表されます。

* 時間軸

[23] [[e-Stat]] が扱うデータの多くは、
時間変化に対する何々の量、
という構造を持っていて、
その時間軸の情報が取得できます。

[PRE(XML code)[
<CLASS_OBJ id="time" name="時間軸(年次)">
  <CLASS code="2012000000" name="2012年" level="1"/>
</CLASS_OBJ>
]PRE]

... のような構造が例示されています。この例でいう [[XML]]
の[[要素]]と[[属性]]については 
[[API]]
仕様で説明されていますが、
その符号の解釈までは説明されていません。

[26] 
[DFN[e-statで用いられる時間軸コード体系]]は、
次のような意味を持っています。
[SRC[>>24]]

- [27] [DFN[時間軸(年)コード]]: [VAR[年]][VAR[種別]][VAR[上/下期]][VAR[期]]
-- [VAR[年]]は4桁の[[西暦年]]
-- [VAR[種別]]は [N[0]]
-- [VAR[上/下期]]は [N[0]]: 指定なし、[N[1]]: [[1~6月期]]、[N[2]]: [[7~12月期]]
-- [VAR[期]]は、
--- [CODE[0000]]: [[年]]
--- [CODE[0103]]: [[1~3月期]]
--- [CODE[0406]]: [[4~6月期]]
--- [CODE[0709]]: [[7~9月期]]
--- [CODE[1012]]: [[10~12月期]]
--- [CODE[0101]]: [[1月]]
--- [CODE[0202]]: [[2月]]
--- [CODE[0303]]: [[3月]]
--- [CODE[0404]]: [[4月]]
--- [CODE[0505]]: [[5月]]
--- [CODE[0606]]: [[6月]]
--- [CODE[0707]]: [[7月]]
--- [CODE[0808]]: [[8月]]
--- [CODE[0909]]: [[9月]]
--- [CODE[1010]]: [[10月]]
--- [CODE[1111]]: [[11月]]
--- [CODE[1212]]: [[12月]]
- [28] [DFN[時間軸(年度)コード]]: [VAR[年]][VAR[種別]][VAR[上/下期]][VAR[期]]
-- [VAR[年]]は4桁の[[西暦年]]
-- [VAR[種別]]は [N[1]]
-- [VAR[上/下期]]は [N[0]]: 指定なし、[N[1]]: [[4~9月期]]、[N[2]]: [[10~3月期]]
-- [VAR[期]]は、
--- [CODE[0000]]: [[年度]]
--- [CODE[0103]]: [[1~3月期]]
--- [CODE[0406]]: [[4~6月期]]
--- [CODE[0709]]: [[7~9月期]]
--- [CODE[1012]]: [[10~12月期]]
--- [CODE[0101]]: [[1月]]
--- [CODE[0202]]: [[2月]]
--- [CODE[0303]]: [[3月]]
--- [CODE[0404]]: [[4月]]
--- [CODE[0505]]: [[5月]]
--- [CODE[0606]]: [[6月]]
--- [CODE[0707]]: [[7月]]
--- [CODE[0808]]: [[8月]]
--- [CODE[0909]]: [[9月]]
--- [CODE[1010]]: [[10月]]
--- [CODE[1111]]: [[11月]]
--- [CODE[1212]]: [[12月]]

;; [29] 年度コードの[VAR[期]]の1月-3月は年コードと見かけは似ていますが、
翌[[暦年]]を指すはずです。


[30] 
令和2年発表の[[日本政府]]の
[CITE[統計表における機械判読可能なデータ作成に関する表記方法案]]
は、
この符号体系で
「付省間の共通化を図る」
としています。
[[和暦]]のみの記載から、
時間軸コードと[[和暦]]の併記、
[[西暦]]のみ、
[[西暦]]と[[和暦]]の併記に修正するべきだとしています。
その理由を、
「ソフトウェア等のプログラムは、年の値の大小により認識することが多いため、和暦表示のみでは、元号が切り替わる際に手作業で西暦等に変換する必要がある。」
ためとしています。
[SRC[>>24]]

[31] 
この文書は [[Excel]] のような人が書き、
人も機械も読むことがあるような類のデータを対象しているようなので、
人間可読と機械可読の中間的なこのような規定となっているのでしょう。

[32] 
[VAR[種別]]や[VAR[上/下期]]は、人が読み書きするには少し扱いにくそうです。
それが時間軸コードのみの修正案や、
時間軸コードがない修正案が示されている理由でしょうか。

[33] 
この符号を採用する理由に年の大小比較が挙げられていますが、
[[年度]]の場合1月から3月が数値の大小と期間の大小が逆転してしまい、
注意が必要そうです。


* 歴史

[REFS[
- [24] 
[CITE[[[統計表における機械判読可能なデータ作成に関する表記方法案]]]]
]REFS]

* メモ

[10] 
[[識別子]]の自動採番で
「[L[「政府統計コード(8桁)-年月日時分秒(14桁)-枝番(1]]
[L[桁)」の形式]]」
が使われます [SRC[>>8, >>12, >>14]]。


[21] 
[CODE[CYCLE]]
や
[CODE[FREQUENCY_OF_UPDATE]]
には情報の更新の頻度が表されるようですが、
構文は定まっていません。
「-」
「年次」
のような例が示されています。
[[自然言語]]で記述されているのでしょう。

[22] 
[CODE[SURVEY_DATE]]
は
[CODE[xs:string]]
とされており、
[CODE[<SURVEY_DATE>2008年</SURVEY_DATE>]],
[CODE[<SURVEY_DATE>200810</SURVEY_DATE>]]
のように違った形式の記載例が示されています。





