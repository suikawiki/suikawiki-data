* 仕様書

[REFS[
- [2] [CITE@en-US[Push API]], [TIME[2020-02-04 16:21:34 +09:00]] <https://w3c.github.io/push-api/#security-and-privacy-considerations>
]REFS]

* 処理

[3] [[利用者エージェント]]は、
[[利用者]]が
[[express permission]]
することなく [[Push API]]
の機能を [[Webアプリケーション]]に提供しては[MUST[なりません]]。
[CODE[subscribe]]
[[メソッド]]では、
[[利用者インターフェイス]]で [[permission]]
に同意を得るか、
以前の同意が有効でなければ[MUST[なりません]]。
同意済みかの判定には
[CODE[PushSubscriptionOptions]]
を考慮[MAY[できます]]。
[SRC[>>2]]

[4] 
現在の[[閲覧セッション]]を超えて有効な [[permission]]
は、[[失効]]可能でなければ[MUST[なりません]]。
[SRC[>>2]]
[SEE[ [[プッシュ購読]] ]]

* 実装

[1] 
[[Chrome]] でなぜかこのメソッドの [[Promise]]
が解決されなくなることがあります。
なぜか全然応答しなくなり、固まっているようにみえます。
[[通知]]の許可を変更したり、リセットしたりしても解決しません。
[[Chrome]]
を再起動するとあっさり治ります。
[TIME[2019-09-30T06:54:07.400Z]]

* メモ