[10] [DFN[[CODE(HTTP)@en[[[Meter:]]]]]] [[ヘッダー]]は、
[[起源鯖]]から[[串]]に対して[[応答]]回数の計測に関する指示を行ったり、
[[串]]から[[起源鯖]]に対して計測結果を報告したりするものです。

* 仕様書

[REFS[
- [2] [CITE@en[RFC 2227 - Simple Hit-Metering and Usage-Limiting for HTTP]]
( ([TIME[2011-12-18 04:36:26 +09:00]] 版))
<http://tools.ietf.org/html/rfc2227>
]REFS]

* 意味

[3] [CODE(HTTP)@en[[[Meter:]]]] は、[[キャッシュ]]によって[[利用者エージェント]]からのアクセスの情報が[[鯖]]に伝わらないことを防ぐため[[キャッシュ]]を無効化する [[cache-busting]]
がしばしば行われている [SRC[>>2]] として、その必要性を低めるための代替となる仕組みとして提案されました。

;; ただしすべての [[cache-busting]] を置き換えることを目的とするものではない [SRC[>>2]]
とされています。

[6] [CODE(HTTP)@en[[[Meter:]]]] [[ヘッダー]]は、
[[起源鯖]]が[[串]]を通じて配信された回数を十分正確に取得する「hit-metering」や、
[[串]]が[[再検証]]なしに[[再利用]]できる回数を指定する「usage-limiting」
を実現します [SRC[>>2]]。

* 計測部分木

[8] [[起源鯖]]を[[根]]とし、[[起源鯖]]からの[[応答]]の[[転送]]経路上にあって
[CODE(HTTP)@en[[[Meter:]]]] [[ヘッダー]]による計測に対応した[[串]]によって構成される[[木]]のことを[DFN[[RUBYB[計測部分木]@en[metering subtree]]]]
[SRC[>>2]] といいます。

[9] [[起源鯖]]と[[利用者エージェント]]の間には、 [CODE(HTTP)@en[[[Meter:]]]]
[[ヘッダー]]に対応しない[[串]]や、対応しているものの[[上流]]に対応しない[[串]]が存在しているため対応できない[[串]]があるかもしれません。
[[計測部分木]]は、そのような[[串]]も含めた配送経路全体で構成される[[木]]の[[部分木]]となります。

* 処理モデル

[4] [CODE(HTTP)@en[[[Meter:]]]] は[[串]]に対する指示です [SRC[>>2]]。
[[利用者エージェント]]には適用されません。

[5] [[串]]は [CODE(HTTP)@en[[[Meter:]]]] を実装しても構いませんが、
実装しなくても構いません [SRC[>>2]]。
[CODE(HTTP)@en[[[Meter:]]]] [[ヘッダー]]を[[転送]]する[[串]]は、
[[RFC 2227]] に従わなければ[['''なりません''']] [SRC[>>2]]。

;; [7] [[起源鯖]]は [CODE(HTTP)@en[[[Connection:]] [[Meter]]]] 
と指定しなければなりませんから、未対応の[[串]]は [CODE(HTTP)@en[[[Connection:]]]]
[[ヘッダー]]の規定に従い [CODE(HTTP)@en[[[Meter:]]]]
[[ヘッダー]]を[[転送]]時に削除します。

* 歴史

[1] [CITE@en[draft-ietf-http-hit-metering-00 - Simple Hit-Metering and Usage-Limiting for HTTP]]
( ([TIME[2012-01-20 20:05:43 +09:00]] 版))
<http://tools.ietf.org/html/draft-ietf-http-hit-metering-00>

