[6] [DFN[[RUBYB[[[入口設定群オブジェクト]]]@en[entry settings object]]]]は、
[[スクリプト]]実行中に[[基底URL]]の[[解決]]などに用いられる[[スクリプト設定群オブジェクト]]です。

* 仕様書

[REFS[
- [1] '''[CITE@en-US-x-hixie[HTML Standard]] ([TIME[2014-04-03 03:44:44 +09:00]] 版) <http://www.whatwg.org/specs/web-apps/current-work/#entry-settings-object>'''
- [4] [CITE@en-US-x-hixie[HTML Standard]] ([TIME[2014-04-03 03:44:44 +09:00]] 版) <http://www.whatwg.org/specs/web-apps/current-work/#candidate-entry-settings-object>
]REFS]

* 定義

[16] [DFN[[RUBYB[[[入口設定群オブジェクト]]]@en[entry settings object]]]]は、
[[JavaScript実行文脈スタック]]中の[[JavaScript実行文脈]]の[F[[[設定群オブジェクト]]]]で[F[[[候補入口設定群オブジェクト]]]]フラグが立っているもののうち、
スタック上で最上に位置するものです [SRC[>>1]]。

[HISTORY[
[2] [DFN[[RUBYB[[[入口設定群オブジェクト]]]@en[entry settings object]]]]は、
[[スクリプト設定群オブジェクトのスタック]]で一番最近追加された[[候補入口設定群オブジェクト]]たる[[スクリプト設定群オブジェクト]]です。
そのような[[スクリプト設定群オブジェクト]]がなければ、[[入口設定群オブジェクト]]はありません。 [SRC[>>1]]
]HISTORY]

* 候補

[5] [[JavaScript実行文脈スタック]]中にある[[JavaScript実行文脈]]の[F[[[設定群オブジェクト]]]]として設定された[[スクリプト設定群オブジェクト]]には、
[DFN[[RUBYB[[[候補入口設定群オブジェクト]]]@en[candidate entry settings object]]]] [SRC[>>4]] というフラグがあります。

;; [17] 同じ[[スクリプト設定群オブジェクト]]が複数回[[JavaScript実行文脈スタック]]上に現れることがありますから、
このフラグは[[環境設定群オブジェクト]]自体のフラグというよりは、
[[スタック]]上のエントリーに属するフラグです。

[7] このフラグは[[コールバックを走らせる準備]]の手順内で[[実行文脈]]が [[push]]
される時に付与されます。 [[JavaScript]] の [CODE(JS)@en[[[SourceElements]]]] の評価によって [[push]]
される際には付与されません。おおよそ、[[利用者エージェント]]から[[スクリプト]]を呼び出す際の[[スクリプト設定群オブジェクト]]が候補になるといえます。

* 関連

[3] [[入口設定群オブジェクト]]は、[[関連する類似起源閲覧文脈の単位]]内の[[スクリプト]]の[[基底URL]]の[[解決]]その他に用いられます。

[8] [[現職設定群オブジェクト]]は、候補かどうかを問わず一番最近追加された[[スクリプト設定群オブジェクト]]です。

[9] [[現職設定群オブジェクト]]と[[入口設定群オブジェクト]]の使い分けは明確には説明されていないのですが、
- [[入口設定群オブジェクト]]を使うのは
-- [10] [[API]] 内での[[相対URL]]の[[解決]]
-- [11] [[API]] 内で扱う対象が[[同じ起源]]かどうかの判定
- [[現職設定群オブジェクト]]を使うのは
-- [12] [[閲覧文脈]]や[[ワーカー]]が[[同じ起源]]かどうかの判定

... となっているようです。

[13] [[入口設定群オブジェクト]]は[[ハイパーリンク]]をたどる処理の定義でも参照されていて、
[[入口設定群オブジェクト]]があれば[[スクリプト]]からの呼び出しということで[[例外]]を投げ、
そうでなければ何もしないという判断に使われています。

* 歴史

[14] [CITE[Issue 360891 - chromium - Javascript run via V8 Microtask callback has no "entered" DOM Window - An open-source project to help move the web forward. - Google Project Hosting]]
( ([TIME[2014-04-10 04:51:48 +09:00]] 版))
<https://code.google.com/p/chromium/issues/detail?id=360891>

[15] [CITE@en[Rewrite script execution on top of ES · whatwg/html@4891d18]]
([TIME[2015-12-22 23:16:26 +09:00]] 版)
<https://github.com/whatwg/html/commit/4891d18aaf2df1d40aa61f467a5a10cfc19dd85d>