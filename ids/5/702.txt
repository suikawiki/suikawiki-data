
[3]

>
:[DFN[[RUBYB[誤り] @en[error]]]]:
[定義: この仕様書の規則への違反。結果は未定義とする。特に規定のない限り、この仕様書中の[[鍵語]]である[[しなければ'''なりません''']]、[[する'''必要があります''']]、[[しては'''なりません''']]のいずれかで示される規定への違反は[[誤り]]である。[[適合]][[ソフトウェア]]は[[誤り]]を検出・報告して'''構わない'''し、それから[[回復]]しても'''構わない'''。]

;; 出典: <IW:XML1:"#dt-error">

[4] 別途規定のある[[誤り]]:
- [[致命的誤り]]
- [[妥当性制約]]への違反
- [[整形式制約]]への違反
- 非妥当な[CODE(XMLa)@en[xml:space]][[属性値]] >>2

[2]
['''非妥当な[CODE(XMLa)@en[xml:space]]属性値''']
[CODE(XMLa)@en[[[xml]]:[[space]]]][[属性値]]が[CODE(XML)@en[[[default]]]]・[CODE(XML)@en[[[preserve]]]]以外であれば、[[誤り]]です。

'''処理器の動作''':
- [[誤り]]を報告して'''構いません'''。
- [[属性指定]]を無視して'''構いません'''。
- 誤った値を[[応用]]に報告して'''構いません'''。

'''応用の動作''':
- 無視して構いません。
- 拒絶して構いません。

;; 
<http://www.w3.org/XML/xml-V10-2e-errata#E57>,
<IW:XML1:"#sec-white-space"> (第3版で追加)

[10]
['''非決定性内容モデル''']
[[互換性のため]]、ある[[要素]]が1つ以上の[[要素型]]の指定と[[一致]]し得るような[[内容モデル]]は[[誤り]]とします。

;; 
[33]
第2版正誤表で明確化されましたが、[[誤り]]なのは[[文書実現値]]では''なく''、
[[DTD]]の[[内容モデル]]の側です。

;; <IW:XML1:"#sec-element-content">, <IW:XML1:"#determinism">,
<http://www.w3.org/XML/xml-V10-2e-errata#E34>

[5]
['''属性値指定中の未読実体参照''']
[[属性値指定]]中の[[実体参照]]が[[宣言]]を読んでいない[[実体]]を[[参照]]している場合、[[誤り]]とします。

;; 
<IW:XML1:"#AVNormalize">

;; 
[6]
>>3 で[Q[[[誤り]]]]とは[[XML]]の規則への違反であると規定していますが、
>>5 は違反でないにもかかわらず[Q[[[誤り]]]]とされています。
(もし違反であるとすると、[[外部引数実体]]の中に[[一般実体宣言]]を書く意味がなくなってしまいます。)

[7]
['''システム識別子の素片識別子''']
[[システム識別子]]に[[素片識別子]]が含まれるのは[[誤り]]です。

;; <IW:XML1:"#dt-sysid">

;; 
[19] [[URI]] の処理関係は[[..//URI]]も参照。

[29]
['''実体値中の非解析対象実体参照''']
[[実体値]]中に[[非解析対象実体]]への[[参照]]が含まれるのは[[誤り]]とします。

;; 
<IW:XML1:"#error">,
<http://www.w3.org/XML/xml-V10-2e-errata#E55>

;; 
第2版正誤表で改められるまでは、禁止とされていました。
[[誤り]]なので、報告してもしなくても構いません。

;; 
[[実体値]]中の[[一般実体参照]]は、本来[[宣言]]された時点では評価されず、
[[参照]]された時にはじめて評価され、[[参照]]されているのが[[非解析対象実体]]だったとわかります。

[34] ['''論理構造と物理構造が適切に入れ子になっていること''']
論理構造と物理構造は適切に入れ子になっていなければ'''なりません'''。

;; <IW:XML1:"#sec-documents">,
<IW:XML1:"#wf-entities">

;; おおむね[[生成規則]]との[[一致]] ([[整形式制約]])
と[[妥当性制約]]でカバーされています。

[35] ['''名前'''] ([[XML 1.1]])
[[名前]]の最初の文字は[[名前開始文字]]、それ以降の文字は[[名前文字]]でなければ'''なりません'''。

;; <IW:XML1:"#sec-common-syn">

;; [[生成規則]]と[[一致]]しなければなりませんから、[[整形式制約]]です。

[36] ['''[CODE(char)[&]]と[CODE(char)[<]]と[CODE(char)[>]]''']
[CODE(char)[[[&]]]]と[CODE(char)[<]]]]は[[マーク]]として以外生で現れては'''なりません'''。[[逃避]]しなければ'''なりません'''。
[CODE(char)[[[>]]]]は[[互換性のため]]、[CODE(SGML)@en[[[MSE]]]]のように現れるときは[[逃避]]しなければなりません。

;; <IW:XML1:"#syntax">

;; [[生成規則]]および[[整形式制約]]

[37] ['''注釈内の[CODE[--]]''']
[[注釈]]内に[CODE[--]]が含まれては'''なりません'''。

;; <IW:XML1:"#sec-comments">

;; [[生成規則]]

[38] ['''XML宣言'''] ([[XML 1.1]])
[[XML 1.1]][[文書]]は[[XML宣言]]で始まらなければ'''なりません'''。

;; <IW:XML1:"#dt-xmldecl">

;; [[生成規則]]

[39] ['''文書型宣言''']
[[文書型宣言]]は[[文書要素]]の前になければ'''なりません'''。

;; <IW:XML1:"#sec-prolog-dtd">

;; [[生成規則]]

[40] ['''マーク宣言間の引数実体参照''']
[[マーク宣言]]外の[[引数実体参照]]が[[参照]]する[[引数実体]]は[[DTD宣言]]と[[空白]]と[[引数実体参照]]で構成されなければ'''なりません'''。ただし、その一部は[[条件区間]]により無視できます。

;; <IW:XML1:"#sec-prolog-dtd">

;; [[整形式制約]]にほぼ同じものがあります。

;; [CODE(XML)@en[[[IGNORE]]]][[区間]]内は[[DTD宣言]]他でなければならないという制約とも読めます。

[41] ['''[CODE(XMLa)@en[xml:space]]が宣言されていること''']
[[妥当]]な[[文書]]では[CODE(XMLa)@en[[[xml]]:[[space]]]][[属性]]も通常通り[[属性定義]]がなければ'''なりません'''。

;; <IW:XML1:"#sec-white-space">

[42] ['''[CODE(XMLa)@en[xml:space]]属性定義''']
[CODE(XMLa)@en[[[xml]]:[[space]]]]を[[宣言]]する場合は、
[[列挙型]]で、可能な値は[CODE(XML)@en[[[default]]]]と[CODE(XML)@en[[[preserve]]]]の一方または両方でなければ'''なりません'''。

;; <IW:XML1:"#sec-white-space">

[43] ['''[CODE(XMLa)@en[xml:lang]]が宣言されていること''']
[[妥当]]な[[文書]]では[CODE(XMLa)@en[[[xml]]:[[lang]]]][[属性]]も通常通り[[属性定義]]がなければ'''なりません'''。

;; <IW:XML1:"#sec-lang-tag">

[44] ['''終了タグ''']
すべての[[要素]]の終わりは[[終了タグ]]で[[マーク]]しなければ'''なりません'''。

;; <IW:XML1:"#dt-etag">

;; [[生成規則]]

[45] ['''要素内容''']
[[要素内容]]では[[子要素]]と[[任意選択]]で[[空白]]だけを含まなければ'''なりません'''。
[[内容モデル]]の項目はその順で[[要素]]内に現れなければ'''なりません'''。
[[出現指示子]]がなければ丁度1回出現しなければ'''なりません'''。

<IW:XML1:"#dt-elemcontent">

;; [[妥当性制約]]

[46] ['''属性指定''']
[[属性指定]]が[[開始タグ]]・[[空要素タグ]]外に現れては'''なりません'''。

;; <IW:XML1:"#attdecls">

;; [[生成規則]]

[49] ['''列挙属性''']
[[列挙属性]]は[[宣言]]された値のうちの1つを取らなければ'''なりません'''。

;; <IW:XML1:"#dt-enumerated">

;; [[妥当性制約]]

[50] ['''必須属性''']
[CODE(XML)@en[#[[REQUIRED]]]]と[[宣言]]された[[属性]]は[[指定]]されなければ'''なりません'''。

;; <IW:XML1:"#IDAR4CU">

;; [[妥当性制約]]

[51] ['''固定属性''']
[CODE(XML)@en[#[[FIXED]]]]と[[宣言]]された[[属性]]の[[値]]は[[既定値]]と同じでなければ'''なりません'''。

;; <IW:XML1:"#IDAR4CU">

;; [[妥当性制約]]

[52] ['''テキスト宣言は外部解析対象実体の先頭''']
[[テキスト宣言]]は[[参照]]ではなく直接記述しなければ'''なりません'''。
[[外部解析対象実体]]の最初以外にあっては'''なりません'''。

;; <IW:XML1:"#IDAUPEU">

;; [[生成規則]]で一部をカバー

[53] ['''UTF-16 [CODE(charname)@en[BOM]]''']
[[UTF-16]]の[[実体]]は[CODE(charname)@en[[[BOM]]]]で始まらなければ'''なりません'''。

;; <IW:XML1:"#charencoding">

[54] ['''符号化宣言''']
外部[[文字符号化]]情報がない、[[UTF-8]]・[[UTF-16]]''以外''で[[符号化]]された[[実体]]には[[テキスト宣言]]がなければ'''なりません'''。

;; <IW:XML1:"#charencoding">

;; [[致命的誤り]]でもある

[55] ['''参照と実体が適切に入れ子になっていること''']
[[参照]]は[[表記実体値]]に完全に含まれていなければ'''なりません'''。

;; <IW:XML1:"#intern-replacement">

;; [[生成規則]]

[56] ['''定義済実体宣言''']
[[定義済実体]]を[[宣言]]するときは[[内部実体]]で、指定された[[置換文]]でなければ'''なりません'''。

;; <IW:XML1:"#sec-predefined-ent">


[57]
[CITE@en[RE: Bare surrogates in XML - must halt and catch fire?]] ([[Grosso, Paul]] 著, [TIME[2007-03-24 07:53:56 +09:00]] 版) <http://lists.w3.org/Archives/Public/public-xml-core-wg/2007Mar/0017.html>

おもしろかった。
([[名無しさん]] [WEAK[2007-03-26 12:09:07 +00:00]])

