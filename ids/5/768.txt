[8] [DFN[[CODE(URI)[%u[VAR[HHHH]]]]]] は、 [[JavaScript]] の[[関数]]
[CODE(JS)@en[[[escape()]]]], [CODE(JS)@en[[[unescape()]]]] で用いられている[[符号化]]です。
[[URL]] の[[パーセント符号化]]と半ば意図的に混同され、現在でもたまに用いられています。

[9] 仕様上は [[URL]] で [CODE(URI)[%u]] [[符号化]]を用いることは認められていません。

* 歴史

** JavaScript

[7] [CODE(URI)[[[%u]]]] による[[符号化]]は [[ECMA-262]] の第1版で 
[CODE(JS)@en[[[escape()]]]], [CODE(JS)@en[[[unescape()]]]] 両[[関数]]の挙動として規定されました。
この挙動は紆余曲折を経て現在では各 [[JavaScript]] [[エンジン]]で実装されています。
詳しくは [CODE(JS)@en[[[escape()]]]] の項をご覧ください。

** IRI

- [5] [CITE@en[RFC 3987 - Internationalized Resource Identifiers (IRIs)]] ([TIME[2011-05-08 01:17:48 +09:00]] 版) <http://tools.ietf.org/html/rfc3987#appendix-A.3>

>Instead of using the existing percent-encoding convention of URIs,
which is based on octets, the idea was to create a new encoding
convention; for example, to use "%u" to introduce UCS code points.
Using the existing octet-based percent-encoding mechanism does not
need an upgrade of the URI syntax and does not need corresponding
server upgrades.

[6] [[RFC 3987]] は >>5 のように述べており、 [CODE(URI)[[[%u]]]] 
を使う方法を導入せずとも既存の[[パーセント符号化]]だけで同じことが実現できて互換性も高いとしています。

* 実装

[1]
[[CGI.pm]] は [CODE(URI)@en[%[VAR[HHHH]]]]
の[[復号]]を実装しています (非 [[EBCDIC]] 環境のみ)。
ただし[[サロゲート・ペア]]はそのまま2[[文字]]になってしまいます。

[4] [CITE[URI::Escape::JavaScript - search.cpan.org]]
<http://search.cpan.org/~taniguchi/URI-Escape-JavaScript-0.04/lib/URI/Escape/JavaScript.pm>

>URI::Escape doesn't work for escaping and unescaping JavaScript like Unicode URI-escape ("%uXXXX"). But you can use this module to do those.

[2]
[CITE[404 Blog Not Found:CPAN - URI::Escape::XS Released!]] ([CODE[2007-04-28 04:04:46 +09:00]] 版) <http://blog.livedoor.jp/dankogai/archives/50818918.html>
([[名無しさん]] [WEAK[2007-04-28 02:11:34 +00:00]])

>もう一つは、%uHHHHの対応。一応にぽたん作のURI::Escape::JavaScriptというものがあるのですが、コードを見るとSurrogate Pairに未対応。

>
In spite of that, there are a significant number of URIs with %uHHHH
escapes. Therefore this module supports decoding only.

* メモ

[3]
[CITE@en[Percent-encoding - Wikipedia, the free encyclopedia]] ([TIME[2007-04-18 03:08:17 +09:00]] 版) <http://en.wikipedia.org/wiki/Percent-encoding#Non-standard_implementations>
([[名無しさん]] [WEAK[2007-04-28 02:13:40 +00:00]])

>There exists a non-standard encoding for Unicode characters: %uxxxx, where xxxx is a Unicode value represented as four hexadecimal digits. This behavior is not specified by any RFC and has been rejected by the W3C. The third edition of ECMA-262 still includes an escape(string) function that uses this syntax, but also an encodeURI(uri) function that converts to UTF-8 and percent-encodes each octet.

[10] [CODE(JS)@en[[[escape()]]]] を誤って使っているらしく [CODE[[[%u]]]]
が使われることが今でも大きなサイトでもあったりします。 [TIME[2014-09-06T22:59:46.600Z]]

[FIG(quote)[
[FIGCAPTION[
[11] [CITE@ja[民泊のエアビーアンドビー、苦情サイト新設 - WSJ]]
( ([[NATHAN OLIVAREZ-GILES]]著, [TIME[2016-06-03 19:05:57 +09:00]]))
<http://jp.wsj.com/articles/SB10513819889225894892604582103810164964978>
]FIGCAPTION]

> 
> <meta name="apple-itunes-app" content="app-id=364387007,app-argument=wsj://launch?articleid=SB10513819889225894892604582103810164964978&headline=%u6C11%u6CCA%u306E%u30A8%u30A2%u30D3%u30FC%u30A2%u30F3%u30C9%u30D3%u30FC%u3001%u82E6%u60C5%u30B5%u30A4%u30C8%u65B0%u8A2D&weburl=http://jp.wsj.com/articles/SB10513819889225894892604582103810164964978" />
> <meta name="al:ios:url" content="wsj://launch?articleid=SB10513819889225894892604582103810164964978&headline=%u6C11%u6CCA%u306E%u30A8%u30A2%u30D3%u30FC%u30A2%u30F3%u30C9%u30D3%u30FC%u3001%u82E6%u60C5%u30B5%u30A4%u30C8%u65B0%u8A2D&weburl=http://jp.wsj.com/articles/SB10513819889225894892604582103810164964978" />

]FIG]
