* 仕様書

[REFS[
- [7] [CITE@en[RFC 7240 - Prefer Header for HTTP]]
( ([TIME[2014-06-07 01:59:37 +09:00]] 版))
<http://tools.ietf.org/html/rfc7240>
]REFS]

* 意味

[EG[
[8] [CODE(HTTP)@en[[[PUT]]]] により[[資源]]を編集した後に、
変更後の完全な[[表現]]を[[応答]]として得たいこともあれば、
操作が成功したことのみの最低限の[[応答]]を得たいこともあります [SRC[>>7]]。
]EG]

[EG[
[9] [[鯖]]は、技術的に[[非妥当]]だったり誤っていたりするものの理解はできる[[要求]]をどう処理するか決めなければならないことがあります。
[[鯖]]は誤りがあっても[[要求]]を処理できるかもしれませんが、
[[アプリケーション]]の要件と[[要求]]の性質によってはそれが好ましかったり、
好ましくなかったりするかもしれません。 [SRC[>>7]]
]EG]

* 歴史

[REFS[
- [1] [CITE[OData Version 4.0 Part 1: Protocol]]
( ([TIME[2013-08-14 16:00:00 +09:00]] 版))
<http://docs.oasis-open.org/odata/odata/v4.0/cs01/part1-protocol/odata-v4.0-cs01-part1-protocol.html>
- [2] [CITE@en[draft-snell-http-prefer-18 - Prefer Header for HTTP]]
( ([TIME[2013-10-27 07:56:15 +09:00]] 版))
<http://tools.ietf.org/html/draft-snell-http-prefer-18>
- [3] [CITE@en[Linked Data Platform 1.0]]
( ([TIME[2014-03-05 18:42:42 +09:00]] 版))
<http://www.w3.org/TR/2014/WD-ldp-20140311/#h3_prefer-parameters>
- [4] [CITE@en[draft-snell-http-prefer-18 - Prefer Header for HTTP]]
( ([TIME[2014-02-02 11:01:34 +09:00]] 版))
<http://tools.ietf.org/html/draft-snell-http-prefer-18>
- [5] [CITE@en[RFC 7240 - Prefer Header for HTTP]]
( ([TIME[2014-06-07 01:59:37 +09:00]] 版))
<http://tools.ietf.org/html/rfc7240>
- [6] [CITE@en[2.2.5.9 Prefer]]
( ([TIME[2014-07-25 04:45:16 +09:00]] 版))
<http://msdn.microsoft.com/en-us/library/hh537533.aspx>
]REFS]

* 関連

[10] [CODE(HTTP)@en[[[Expect:]]]] [[ヘッダー]]の元々の定義も似たようなものでしたが、
[CODE(HTTP)@en[[[Expect:]]]] の場合すべての[[中間器]]と[[起源鯖]]がすべての「期待」
に対応していなければ拒絶しなければならないことになっており、
対応していてもいなくても良い[[クライアント]]の「好み」には相応しくないとして
[CODE(HTTP)@en[[[Prefer:]]]] が別途追加されました [SRC[>>7]]。

[14] [CODE(HTTP)@en[[[Opt:]]]] [[ヘッダー]]も似たような要件で追加されたようですが、
[[名前空間]]により間接的に要望を記述するものとなっていますので、
直接指定する [CODE(HTTP)@en[[[Prefer:]]]] とは異なっています。

;; [CODE(HTTP)@en[[[Opt:]]]] が[[名前空間]]と複数の[[ヘッダー]]を使って記述していたものを
[CODE(HTTP)@en[[[Prefer:]]]] は単一の[[ヘッダー]]で記述する形に改めたとも解釈できます。

[11] [[要求URL]] の [[query]] に「好み」を指定することもできますが、
[[URL]] を変更すると[[キャッシュ]]に悪影響があるなど相応しくないとして、
[CODE(HTTP)@en[[[Prefer:]]]] が別途追加されました [SRC[>>7]]。

[12] [CODE(HTTP)@en[[[Prefer:]]]] で指定する値として規定・提案されているもののうちのいくつかは、
[[URL]] の [[query]] や [CODE(HTTP)@en[[[POST]]]] 時の [CODE(MIME)@en[[[application/x-www-form-urlencoded]]]]
や [CODE(MIME)@en[[[multipart/form-data]]]] や [CODE(MIME)@en[[[application/json]]]]
などの [[payload body]] に ([[アプリケーション]]依存の方法で) 指定するので十分な気がしますが・・・。

[13] あるいは [CODE(HTTP)@en[[[Prefer:]]]] [[ヘッダー]]にまとめずとも、
用途ごとにそれぞれ個別の[[ヘッダー]]とした方が処理もしやすそうなものがいくつかありますが・・・。