[11] 
[[OpenType]] 
ファイルには
[[SVG]]
形式の[[グリフ]]データを格納できます。

* 仕様書

[REFS[

- [13] 
[CITE@en-us[[[SVG]] - Scalable vector graphics table (OpenType 1.9.1) - Typography | Microsoft Learn]], [[PeterCon]], [TIME[2024-05-31T17:42:32.000Z]], [TIME[2024-11-17T08:54:20.185Z]] <https://learn.microsoft.com/en-us/typography/opentype/spec/svg>

]REFS]

* [CODE[SVG ]] 表

[25] 
[CODE[SVG ]] [[表][OpenType表]]では、
[[グリフID]]に対してその[[SVG文書]]を対応付けることができます。
[SRC[>>13]]

* SVG 形式のグリフの値

[38] 
[CODE[SVG ]] における [[SVG文書]]は、
[[平文]]としてまたは [[gzip]] 符号化により記述できます。
[SRC[>>13]]

[39] 
実装はこの両方に対応しなければ[RUBYB[なりません][must]]。 [SRC[>>13]]

;; [40] 
[CODE[SVG ]] の [F[[CODE[svgDocLength]]]] で指定するのは、
符号化された状態のデータの長さであって、復号後の長さでは''ありません''。
[SRC[>>13]]

** [CODE[SVG]] における gzip

[35] 
[[RFC 1952]] [[gzip]] 形式を使うことができます。 [SRC[>>13]]

[36] 
[[gzip]] では [[RFC 1951]] [[deflate]] 圧縮方式を使わなければ[RUBYB[なりません][must]]。
[SRC[>>13]]

[37] 
従って [[gzip]] を使う場合は先頭を [N[0x1F]] [N[0x8B]] [N[0x08]] 
としなければ[RUBYB[なりません][must]]。
[SRC[>>13]]


* SVG の要件

** SVG の機能

[26] 
[CODE[SVG ]] で使う [[SVG]] は、

> [SNIP[]] Scalable Vector Graphics (SVG) 1.1 (Second Edition) specification at [ASIS[http://www.w3.org/TR/SVG11][リンク]]. 

であると定められています。 [SRC[>>13]]

[27] 
現時点でそのリンク先 <http://www.w3.org/TR/SVG11> は、 >>28 に[[リダイレクト]]され、
>>29 と同じものが表示されます。
[TIME[2024-11-17T10:57:53.00Z]]

[REFS[

- [28] 
[CITE[Scalable Vector Graphics (SVG) 1.1 (Second Edition)]], [TIME[2017-10-02T10:43:18.000Z]], [TIME[2024-11-17T10:57:07.973Z]] <https://www.w3.org/TR/SVG11/>
- [29] 
[CITE[Scalable Vector Graphics (SVG) 1.1 (Second Edition)]], [TIME[2017-10-02T10:43:18.000Z]], [TIME[2024-11-17T10:57:15.782Z]] <https://www.w3.org/TR/2011/REC-SVG11-20110816/>

]REFS]

[30] 
以前の版では、

> [SNIP[]] draft [ASIS[SVG 2][リンク]] specification. [SNIP[]]

の [CODE[context-fill]] とその他の [CODE[context-*]] [[特性値]]の利用が認められていました。
[SRC[>>13]]

[33] 
ここでそのリンク先は <https://www.w3.org/TR/SVG2/> [SRC[>>31]] で、
現時点で >>32 と同じものが表示されます。
「以前の版」がどの時点のものだったかは不明です。

[34] 
現在の版ではこれら[[特性]]群の利用は[RUBYB[[[非推奨]]][deprecated]]であります。
[[適合]]実装は、これら[[特性]]群を対応しても構いませんが、
対応することは[RUBYB[必須][required]]でも[RUBYB[推奨][recommended]]でも''ありません''。
[[フォント]]におけるこれら[[特性]]群の利用は[RUBYB[強く非推奨][strongly discouraged]]です。
[SRC[>>13]]


[REFS[

- [31] 
[CITE@en[Scalable Vector Graphics (SVG) 2]], [TIME[2018-10-02T17:56:01.000Z]], [TIME[2024-11-17T10:58:29.021Z]] <https://www.w3.org/TR/SVG2/>
- [32] 
[CITE@en[Scalable Vector Graphics (SVG) 2]], [TIME[2018-10-02T17:56:01.000Z]], [TIME[2024-11-17T10:58:40.407Z]] <https://www.w3.org/TR/2018/CR-SVG2-20181004/>

]REFS]

[51] 
[[適合]]する [[OpenType]] [[フォント]]は次の機能を使っては[RUBYB[なりません][must not]]。
[[適合]]する[[応用]]は無視しなければ[RUBYB[なりません][must]]。
[SRC[>>13]]

- [52] [CODE[text]] [[要素]], [CODE[font]] [[要素]], およびそれらと関連付けられた[[要素]]
- [53] [CODE[foreignObject]] [[要素]]
- [54] [CODE[switch]] [[要素]]
- [55] [CODE[script]] [[要素]]
- [56] [CODE[a]] [[要素]]
- [57] [CODE[view]] [[要素]]
- [58] [[XSL]]
- [59] [[相対単位]]: [CODE[em]], [CODE[ex]]
- [60] [CODE[imag]] [[要素]]における [[SVG]] データ
- [61] [[色プロファイル]]: [CODE[<icccolor>]] データ型,
[CODE[color-profile]] [[要素]], [CODE[color-profile]] [[特性]],
[CODE[@color-profile]]
- [62] [CODE[contentStyleType]] [[属性]]
- [63] [[CSS2システム色キーワード]]

[64] 
[[SVG文書]]は次の機能を含めて[RUBYB[構いませんが][may]]、実装は無視します。
[SRC[>>13]]

- [65] [CODE[desc]] [[要素]]
- [66] [CODE[metadata]] [[要素]]
- [67] [CODE[title]] [[要素]]

[68] 
次の機能は[[適合]]実装において[RUBY[必須][required]]の能力では''ありません''が、
[[応用]]によっては対応しているかも[RUBYB[しれません][may]]。
[[フォント]]開発者は想定対象環境で利用できるか評価する[RUBYB[べきです][should]]。
広範囲の環境での[[相互運用性]]のため利用を避ける[RUBYB[べきです][should]]。
[SRC[>>13]]

- [69] [CODE[style]] [[要素]]
- [70] [CODE[style=""]] [[属性]]
- [71] [[CSS変数]] ([[カスタム特性]]) ※
- [72] [[媒体クエリー]]
- [73] [CODE[calc()]]
- [74] [[CSSアニメーション]]
- [75] [[SVGアニメーション]]
- [76] [[SVG]] [[子要素]] (SVG child elements)
- [77] [CODE[filter]] [[要素]]と関係する[[属性]] ([CODE[enableBackground]] を含む。)
- [78] [CODE[pattern]] [[要素]]
- [79] [CODE[mask]] [[要素]]
- [80] [CODE[marker]] [[要素]]
- [81] [CODE[symbol]] [[要素]]
- [82] [[XML実体]]
- [83] [CODE[image]] [[要素]]における [[JPEG]] と [[PNG]] 以外の[[画像形式]]
- [84] [[対話的]]能力 ([[イベント属性]], [CODE[zoomAndPan]] [[属性]],
[CODE[cursor]] [[特性]], [CODE[cursor]] [[要素]])

;; [85] 「SVG 子要素」って何のこと? 

;; [86] [[イベント要素]]って[[イベントハンドラー属性]]のこと?
[CODE[script]] は禁止なのに [CODE[on*]] [[属性]]は禁止ではないの?

** SVG 文書

[41] 
[[SVG文書]]の[[文字符号化]]は、 [[UTF-8]]
でなければ[RUBYB[なりません][must]]。
[SRC[>>13]]

[42] 
[[SVG文書]]は [[XML文書]]であることも [[HTML構文]]で記述されることもありますが、
[[OpenType]] [[フォント]]の [[SVG文書]]は [[XML文書]]でなければ[RUBYB[なりません][must]]。
[CODE[SVG ]] の [[SVG文書]]に対応する[[応用]]は [[XML文書]]に対応しなければ[RUBYB[なりません][must]]。
[[HTML構文]]にも対応した [[SVG]] 構文解析ライブラリーを使っても[RUBYB[構いません][may]]。
[SRC[>>13]]

[43] 
[CODE[SVG ]] の[[応用]]は [[XML名前空間]]に完全に対応する[RUBYB[必要はありません][not required]]。
[SRC[>>13]]

[44] 
[[SVG文書]]の[[根要素]]は [[SVG]] を[[既定名前空間]]
[CODE[http://www.w3.org/2000/svg]]
として[[宣言]]しなければ[RUBYB[なりません][must]]。
[SRC[>>13]]

;; [45] 本文で明言はされていませんが、示された実例では[[根要素]]の[[要素名]]は[[既定名前空間]]を使っています。
[SRC[>>13]]
[[XML名前空間]]への対応を必須としない趣旨からすれば、これも要件と考えるべきなのでしょうが、
なぜ規定がないのかは不明です。

[46] 
[CODE[xlink:href]] [[属性]]を使うときは、
[[根要素]]で [CODE[[[xmlns]]:xlink="[[http://www.w3.org/1999/xlink]]"]]
としなければ[RUBYB[なりません][must]]。
[SRC[>>13]]

[47] 
他の [[XLink]] の[[属性]]を文書中で使っては[RUBYB[いけません][No ... may]]。
[SRC[>>13]]

[48] 
他の[RUBYB[機構][mechanisms]]を文書中で使っては[RUBYB[いけません][No ... may]]。
他の名前空間宣言を[[要素]]に使う[RUBYB[べきではありません][no ... should]]。
[SRC[>>13]]

;; [49] 仕様書では 「No other XLink attributes or other mechanisms」
を使ってはいけないとしています。 [[XLink]] がどこに掛かっているのかやや不明瞭ですが、
「other ... or other ...」となっているので[[属性]]だけに [[XLink]]
が掛かっていると考えるのが妥当でしょう。 [[XLink]] の機能もすべて[[属性]]で、
他の機構はありません。
しかしそうすると「他の機構」とは何かがよくわかりません。
文脈を汲むなら [[SVG]] 本体機能でも [[XLink]] でもないもの全般でしょうか。
続けて他の[[名前空間宣言]]もあるべきではないとしています。
他のすべての機能が認められないのだとしたら、自動的に[[名前空間宣言]]も認められなくなるはずで、
意図がわかりません。宣言だけなら機構に入らないという解釈なのでしょうか。
機構の利用が禁止 (no ... may) なのに宣言は非推奨 (no ... should) 
と強さが違うのはよくわかりません。

;; [50] 後段はあるいは [[SVG]] や [[XLink]] のその他の形の宣言を禁じる意図もありそうですが。




* 文脈

[23] 
[CODE[SVG ][SVG-in-OpenType]] [[表][OpenType表]]は必須ではありません。
[SRC[>>13]]

[24] 
[CODE[SVG ]] [[グリフ]]とは別に [CODE[glyf]], [CODE[CFF ]], [CODE[CFF2]]
のいずれかの[[グリフ]]は必須です。
[SRC[>>13]]


* 実装


[15] [CITE@en-US[CSS at-rule: `@font-face`: OpenType SVG rendering | Can I use... Support tables for HTML5, CSS3, etc]], [TIME[2024-11-17T09:03:39.000Z]] <https://caniuse.com/mdn-css_at-rules_font-face_opentype_svg>


[16] >>15 によると [[Firefox]] と [[Safari]] は対応していますが、
[[Blink]] は対応していません。
[TIME[2024-11-17T09:04:19.600Z]]

[17] 
>>18 によると [[EdgeHTML]] は対応していたようですが...

* 関連

[22] [CODE[SVG ]] グリフには [[variable][variable font]] や [[hint]]
は適用できません。
[SRC[>>13]]


[14] [[色フォント]], [[アニメーションフォント]]

* 歴史

** SVG Fonts

[5] [DFN[SVG Fonts]] は、 [[SVG]] を使って記述された[[フォント]]でした。

[10] 
一部の
[[Webブラウザー]]が実装していましたが、
削除されました。


[7] 
代替として、 通常の [[OpenType]] による [[Web Fonts]] を利用できます。

-*-*-

[12] 
[[SVG Fonts]] は[[スタイル]]指定の挙動が理解不能になることや、
[[OpenType]]
の
[CODE[GSUB]] / [CODE[GPOS]]
に相当する機能が欠落していて実用が困難であるとされました。
[SRC[>>2]]


[4] [CITE@en[Note how the SVG currently implemented in browsers is a mix of SVG 1.… · whatwg/html@969c45b]]
([TIME[2015-11-18 11:28:33 +09:00]] 版)
<https://github.com/whatwg/html/commit/969c45b2478d1d2d3be8564ec85dc316a53c8bcf>

[6] [CITE@ja[Henri Sivonenさんのツイート: "Today I wrote a patch to make Gecko’s HTML parser unaware of IE5 databinding, Web Forms 2.0 repetition and SVG fonts."]]
([TIME[2017-05-23 22:13:53 +09:00]])
<https://twitter.com/hsivonen/status/855048094320398336>

[8] [CITE@en[Reference SVG 2]]
([[dstorey]]著, [TIME[2018-05-18 15:05:35 +09:00]])
<https://github.com/whatwg/html/commit/7069de4fcf2f92295dded520ed5d7275addab2e7>

[9] 
[[Acid3]] に[[テスト]]がありましたが、後に削除されました。




** SVG-in-OpenType

[1] [CITE[Well, I'm Back: SVG In OpenType: A New Approach To SVG Fonts]]
( ([TIME[2013-02-01 19:25:37 +09:00]] 版))
<http://robert.ocallahan.org/2013/02/svg-in-opentype-new-approach-to-svg.html>

[2] [CITE@en[SVGOpenTypeFonts - MozillaWiki]]
( ([TIME[2013-01-28 18:41:35 +09:00]] 版))
<https://wiki.mozilla.org/SVGOpenTypeFonts>

[3] [CITE@en[For the record: Adobe's Draft 1 of the OT 'SVG ' table]]
( ([[Sairus Patel]] 著, [TIME[2011-10-28 23:42:36 +09:00]] 版))
<http://lists.w3.org/Archives/Public/public-svgopentype/2011Oct/0000.html>





[18] [CITE@ja[OpenTypeフォントにSVGアニメーションを突っ込んでみる - にせねこメモ]], [TIME[2022-08-14T15:13:28.000Z]] <https://nixeneko.hatenablog.com/entry/2017/10/31/211922>

[19] [CITE@en-US[SVG & colors in OpenType fonts - Mozilla Hacks - the Web developer blog]], [TIME[2023-08-26T12:03:56.000Z]] <https://hacks.mozilla.org/2014/10/svg-colors-in-opentype-fonts/>

[20] [CITE[SVG Glyphs in OpenType Specification]], [TIME[2017-01-23T20:46:13.000Z]], [TIME[2023-08-26T12:04:26.514Z]] <https://www.w3.org/2013/10/SVG_in_OpenType/>

[21] [CITE@en-US[SVG glyphs for OpenType Community Group]], [TIME[2023-08-26T12:04:54.000Z]] <https://www.w3.org/community/svgopentype/>
