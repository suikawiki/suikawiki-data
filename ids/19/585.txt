[4] [DFN[[RUBYB[例外]@en[exception]]]]は、[[エラー]]を表す[[オブジェクト]]です。

* 仕様書

[REFS[
- [2] '''[CITE[Web IDL (Second Edition)]] ([TIME[2015-05-27 01:29:33 +09:00]] 版) <http://heycam.github.io/webidl/#dfn-exception>'''
- [12] [CITE[Web IDL (Second Edition)]] ([TIME[2015-05-27 01:29:33 +09:00]] 版) <http://heycam.github.io/webidl/#es-exceptions>
]REFS]

* 意味

[3] [[例外]]は、[[エラー]]を表現する[[オブジェクト]]の[[型]]で、
[[投げる]]ことができたり、[[実装]]が第一級クラス値として暑かったりするものです [SRC[>>2]]。

* 例外

[5] [[例外]]には次のものがあります。

[FIG(short list)[
- [[単純例外]]
- [CODE(IDL)@en[[[DOMException]]]]
]FIG]

[6] 以前の [[Web IDL]] (や [[OMG IDL]]) では [CODE(IDL)@en[[[exception]]]]
構文により[[例外]]を定義することができました。 [[W3C DOM]] 時代には
[CODE(IDL)@en[[[LSException]]]] などいくつかの[[例外]]インターフェイスが定義されていました。
しかし現在は廃止され、 [[Web IDL]] 仕様のみで[[例外]]が規定されています。

* 状態

[7] [[例外]]には次の状態があります。
[FIG(list members)[
:[[エラー名]]:[[例外]]の種類を表す文字列です。
:[[メッセージ (例外)]]:エラー情報を表す文字列です。
]FIG]

[8] 他にもエラーの種類に依存した状態を持ちます。

* 演算

[9] [[例外]]は、[[エラー名]]を指定して[DFN[[RUBYB[作成]@en[create]]]]できます [SRC[>>2]]。
その動作は[[言語束縛]]により決まります [SRC[>>2]]。

[13] [[JavaScript]] では、次のようにしなければ[['''なりません''']] [SRC[>>12]]。
[FIG(steps)[
= [[利用者エージェント]]定義のメッセージが指定されていれば、 [CODE(JS)@en[[[String]]]]
[[JavaScript値に変換]]します。定義されていなければ、 [CODE(JS)@en[[[undefined]]]]
とします。
= [[エラー名]]を、 [CODE(JS)@en[[[String]]]] [[JavaScript値に変換]]します。
= 作成するのが[[単純例外]]なら、
== [[現在大域環境]]の[[エラー名]]に対応する[[コンストラクター]]を[[関数]]として呼び出します。
[[引数]]は、[[利用者エージェント]]定義のメッセージとします。
== その結果を返します。
= 作成するのが [CODE(DOMi)@en[[[DOMException]]]] なら、
== [[現在大域環境]]の [[DOMExceptionコンストラクターオブジェクト]]を[[関数]]として呼び出します。
[[引数]]は、 [CODE(JS)@en[[[undefined]]]] と[[エラー名]]とします。
== その結果を返します。
]FIG]

;; [11] [[DOMException]] なら[[利用者エージェント]]定義の[[メッセージ (例外)]]は使わないことになります。
しかし実際には [CODE(JS)@en[[[DOMException]]]] [[オブジェクト]]は
[CODE(DOMa)@en[[[message]]]] [[IDL属性]]が[[利用者エージェント]]依存の値を持つことがあるようです。

[10] [[例外]]は、[[投げる]]ことができます [SRC[>>2]]。

* 歴史

[1] [CITE@en[Re: Exceptions in event listeners triggered by dispatchEvent().]]
( ([[Anne van Kesteren]] 著, [TIME[2013-06-03 18:33:37 +09:00]] 版))
<http://lists.w3.org/Archives/Public/www-dom/2013AprJun/0161.html>