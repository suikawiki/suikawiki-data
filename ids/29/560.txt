[2] [[Lotus 1-2-3]] は[[グレゴリオ暦]]を採用していますが、
1900年は[[閏年]]としていました。1900年2月29日が挿入されるため、
取り扱い可能な最初の日である1900年1月1日から1900年2月28日までが、
[[グレゴリオ暦]]とは1日ずれています。

[3] [[誤方互換性]]のため、 [[Microsoft Excel]] がこれを踏襲しています [SRC[>>1]]。

[REFS[
- [1] [CITE@en-us[Excel incorrectly assumes that the year 1900 is a leap year]]
([TIME[2017-01-09 16:16:35 +09:00]])
<https://support.microsoft.com/en-us/kb/214326>
]REFS]

[4] [CITE@ja-jp[Excel の 1900 年を基準とした日付方式と 1904 年を基準とした日付方式の違いについて]]
([TIME[2017-01-09 17:58:02 +09:00]])
<https://support.microsoft.com/ja-jp/kb/214330>

[5] [CITE@en-us[Days of the week before March 1, 1900 are incorrect in Excel]]
([TIME[2017-01-09 17:59:57 +09:00]])
<https://support.microsoft.com/en-us/kb/214058>

[FIG(quote)[
[FIGCAPTION[
[6] [CITE@ja[Excelだけに存在する日付 | ユニリタブログ]]
([TIME[2017-03-10 18:24:20 +09:00]])
<http://www.unirita.co.jp/blog/data-utilization/data-linkage/20141202.html>
]FIGCAPTION]

> この記載によると、Office Open XML形式ファイルの仕様上は、(マイナス数値を使って)0001/01/01から扱うことができ、「1900/02/29」は存在しないことになっています(なので、1900/02/28より前の日付において、仕様とExcelの実装には差異があります)。過去の「ECMA-376」では、「1900/02/29」は「古い表計算ソフトとの互換のため」として定義があったと記憶しているので、版が進んだことでその仕様は無くなったようです。

]FIG]


[FIG(quote)[
[FIGCAPTION[
[7] [CITE@ja[Excelだけに存在する日付 | ユニリタブログ]]
([TIME[2017-03-10 18:24:20 +09:00]])
<http://www.unirita.co.jp/blog/data-utilization/data-linkage/20141202.html>
]FIGCAPTION]

> 「1900年から計算する」設定で数値「0」を日付に変換すると…
> 1900/1/0
>  
> これまた困った日付に…

]FIG]

[FIG(quote)[
[FIGCAPTION[
[8] [CITE[Standard ECMA-376]] ([TIME[2017-02-28 21:46:40 +09:00]]) <http://www.ecma-international.org/publications/standards/Ecma-376.htm>
[CITE[ECMA-376 1st edition Part 4]]
1919ページ
]FIGCAPTION]

> date1904 (Date 1904)
> Specifies a boolean value that indicates whether the date systems used in the workbook
starts in 1904.
> A value of on, 1, or true indicates the date system starts in 1904.
> A value of off, 0, or false indicates the workbook uses the 1900 date system, where
1/1/1900 is the first day in the system.
> The default value for this attribute is false.
> The possible values for this attribute are defined by the XML Schema boolean datatype.
]FIG]