* 仕様書

[REFS[
-
[1] 
[CITE@en-us[[[GDEF]] — Glyph Definition Table (OpenType 1.9) - Typography | Microsoft Docs]], [[PeterCon]], [TIME[2022-08-16T08:07:02.000Z]] <https://docs.microsoft.com/en-us/typography/opentype/spec/GDEF>
]REFS]

* グリフ級定義

[5] 
[CODE[GDEF]]
[[表]]の
[DFN[[CODE[glyphClassDefOffset]]]]
で参照される[DFN[[RUBYB[グリフ[RUBY[級][きゅう][クラス]][RUBY[定][てい]][RUBY[義][ぎ]]][Glyph Class Definition]]]]
([DFN[GlyphClassDef]])
[[部分表]]は、
[[フォント]]内の[[グリフ]]を分類するものです。
[SRC[>>1]]

[25] 
[CODE[GDEF]] [[表]]の [F[version]] [N[1.0]], [N[1.2]], [N[1.3]] に存在します。
[SRC[>>1]]

[6] 
[[級定義]][[表]]として記述します。
[SRC[>>1]]
[[級値]]は [[uint16]] で、
[[級定義]]表内に明示しない場合の既定値は [N[0]] となります。

[7] 
[[級値]]は次のいずれかによります。
[SRC[>>1]]

- [DFN[[N[0]]]] 未分類 
- [DFN[[N[1]]]] [RUBYB[[[基底][基底文字]]][base]]グリフ
- [DFN[[N[2]]]] [RUBYB[[[合字]]][ligature]]グリフ
- [DFN[[N[3]]]] [RUBYB[[[マーク][結合マーク]]][mark]]グリフ
- [DFN[[N[4]]]] [RUBYB[部品][component]]グリフ

;; [9] [N[1]] は[[基底文字]]に相当するもの、
[N[3]] は[[結合文字]]に相当するもの。
[N[2]] は複数の[[文字]]の組み合わせで生じる[[合字]]を表現するもの、
[N[4]] は[[合字]]の構成部品を表すもの。

[8] 
ここで指定された[[グリフ級]]は,
[CODE[GPOS]]
や
[CODE[GSUB]]
の記述に用いることができます。

[10] 
[CODE[GDEF]] [[表]]も
[[GlyphClassDef]] [[部分表]]も[[グリフ]]への[[グリフ級]]の割当も必須ではなく、
必要ないなら省略して良いことになっています。

* マーク添付級定義

[11] 
[CODE[GDEF]]
[[表]]の
[DFN[[CODE[markAttachClassDefOffset]]]]
で参照される[DFN[[RUBYB[マーク[RUBY[添][てん]][RUBY[付][ぷ]][RUBY[級][きゅう][クラス]][RUBY[定][てい]][RUBY[義][ぎ]]][Mark Attachment Class Definition]]]] ([DFN[MarkAttachClassDef]])
[[部分表]]は、
[RUBYB[[[マーク][結合マーク]]][mark]][[グリフ]]を分類するものです。
[SRC[>>1]]

[26] 
[CODE[GDEF]] [[表]]の [F[version]] [N[1.0]], [N[1.2]], [N[1.3]] に存在します。
[SRC[>>1]]


[12] 
[[級定義]][[表]]として記述します。
[SRC[>>1]]
[[級値]]は [[uint16]] で、
[[級定義]]表内に明示しない場合の既定値は [N[0]] となります。

[16] 
[[グリフ級定義]]とは独立しており,
(意味があるかはともかく)
[[グリフ級]]が [N[3]] ([[マーク]])
でなくても[[マーク添付級]]を
[N[0]]
以外に設定できます。

[17] 
級値の意味は特に定められていません。
[[フォント]]ごとに決められるのでしょう。
同じような位置の[[マーク][結合マーク]]をグループ化することが想定されています
[SRC[>>1]]。

[13] 
ここで指定された[[マーク添付級]]は,
[CODE[GPOS]]
や
[CODE[GSUB]]
の記述に用いることができます。

[14] 
[CODE[GDEF]] [[表]]も
[[MarkAttachClassDef]] [[部分表]]も[[グリフ]]への[[マーク添付級]]の割当も必須ではなく、
必要ないなら省略して良いことになっています。

* マークグリフ集合群

[18] 
[CODE[GDEF]]
[[表]]の
[DFN[[CODE[markAttachClassDefOffset]]]]
で参照される[DFN[[RUBYB[マークグリフ[RUBY[集][しゅう]][RUBY[合][ごう]][RUBY[群][ぐん]]][Mark Glyph Sets]]]]
([DFN[MarkGlyphSets]])
[[部分表]]は、
[[グリフ]]の集合を記述するものです。

[27] 
[CODE[GDEF]] [[表]]の [F[version]] [N[1.2]], [N[1.3]] に存在します。
[SRC[>>1]]


[22] 
現在 [CODE[format]] は [N[1]] のみが規定されています。
[SRC[>>1]]

[23] 
[CODE[format]] [N[1]] では、
[[Coverage]] [[表]]を任意の個数記述できます。
[SRC[>>1]]

[24] 
位置 [VAR[i]] の [[Coverage]] [[表]]を使って、
第 [VAR[i]] の[[マークグリフ集合]]に[[グリフ]]が所属するかどうかが定まります。
[[級定義]]を使った[[マーク添付級定義]]では1つの[[グリフ]]がちょうど1つの[[マーク添付級]]に属するのとは違って、
こちらでは1つの[[グリフ]]は任意の個数の[[マークグリフ集合]]に所属できます。



[19] 
[[マーク添付級]]を更に拡張して[[グリフ]]をグループ化するために使えます。
[SRC[>>1]]

[20] 
ここで指定された[[グリフ]]の[[集合]]は,
[CODE[GPOS]]
や
[CODE[GSUB]]
の記述に用いることができます。

[21] 
[CODE[GDEF]] [[表]]も
[[MarkGlyphSets]] [[部分表]]も必須ではなく、
必要ないなら省略して良いことになっています。



* 文脈

[15] 
[CODE[GDEF]] [[表]]は必須ではなく、不要なら省略できます。
実際に省略した[[フォント]]も珍しくありません。

* メモ

[2] 
[CITE[BabelStone Han]] :
[[glyph class]]
1, 2, 3
の[[グリフ]]の一覧が入っています。 
[CODE[classFormat]] 2。

[3] 
[CITE[花園明朝]] :
全文字 
[[glyph class]]
1
とする一覧が入っています。
[CODE[classFormat]] 2。

[4] 
[CITE[Nishiki-teki]] :
[[glyph class]]
1, 2, 3
の[[グリフ]]の一覧が入っています。 
[CODE[classFormat]] 2。

[CODE[MarkAttachClassDef]]
も
class 0
に1つだけ入っています。
[CODE[classFormat]] 1。

[CODE[LigCaretList]]
も入っていますが中身は空です。
