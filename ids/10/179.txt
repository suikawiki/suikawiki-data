[7] [DFN[[RUBYB[[[認証]]]@en[authentication]]]]は、[[合言葉]]その他の方法によって[[クライアント]]が[[鯖]]の[[資源]]にアクセスする権限を有しているか確認し、限定する機能です。
[[基本認証]]や [[OAuth]] が広く用いられています。

* 仕様書

[REFS[
- [5] '''[CITE@en[RFC 7235 - Hypertext Transfer Protocol (HTTP/1.1): Authentication]] ([TIME[2014-09-11 10:01:28 +09:00]] 版) <https://tools.ietf.org/html/rfc7235>'''
-- [10] [CITE@en[RFC 7235 - Hypertext Transfer Protocol (HTTP/1.1): Authentication]] ([TIME[2014-09-11 10:01:28 +09:00]] 版) <https://tools.ietf.org/html/rfc7235#section-2.1>
- [2] [CITE@en[RFC 3261 - SIP: Session Initiation Protocol]] ([TIME[2014-08-15 14:48:03 +09:00]] 版) <http://tools.ietf.org/html/rfc3261#section-22>
]REFS]

* プロトコル要素

[3] [[HTTP認証]]に関わる次の[[HTTPヘッダー]]があります。

[FIG(short list)[
- [CODE(HTTP)@en[[[Authorization:]]]]
- [CODE(HTTP)@en[[[Proxy-Authorization:]]]]
- [CODE(HTTP)@en[[[WWW-Authenticate:]]]]
- [CODE(HTTP)@en[[[Proxy-Authenticate:]]]]
]FIG]

[4] [[HTTP認証]]に関わる次の[[HTTP状態符号]]があります。

[FIG(short list)[
- [CODE(HTTP)[[[401]]]]
- [CODE(HTTP)[[[407]]]]
]FIG]

[6] [[HTTP認証]]に関わる次の構文があります。

[FIG(short list)[
- [CODE(ABNF)@en[[[auth-scheme]]]]
- [CODE(ABNF)@en[[[auth-param]]]]
- [[challenge (HTTP)]]
- [[credentials]]
]FIG]

* 認証方式

[8] [[HTTP認証]]では[[基本認証]]や [[OAuth]] をはじめ、
色々な認証方式を用いることができます。詳しくは
[CODE(ABNF)@en[[[auth-scheme]]]] を参照してください。

* 処理モデル

[11] [[起源鯖]]は、保護された[[資源]]に対する[[要求]]で [[credentials]] がなかったり、
非妥当な [[credentials]] (例えば誤った[[パスワード]]) が指定されていたり、
不完全な [[credentials]] (例えば複数回の往復が必要な認証方式の途中の段階)
が指定されていたりする場合には、最低1つの (おそらくは新しい)
[[challenge]] が指定された [CODE(HTTP)@en[[[WWW-Authenticate:]]]]
[[ヘッダー]]を含む [CODE(HTTP)[[[401]]]] [[応答]]を送信する[['''べきです''']] [SRC[>>10]]。

[12] 認証が必要な[[串]]は、[[要求]]で[[串]]についての [[credentials]] がなかったり、
非妥当な [[credentials]] (例えば誤った[[パスワード]]) が指定されていたり、
不完全な [[credentials]] (例えば複数回の往復が必要な認証方式の途中の段階)
が指定されていたりする場合には、最低1つの (おそらくは新しい)
[[challenge]] が指定された [CODE(HTTP)@en[[[Proxy-Authenticate:]]]]
[[ヘッダー]]を含む [CODE(HTTP)[[[407]]]] [[応答]]を送信する[['''べきです''']] [SRC[>>10]]。

;; [14] 認証が必要な[[串]]で認証に成功した場合には通常は 
[CODE(HTTP)@en[[[Proxy-Authorization:]]]] [[ヘッダー]]を削除して[[転送]]しますが、
[[串]]の構成によってはそのまま[[転送]]することもあります。
[CODE(HTTP)@en[[[Proxy-Authorization:]]]] [[ヘッダー]]の項を参照。

[13] [[鯖]]は、妥当な [[credentials]] が含まれていて、なお適切なアクセス権を有しない場合には、
[CODE(HTTP)[[[403]]]] [[応答]]を返す[RUBYB[べき]@en[ought to]]です [SRC[>>10]]。

* 実装

[1]
[CITE[[IE5] Office ドキュメントを開くと認証ダイアログが表示される]] <http://support.microsoft.com/default.aspx?scid=kb;ja;415541>

>基本認証のかかったページ内にある Excel などの Office ドキュメントを Internet Explorer 5 上から開こうとすると、再度、認証ダイアログが表示される現象
>Office 2000 アプリケーションが Internet Explorer から起動される場合、Internet Explorer のキャッシュを利用せずに、Internet Explorer から渡された URL から自分自身で、ファイルをダウンロードして、ファイルを表示するようになっています。Internet Explorer は、他のプロセスにパスワードなどの認証情報を引き継がないため、Office 2000 アプリケーションが認証情報を設定せずに、Web サーバへリクエストを送信するためです。

* 関連

[9] [[HTTP]] では、 [[HTTP]] 本体の機能である [[HTTP認証]]の他に、
用途や個々の [[Webアプリケーション]]特有の色々な認証方式が用いられています。
例えば次のものがあります。

[FIG(short list)[
- [[Cookie認証]]
- [[OAuth]] ([[HTTP認証]]を使わないもの)
- [[APIキー]]
- [[はてな認証API]]
- [[かんたんログイン]]
- [[TLS]] [[クライアント認証]]
- [[IPアドレス]]によるアクセス制限
]FIG]

* メモ

[1]
[CITE[HTTP Authentication with HTML forms : Paul James]] <http://www.peej.co.uk/articles/http-auth-with-html-forms.html>

[408] [CITE@en[draft-williams-websec-session-continue-proto-00 - Hypertext Transport Protocol (HTTP) Session Continuation Protocol]]
( ([TIME[2014-10-19 15:12:28 +09:00]] 版))
<http://tools.ietf.org/html/draft-williams-websec-session-continue-proto-00>

[409] [CITE@en[draft-williams-websec-session-continue-proto-00 - Hypertext Transport Protocol (HTTP) Session Continuation Protocol]]
( ([TIME[2014-10-19 15:12:28 +09:00]] 版))
<http://tools.ietf.org/html/draft-williams-websec-session-continue-proto-00>

[410] [CITE@en[draft-oiwa-httpauth-multihop-template-00 - Common Template for HTTP Message-based Multi-hop Authentication]]
( ([TIME[2014-10-18 15:08:43 +09:00]] 版))
<https://tools.ietf.org/html/draft-oiwa-httpauth-multihop-template-00>

[411] [CITE@en[draft-williams-httpbis-auth-classification-01 - A Proposals for Classification and Analysis of HTTPbis Authentication Proposals]]
( ([TIME[2014-10-16 14:58:39 +09:00]] 版))
<http://tools.ietf.org/html/draft-williams-httpbis-auth-classification-01>

[412] [CITE@en[draft-williams-httpbis-auth-classification-01 - A Proposals for Classification and Analysis of HTTPbis Authentication Proposals]]
( ([TIME[2014-10-16 14:58:39 +09:00]] 版))
<http://tools.ietf.org/html/draft-williams-httpbis-auth-classification-01>