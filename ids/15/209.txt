[FIG(table)[

:1: [[元日]]
:t: 初[[木曜日]]
:f: [[ISO週暦]][[年始]]
:f-: [[ISO週暦]][[年始]] - 1
:w: 初[[水曜日]]
:wf: 日曜週暦年始

:1: [TIME[2010-01-01]]
:t: [TIME[2010-01-07]]
:f: [TIME[2010-01-04]]
:f-: [TIME[2010-01-03]]
:w: [TIME[2010-01-06]]
:wf: [TIME[2010-01-03]]

:1: [TIME[2011-01-01]]
:t: [TIME[2011-01-06]]
:f: [TIME[2011-01-03]]
:f-: [TIME[2011-01-02]]
:w: [TIME[2011-01-05]]
:wf: [TIME[2011-01-02]]

:1: [TIME[2012-01-01]]
:t: [TIME[2012-01-05]]
:f: [TIME[2012-01-02]]
:f-: [TIME[2012-01-01]]
:w: [TIME[2012-01-04]]
:wf: [TIME[2012-01-01]]

:1: [TIME[2013-01-01]]
:t: [TIME[2013-01-03]]
:f: [TIME[2012-12-31]]
:f-: [TIME[2012-12-30]]
:w: [TIME[2013-01-02]]
:wf: [TIME[2012-12-30]]

:1: [TIME[2014-01-01]]
:t: [TIME[2014-01-02]]
:f: [TIME[2013-12-30]]
:f-: [TIME[2013-12-29]]
:w: [TIME[2014-01-01]]
:wf: [TIME[2013-12-29]]

:1: [TIME[2015-01-01]]
:t: [TIME[2015-01-01]]
:f: [TIME[2014-12-29]]
:f-: [TIME[2014-12-28]]
:w: [TIME[2015-01-07]]
:wf: [TIME[2015-01-04]]

:1: [TIME[2016-01-01]]
:t: [TIME[2016-01-07]]
:f: [TIME[2016-01-04]]
:f-: [TIME[2016-01-03]]
:w: [TIME[2016-01-06]]
:wf: [TIME[2016-01-03]]

:1: [TIME[2017-01-01]]
:t: [TIME[2017-01-05]]
:f: [TIME[2017-01-02]]
:f-: [TIME[2017-01-01]]
:w: [TIME[2017-01-04]]
:wf: [TIME[2017-01-01]]

:1: [TIME[2018-01-01]]
:t: [TIME[2018-01-04]]
:f: [TIME[2018-01-01]]
:f-: [TIME[2017-12-31]]
:w: [TIME[2018-01-03]]
:wf: [TIME[2017-12-31]]

:1: [TIME[2019-01-01]]
:t: [TIME[2019-01-03]]
:f: [TIME[2018-12-31]]
:f-: [TIME[2018-12-30]]
:w: [TIME[2019-01-02]]
:wf: [TIME[2018-12-30]]


]FIG]


* 西暦2014年末の Twitter 障害

[2] 
[TIME[2014-12-29]]、
[[Android]]
版等一部のクライアントから
[[Twitter]]
にログインできなくなる[[障害]]がありました。


[REFS[

[FIG(quote)[
[FIGCAPTION[
[11] 
[CITE@en[[[Twitter Status]] - sign in issue]], [TIME[2022-06-30T09:34:00.000Z]], [TIME[2014-12-29T04:07:53.078Z]] <https://web.archive.org/web/20141229040541/http://status.twitter.com/post/106461837558/sign-in-issue>
]FIGCAPTION]

>
[BOX(set)[
[BOX[
SUN[LINES(quarter)[DEC][28TH]]
]BOX]

[BOX[

sign in issue [WEAK[2 hours ago]]

Some users are currently having trouble signing in to twitter.

Our engineers are currently working to resolve this.

]BOX]

]FIG]

[FIG(quote)[
[FIGCAPTION[
[12] 
[CITE@en[[[Twitter]] Status]], [TIME[2022-06-30T09:39:38.000Z]], [TIME[2014-12-30T02:23:36.245Z]] <https://web.archive.org/web/20141230021659/http://status.twitter.com/>
]FIGCAPTION]

>
[BOX(set)[
[BOX[
SUN[LINES(quarter)[DEC][28TH]]
]BOX]

[BOX[

sign in issue [WEAK[1 day ago]]

[ Update 9:28 PST ]

Between 4:00pm and 9:25pm PST today some users were unable to sign in to twitter.[BR[]]
This issue was due to a bug in our front end code, which has been patched.
We apologize for any inconvenience caused by this.

]BOX]

]FIG]


]REFS]


[3] 
[[障害]]当時、
[[Twitter]]
の[[HTTPサーバー]]が西暦2015年12月29日と書いた
[[HTTPヘッダー]]を
[[HTTP応答]]に含めて送ってきていると一般の [[Twitter]] 
利用者が発見しました。
[SRC[>>1]]

[4] 
発見報告ツイートへの返信で指摘されていますが、
[TIME[2015-12-29]]を意味するのだとすると[[曜日]]が合いません。
[SRC[>>1]]
[TIME[2014-12-29]]の[[曜日]]のまま、[[年]]が誤っているのです。

[5] 
指摘はされていませんが、発見報告ツイートの画像 [SRC[>>1]]
をよく見ると、

- [6] 
誤っているのは 
[CODE[Date:]]
[[ヘッダー]]だけで、
[CODE[Last-Modified:]]
[[ヘッダー]]は[TIME[2014-12-29]]です。
[[年]]以外は[[秒]]まで一致しているにも関わらずです。
- [7] 
[CODE[Set-Cookie:]]
[[ヘッダー]]の
[CODE[Expires]] 
属性は[TIME[2016-12-29]]になっていますが、
[[年]]と[[曜日]]を除けば[[月]]から[[秒]]まで一致しています。
(構文が少し違いますが、仕様通りです。
[SEE[ [[HTTPの日時形式]], [[Cookieの日時形式]] ]])
- [8] 
[CODE[Date:]]
と
[CODE[Expires]]
の[[時間帯]]は [CODE[UTC]]
になっています。
[CODE[Last-Modified:]]
の[[時間帯]]は
[CODE[GMT]]
です。
正しいのは 
[CODE[GMT]]
です。
(ちょっと複雑な事情: [SEE[ [[HTTPの日時形式]] ]])

[9] 
この状況から、この3つの[[日付]]はすべて別の方法で出力されたことがわかります。
当時と現在では [[Twitter]] のサーバーの仕様も違っているでしょうからもはや検証不能ですが、
おそらく [CODE[Expires]] は現在日時の1年後を示していたものでしょう。
[CODE[UTC]] と誤記していたのは、この障害とは関係なく元々そうだったのでしょう。
[CODE[Last-Modified:]]
はわかりませんが、
[CODE[Date:]]
と
[CODE[Expires]]
は
[[HTTP]]
専用の[[日時形式]]生成ライブラリーではなく独自のアドホックな方法で生成していたのか、
専用ライブラリーだとしても製作者は [[HTTP]]
の知識に乏しかったのでしょう。

;; [10] 
今次の障害がなかったとしても、世界最高峰の[[Web企業]]の製品とは思えない低品質ですね。



[REFS[
-
[1] 
[CITE@ja[Ninjiさんは[[Twitter]]を使っています: 「I MITMed Twitter for Android's login to see why it was failing. The Twitter servers think it's 2015. Amazing. http://t.co/iEu4rEUub9」 / Twitter]], 午前9:45 · 2014年12月29日 [TZ[+09:00]], [TIME[2022-06-30T07:34:48.000Z]] <https://twitter.com/_Ninji/status/549365454322802688>
]REFS]


* メモ