[2] [DFN[[CODE(HTTP)@en[[[Depth:]]]]]] [[ヘッダー]]は、操作の適用対象となる[[資源]]の階層の深さを指定するものです。

* 仕様書

[REFS[
- [1] [CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-10.2>
]REFS]

* 意味

[4] [CODE(HTTP)@en[[[Depth:]]]] [[ヘッダー]]は、[[内部メンバー]]を持つことがある[[資源]]についての操作で、
操作が適用される対象の深さを指定するものです [SRC[>>1]]。

[5] [DFN[[CODE(HTTP)[[[0]]]]]] は、[[資源]]自体にのみ適用されることを示します [SRC[>>1]]。

[6] [DFN[[CODE(HTTP)[[[1]]]]]] は、[[資源]]とその[[内部メンバー]]のみに適用されることを示します [SRC[>>1]]。

[7] [DFN[[CODE(HTTP)@en[[[infinity]]]]]] は、[[資源]]とそのすべての[[メンバー]]に適用されることを示します
[SRC[>>1]]。

[8] この[[ヘッダー]]は、定義上明示的に対応することになっている[[メソッド]]のみが対応しています [SRC[>>1]]。

[10] [[要求メソッド]]によっては対応していない値もあります [SRC[>>1]]。

[11] [[要求メソッド]]によっては [CODE(HTTP)@en[[[Depth:]]]] [[ヘッダー]]が指定されなかった場合の既定値もあります [SRC[>>1]]。

[12] [[クライアント]]は、[[メンバー]]に対してどの順序で操作が適用されるかや、
[[原子的]]に実行されるかどうかについて、[[メソッド]]ごとに明示的に適宜されている場合を除き、
仮定しては[['''なりません''']] [SRC[>>1]]。

* 構文

[3] 値は、 [CODE(HTTP)[[[0]]]]、[CODE(HTTP)[[[1]]]]、[CODE(HTTP)@en[[[infinity]]]]
のいずれかです。[[大文字・小文字不区別]]です [SRC[>>1]]。

[FIG(railroad)[
= |
== [CODE(HTTP)[[[0]]]]
== [CODE(HTTP)[[[1]]]]
== [CODE(HTTP)@en[[[infinity]]]]
]FIG]

* 処理

[16] [[資源]]が[[内部メンバー]]を持たない場合には、 [CODE(HTTP)@en[[[Depth:]]]]
[[ヘッダー]]は無視しなければ[['''なりません''']] [SRC[>>1]]。

[9] [[メソッド]]にもよりますが、 [CODE(HTTP)@en[[[Depth:]]]] [[ヘッダー]]の指定に従いできるだけの処理を行い、
失敗した場合はどれが失敗したかを記載した[[応答]]を返すことになっています [SRC[>>1]]。

[EG[
[13] 例えば [CODE(HTTP)@en[[[COPY]]]] [[メソッド]]で 
[CODE(HTTP)@en[[[Depth:]] [[infinity]]]] が指定された場合には、できるだけ[[資源]]を複製しようと試み、
失敗したものの一覧を [CODE(HTTP)[[[207]]]] [[応答]]に含めます。
]EG]

[14] 原則として [CODE(HTTP)@en[[[Depth:]]]] [[ヘッダー]]が含まれる[[要求]]の他の[[ヘッダー]]は[[対象資源]]のみに適用され、
[[メンバー]]には適用しては[['''なりません''']] [SRC[>>1]]。

* 関連

[15] [CODE(HTTP)@en[[[Depth:]]]] で指定された範囲内の[[資源]]が[[ロック]]されていてそのままでは[[メソッド]]の処理に成功しない場合には、
[CODE(HTTP)@en[[[If:]]]] [[ヘッダー]]に適当な[[ロックトークン]]を含めなければ[['''なりません''']] [SRC[>>1]]。
