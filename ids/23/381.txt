[5] [DFN[[RUBYB[[[検証符号]]]@en[verification code]]]]は、
[[OAuth]] [[鯖]]にアクセスして[[認可]]したのとその後
[[OAuth]] [[クライアント]]にアクセスして完了を求めたのが同一の[[資源所有者]]であることを確認するための符号です。
[DFN[[CODE(URI)@en[[[oauth_verifier]]]]]] は、[[検証符号]]を指定する[[引数]]です。

* 仕様書

[REFS[
- [20] [CITE@en[RFC 5849 - The OAuth 1.0 Protocol]] ([TIME[2014-12-28 14:19:21 +09:00]] 版) <http://tools.ietf.org/html/rfc5849#section-2>
-- [1] '''[CITE@en[RFC 5849 - The OAuth 1.0 Protocol]] ([TIME[2014-12-28 14:19:21 +09:00]] 版) <http://tools.ietf.org/html/rfc5849#section-2.2>'''
-- [6] [CITE@en[RFC 5849 - The OAuth 1.0 Protocol]] ([TIME[2014-12-28 14:19:21 +09:00]] 版) <http://tools.ietf.org/html/rfc5849#section-2.3>
]REFS]

* 検証符号

[4] [[資源所有者認可]]において[[資源所有者]]が[[認可]]することとした場合には、
[[鯖]]は[[検証符号]]を生成しなければなりません。

[16] [[検証符号]]は[[鯖]]が生成した推測できない値です。
この値は[[資源所有者]]を経由して[[クライアント]]に引き渡し、
[[トークンcredentials要求]]で使うものです。
この[[検証符号]]は、アクセスを認めた[[資源所有者]]と[[クライアント]]に処理完了を求めた[[資源所有者]]が同一であることを確かめるためのものです。
[SRC[>>1]]

[2] [[資源所有者認可]]において[[資源所有者]]が[[認可]]することとした場合に、
[[鯖]]は[[コールバックURL]] に[[資源所有者]]を[[リダイレクト]]するなら、
[[URL]] の [[query]] の [CODE(URI)@en[[[oauth_verifier]]]] [[引数]]で[[検証符号]]を指定しなければ[['''なりません''']] [SRC[>>1]]。

[3] [[鯖]]が[[資源所有者]]を[[リダイレクト]]しない場合には、
[[鯖]]は[[資源所有者]]に[[検証符号]]を表示し、手動で[[クライアント]]に入力するよう指示する[['''べきです''']] [SRC[>>1]]。

[17] [[リダイレクト]]しないで[[検証符号]]を表示する場合、
[[クライアント]]が能力の限られた装置で動作していると[[鯖]]が知っている時は、
手動入力に相応しい値とする[['''べきです''']]。 [SRC[>>1]]

[28] 生成する値の長さや値域に仕様上の制約はありません [SRC[>>20]]。
しかしあまりに短い値だと推測できない値になりません。

;; [8] [[リダイレクト]]しない場合には、あまり長くはない[[ASCII英数字]]の列とするのが一般的なようです。

[7] [[クライアント]]は、[[資源所有者認可]]により発行された[[検証符号]]を[[資源所有者]]から得たら、
[[トークン要求]]の際にそれを [CODE(URI)@en[[[oauth_verifier]]]] [[引数]]
([[OAuth 1.0]] としての[[引数]]) に指定しなければ[['''なりません''']] [SRC[>>6]]。
[[鯖]]は指定された値が正しければ[[トークン要求]]を発行できます。
