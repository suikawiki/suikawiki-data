[22] [DFN[[RUBYB[[[展開]]]@en[expansion]]]]は、[[URI雛形]]から [[URI]]
を得る演算です。

* 仕様書

[REFS[
- [2] [CITE@en[RFC 6570 - URI Template]] ([TIME[2014-10-27 23:08:55 +09:00]] 版) <http://tools.ietf.org/html/rfc6570#section-1.1>
- [3] [CITE@en[RFC 6570 - URI Template]] ([TIME[2014-10-27 23:08:55 +09:00]] 版) <http://tools.ietf.org/html/rfc6570#section-3>
]REFS]

* 意味

[1] [DFN[[RUBYB[[[展開]]]@en[expansion]]]]は、
[[雛形式]]を処理して得られる[[文字列]]です [SRC[>>2]]。

* URI 雛形の展開

[4] [[URI雛形]]の[[展開]]は、次のように行います。
[FIG(steps)[
= [5] 入力として[[雛形]]と、[[変数]]の値を用意します [SRC[>>3]]。
= [14] 出力として結果を空文字列、誤りを null とします。
= [6] [[雛形]]を最初から順に[[走査]]してゆきます [SRC[>>3]]。
== [7] [[雛形リテラル]]なら、[[展開]]し、結果の末尾に連結します [SRC[>>3]]。
== [8] [[雛形式]]なら、
=== [15] [[展開]]を試みます [SRC[>>3]]。
=== [13] 成功したら、結果の末尾に[[展開]]結果を連結します [SRC[>>3]]。
=== [16] 失敗したら、
==== [17] 誤りの位置と種類を設定する[['''べきです''']] [SRC[>>3]]。
==== [18] [[展開]]しないまま結果の末尾に連結する[['''べきです''']] [SRC[>>3]]。
== [9] [[文法]]に一致しない文字列なら、
=== [10] 誤りの位置と種別を設定する[['''べきです''']]。 [SRC[>>3]]
=== [11] この部分以降の[[雛形]]残りすべてをそのまま結果の末尾に連結し、
次の段階に進む[['''べきです''']] [SRC[>>3]]。
== [12] [[雛形]]の最後に到達したら、次の段階に進みます。そうでなければ、 >>6 に戻ります。
= [19] 出力として結果と誤りを返します。
]FIG]

;; [21] [[雛形リテラル]]、[[雛形式]]の展開の項も参照。

[20] [[誤り]]がある場合、得られた文字列は妥当な [[URI参照]]ではないかもしれません。
これは診断用のものです。 [SRC[>>3]]