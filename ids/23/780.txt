[6] [DFN[[[JSON text sequences]]]] ([DFN[[CODE(MIME)@en[[[application/json-seq]]]]]])
は、 [[JSON]] を0個以上並べたデータ形式です。

* 仕様書

[REFS[
- [1] [CITE@en[RFC 7464 - JavaScript Object Notation (JSON) Text Sequences]] ([TIME[2015-02-26 08:31:19 +09:00]] 版) <https://tools.ietf.org/html/rfc7464>
]REFS]

* 構文

[7] [[RFC 7159]] [[JSON]] 値の0個以上の列ですが、 [[JSON]] 値の前には
[CODE(charname)@en[[[RS]]]] ([CODE[[[U+001E]]]])、後には
[CODE(charname)@en[[[LF]]]] ([CODE[[[U+000A]]]]) を必ず配置するものです。

;; [8] 一般的に [[JSON]] 値の列を表したい時は[[改行]]にしますが、 [[RFC 7464]]
形式では[[改行]]は [[CRLF]] ではなく [[LF]] 1つでなければなりませんし、
[CODE(charname)@en[[[RS]]]] を入れる必要があります。一般的な[[エディター]]や[[コピーアンドペースト]]による入力では気づかないうちに
[[CRLF]] を記述してしまいそうですし、 [CODE(charname)@en[[[RS]]]] は入力が難しく、
表示上もあるのかどうかの判断が難しそうなので、 [[RFC 7464]] 形式は非常に取り扱いが難しそうです。

;; [12] 元々 [[LF]] のみだったところ、提案があって [CODE(charname)@en[[[RS]]]]
を求めることにしたと謝辞にあります [SRC[>>1]]。 [CODE(charname)@en[[[LF]]]]
は [[JSON]] 値に含まれる可能性があるので他の区切り文字を使いたかったのでしょうが、
行長が長くなるのも嫌って [[LF]] も必須のままにしたのですかね。

;; [13] [[LF]] 区切りなら [[Unix]] 等の行指向ツールの入力として使いやすかったですし、
プログラミング言語の標準ライブラリー等にも大抵は [[LF]] ないし [[CRLF]]
区切りの行読み込みモードが実装されていて扱いやすそうですが、 
[CODE(charname)@en[[[RS]]]] が入っているし[[JSON]]値に [CODE(charname)@en[[[LF]]]]
が含まれる可能性があるということでそうもいきません。

* 実装

[2] 対応アプリケーション例に [[jq]] がありますが、少なくても現時点で最新の正式版である
1.4 には [CODE[--seq]] オプションは実装されていないようです。 [[GitHub]] 版には実装されているようですが、
いくつか Issues に不具合が登録されており [SRC[>>3, >>4]]、この状態でも [[RFC]]
に適合すると言えるのかどうか知りませんが、 [[RFC]] の対応アプリケーション例の筆頭 [SRC[>>1]]
としては恥ずかしい ([[RFC]] の側が。) ように思えます。

;; [5] 実装が存在していなくても [[RFC]] が出版される要件は満たせるのでしょうから、
[[IETF]] としては仕様の問題ではなく実装の問題ということでどうでもいいのかもしれませんが...

[REFS[
- [3] [CITE@en[Add --seq-strict or similar · Issue #654 · stedolan/jq]] ([TIME[2015-03-13 18:58:47 +09:00]] 版) <https://github.com/stedolan/jq/issues/654>
- [4] [CITE@en[Sequence parser does not require first text to start with RS · Issue #687 · stedolan/jq]] ([TIME[2015-03-13 18:59:06 +09:00]] 版) <https://github.com/stedolan/jq/issues/687>
]REFS]

[10] 対応アプリケーション例に >>9 もありますが [SRC[>>1]]、標準で [[LF]]
区切りであるところ、オプション [CODE[--rs]] を与えると [[RS]] が出力されるようです。

;; [11] [[RFC]] が変な構文にしたせいで無駄なオプションが必要になって利用者を混乱させる元になっている気がしますが・・・。

[REFS[
-[9] [CITE@en[mapbox/cligj]] ([TIME[2015-03-13 19:07:42 +09:00]] 版) <https://github.com/mapbox/cligj>
]REFS]
