[FIG(quote)[
[FIGCAPTION[
[1] [CITE@en[RFC 7457 - Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)]]
([TIME[2015-02-24 18:52:35 +09:00]] ç‰ˆ)
<https://tools.ietf.org/html/rfc7457#section-2.2>
]FIGCAPTION]

>    Similarly, there are attacks on the transition between unprotected
>    and TLS-protected traffic.  A number of IETF application protocols
>    have used an application-level command, usually STARTTLS, to upgrade
>    a cleartext connection to use TLS.  Multiple implementations of
>    STARTTLS had a flaw where an application-layer input buffer retained
>    commands that were pipelined with the STARTTLS command, such that
>    commands received prior to TLS negotiation are executed after TLS
>    negotiation.  This problem is resolved by requiring the application-
>    level command input buffer to be empty before negotiating TLS.  Note
>    that this flaw lives in the application layer code and does not
>    impact the TLS protocol directly.
>    STARTTLS and similar mechanisms are vulnerable to downgrade attacks,
>    whereby the attacker simply removes the STARTTLS indication from the
>    (unprotected) request.  This cannot be mitigated unless HSTS-like
>    solutions are added.

]FIG]
