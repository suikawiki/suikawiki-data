[1] [DFN[[[TLS Record Protocol]]]] は、 [[TLS]] の下位側の[[プロトコル階層]]です。

* 仕様書

[REFS[
- [2] [CITE@en[RFC 5246 - The Transport Layer Security (TLS) Protocol Version 1.2]] ([TIME[2015-02-19 08:58:15 +09:00]] 版) <http://tools.ietf.org/html/rfc5246#section-6>
]REFS]

* プロトコル

[3] [[TLS Record Protocol]] を使って規定される[[プロトコル]]はいくつかあり、
その区別を表す値を[RUBYB[[[記録内容型]]]@en[record content type]]といいます [SRC[>>2]]。
これには次のものがある他、新たなものを [[IANA登録簿]]に登録できます [SRC[>>2]]。
[FIG(short list)[
- [[handshake protocol]]
- [[alert protocol]]
- [[change cipher spec protocol]]
- [[application data protocol]]
]FIG]

[4] [[TLS Record Protocol]] の[RUBYB[運用環境]@en[operating environment]]のことを
[RUBYB[[[TLS接続状態]]]@en[TLS connection state]]といい、
次のもので構成されます [SRC[>>2]]。
[FIG(list members)[
:[RUBYB[[[接続端]]]@en[connection end]]:自身が[[クライアント]]か[[鯖]]か。
:[[PRFアルゴリズム]]:[[master secret]] から[[鍵]]を生成するのに使う[[アルゴリズム]]。
:[[bulk encryption algorithm]]:
:[[MACアルゴリズム]]:
:[[圧縮アルゴリズム]]:
:[[master secret]]:
:[[client random]]:
:[[server random]]:
]FIG]

[5] [[接続状態]]は、現在の読み取り用状態、書き込み用状態と、
pending の読み取り用状態、書き込み用状態の4つがあります [SRC[>>2]]。

[8] [RUBYB[[[記録]]]@en[record]]は、現在の読み取り用状態と書き込み用状態に従い処理されます
[SRC[>>2]]。

[6] 現在の接続状態の初期値は、暗号化、圧縮、MAC のいずれも使用しないものです [SRC[>>2]]。

[7] pending の接続状態の構成値は [[TLS Handshake Protocol]] により設定されます。
pending の接続状態は [[ChangeCipherSpec]] によって現在の接続状態と置き換えられます。
その場合 pending の接続状態は改めて空にされます。 [SRC[>>2]]
