[1] [DFN[[CODE(MIME)@en[[[text/javascript]]]]]] は、
[[JavaScript]] の [[MIME型]]です。

* 仕様書

[REFS[
- [61] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-12-29 06:24:12 +09:00]] 版) <https://html.spec.whatwg.org/#dependencies>
- [37] '''[CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-09-03 15:16:48 +09:00]] 版) <https://html.spec.whatwg.org/#javascript-mime-type>'''
]REFS]

* JavaScript MIME 型

[25] [[JavaScript]] の [[MIME型]]はいろいろありますが、そのうち、
[CODE(MIME)@en[[[text/javascript]]]] を常に使うべきです。

;; [60] 残念ながらこのことを明確に規定した[[仕様書]]は現時点で存在していません。
[[HTML Standard]] は 「[[RFC 4329]] は [CODE(MIME)@en[[[text/javascript]]]]
を[[廃止]]しているが、実際には最も良く用いられる [[MIME型]]なので、
本[[仕様書]]では [CODE(MIME)@en[[[text/javascript]]]] を用いる」
[SRC[>>61]]
としています。 ([[仕様書]]内で使うと述べるだけで[[著者]]にそれを要求していないのは、
[[JavaScript]] の[[仕様書]]が規定するべきで [[HTML]] が規定するべきではないとの立場なのでしょう。)

[38] [DFN[[RUBYB[JavaScript MIME型]@en[JavaScript MIME type]]]]は、次のものです [SRC[>>37]]。
いずれも [[JavaScript]] を表します [SRC[>>37]]。

[FIG(middle list)[ [71] [[JavaScript MIME型]]
- [CODE(MIME)@en[[[application/ecmascript]]]]
- [CODE(MIME)@en[[[application/javascript]]]]
- [CODE(MIME)@en[[[application/x-ecmascript]]]]
- [CODE(MIME)@en[[[application/x-javascript]]]]
- [CODE(MIME)@en[[[text/ecmascript]]]]
- [CODE(MIME)@en[[[text/javascript]]]]
- [CODE(MIME)@en[[[text/javascript1.0]]]]
- [CODE(MIME)@en[[[text/javascript1.1]]]]
- [CODE(MIME)@en[[[text/javascript1.2]]]]
- [CODE(MIME)@en[[[text/javascript1.3]]]]
- [CODE(MIME)@en[[[text/javascript1.4]]]]
- [CODE(MIME)@en[[[text/javascript1.5]]]]
- [CODE(MIME)@en[[[text/jscript]]]]
- [CODE(MIME)@en[[[text/livescript]]]]
- [CODE(MIME)@en[[[text/x-ecmascript]]]]
- [CODE(MIME)@en[[[text/x-javascript]]]]
]FIG]

;; [27] この一覧は、 >>31 の [[JSON]] 形式のデータファイルに含まれています。
[CODE[scripting_language]] 欄の値が [CODE[javascript]] なら、
[[JavaScript MIME型]]です。
[REFS[
- [30] [CITE@en[data-web-defs/mime-types.txt at master · manakai/data-web-defs]] ([TIME[2015-09-03 21:50:01 +09:00]] 版) <https://github.com/manakai/data-web-defs/blob/master/doc/mime-types.txt>
- [31] [CITE@en[data-web-defs/mime-types.json at master · manakai/data-web-defs]] ([TIME[2015-09-03 21:49:33 +09:00]] 版) <https://github.com/manakai/data-web-defs/blob/master/data/mime-types.json>
]REFS]

[33] [[JavaScript]] に関してこれ以外の[[MIME型]]に対応しては[['''なりません''']]
[SRC[>>37]]。

[28] [[利用者エージェント]]は、 [CODE(HTMLe)@en[[[script]]]]
[[要素]]の処理でこの [[JavaScript MIME型]] すべてを認識しなければ[['''なりません''']] [SRC[>>37]]。

;; [59] これは [CODE(HTMLe)@en[[[script]]]] [[要素]]の [CODE(HTMLa)@en[[[type]]]]
[[属性]]や [CODE(HTMLa)@en[[[language]]]] [[属性]]の値の解釈に関する規定です
([[スクリプトの媒体型]]も参照)。[[外部スクリプト]]の [[HTTPヘッダー]]
[CODE(HTTP)@en[[[Content-Type:]]]] の[[MIME型]]は、原則として無視されます。
([CODE(HTTP)@en[[[X-Content-Type-Options:]] [[nosniff]]]] [[ヘッダー]]が指定された場合には、
[[JavaScript MIME型]]かどうかの検査も行われます。)

;; [32] [[JavaScript MIME型]]を認識することは求められていますが、
[[JavaScript]] 自体を実装することは[[仕様書]]上は要求されていません。
もっとも [[Web互換性]]のためには [[JavaScript]] を実装する必要があります。

[HISTORY[
[29] [[JavaScript]] の [[MIME型]]がこうも増殖してしまったのは、
数々の歴史的不幸が重なったためです。

[FIG(list)[
- [62] 元々 [CODE(HTMLe)@en[[[script]]]] [[要素]]の[[スクリプト言語]]は
[CODE(HTMLa)@en[[[language]]]] [[属性]]で判別することとなっており、
これは [[MIME型]]ではありませんでした。それが後に [[W3C]] で標準化された際、
[[スクリプト言語]]の識別には [[MIME型]]を使うのが[[政治的に正しい]]と考えられたため、
広く普及していた [CODE(HTMLa)@en[[[language]]]] [[属性]]を[[非推奨]]とし、
新たに [CODE(HTMLa)@en[[[type]]]] [[属性]]を導入しました。
[[仕様書]]が求めていたわけではありませんが、実装によっては (後に [[HTML5]] により標準化)、
[CODE(HTMLa)@en[[[type]]]] [[属性]]が存在しないとき、
[CODE(HTMLa)@en[[[language]]]] [[属性]]の値の前に
[CODE(MIME)@en[text/]] をつけた [[MIME型]]が指定されたものとみなすこととしました。
そのため [CODE(HTMLa)@en[[[language]]]] [[属性値]]のバリエーションが
[[MIME型]]のバリエーションとなりました。
- [63] 00年代半ば頃まで [[IETF]] は [[MIME型]]の増加を抑制する方針を採っていました。
新たな [[MIME型]]の登録は難しく、実世界のみならず [[W3C]] も、
[[IANA登録簿]]に登録されていない [[MIME型]]を勝手に使っていました。
中央登録簿が機能しないため、各地で同じ意味の異なる値が独立して使われました。
- [64] 00年代半ば頃に失敗を認めるまで [[IETF]] は未登録の [[MIME型]]に
[CODE[[[x-]]]] を付けさせる方針を採っていました。 [[MIME]]
に関する知識がある人達は、 [CODE[[[x-]]]] のない [[MIME型]]を使うことを忌避し、
[CODE[[[x-]]]] をつけた値を使うようにしました。そのため [CODE[[[x-]]]]
付きと [CODE[[[x-]]]] なしのバリエーションが生まれました。
- [65] [CODE(MIME)@en[[[text/*]]]] を[[プログラミング言語]]に用いるべきではないとの
[[IETF]] の[[神話]]があり、 [CODE(MIME)@en[[[application/*]]]] 
を使うのが好ましいと考え、実践する人達がいました。そのため
[CODE[text/]] と [CODE[application/]] のバリエーションが生まれました。
- [66] この言語は元々 [[LiveScript]] と呼ばれていましたが、
[[マーケティング]]上の理由から [[Sun]] の[[商標]]を含む [[JavaScript]]
に改称されました。それをそのまま使うことが憚られ、 [[Microsoft]]
は [[JScript]]、 [[ECMA]] は [[ECMAScript]] と呼ぶことにしました。
当時の言語の非互換性から [[JScript]] と [[JavaScript]] は異なるものだと主張する人もいましたし、
中立の [[ECMAScript]] と呼ぶべきだとする人もいました。
- [67] 当初の [[JavaScript]] にはバージョン番号があり、
[CODE(HTMLa)@en[[[language]]]] [[属性]]や [CODE(HTMLa)@en[[[type]]]]
[[属性]]の値で区別していました。この区別はあまり有効に機能せず、
00年代までに廃止されていますが、それまでに色々な値が生まれました。
改版のたびに [[MIME型]]が増殖するのはけしからんと [CODE(MIME)@en[[[version]]]]
[[属性]]や [CODE(MIME)@en[[[e4x]]]] [[属性]]が作られたりもしました
(いずれも現在は使われていません)。
- [69] 元々 [CODE(HTMLa)@en[[[language]]]] [[属性]]しかなかったためか、
[[Netscape]] は [[JavaScript]] の公式な [[MIME型]]を明確に定めませんでした。
- [68] 混乱を収拾するべく(?) [[IETF]] は [[RFC 4329]] を出版しますが、
曖昧で網羅性も不十分なものでした。しかも、最も広く用いられていた
[CODE(MIME)@en[[[text/javascript]]]] を >>65 より[[廃止]]扱いにしました。
一般世間はほとんど無視しましたが、一部の[[仕様書]]を尊重する人達がそれに従い、
かえって混乱の種を蒔くこととなりました。
]FIG]
]HISTORY]

* 引数

[15] [CODE(MIME)[text/javascript]] では、
少なくても2つの引数が知られています。

,名前	,値	,既定値	,意味
,[CODE(MIME)[[[charset]]]]	,[CODE(ABNF)[charset]]	,(プロトコル依存)	,[[文字コード]]
,[CODE(MIME)[[[version]]]]	,"不明 ([CODE(ABNF)[1*[[DIGIT]] \".\" 1*DIGIT]] か?)"	,(実装依存)	,JavaScript の版
,[CODE(MIME)@en[[[e4x]]]]

[17] きちんと定義した仕様が無いので、
未知の引数・引数値に遭遇した時の実装の振舞いは予測不能です。

実装によっては、引数の存在自体や引数の順序、
引数指定内での[[空白]]の挿入・引数名や引数値の大文字・小文字などで不具合が生じる虞もあります。

[18]
[CODE(MIME)[version]] 引数は多くの実装では無くても実装している適当な版で処理されますから、
どうしても必要でなければ省略するのがよいと考えられます。

[CODE(MIME)[charset]] 引数は、他の媒体型やプロトコルとの関係により、
たとえば [[MIME]] や [[HTTP]] では必ず指定し、
[[HTML]] では指定しないのがよいと思われます。

その他の引数はできれば指定しないのがよいでしょう。

* text/ecmascript

[39] [[SVG]] 1.0 が初見です [ID]。
[[ECMAScript]] ([[ECMA]] 262)
は ECMA によって標準化された [[JavaScript]] です。

IANAREG にはまだ登録されていません。

[[WinIE]] は [[JScript]] として解釈します。

,charset	,mime.charset	,省略可	,[[MIME]]・[ID] (See [[charsetパラメーター]])
,version	,	,省略可	,[ID]

* text/javascript

[40] [[W3C]] [[HTML]] 
の仕様書に登場しますし、実際にもかなり使われています。

IANAREG には登録されていません。

application/javascript 媒体型 に対応します。 (See also
[[text/*媒体型に対応するapplication/*媒体型]])

,charset	,mime.charset	,省略可	,[[MIME]]・[ID] (See [[charsetパラメーター]])
,version	,	,省略可	,[ID]

* text/jscript

[41] [[Microsoft]] の [[JScript]] (JavaScript の亜種)
に使われることがある媒体型です。 IANAREG には登録されていません。

IE が解釈出来ます。
([[名無しさん]] [WEAK[2004-03-17 00:38:07 +00:00]])

[23] [CODE(MIME)[[[application/x-ms-jscript]]]] というのを見ました。 WinIE が解釈できるのかは不明。
([[名無しさん]] [WEAK[2004-03-20 03:54:55 +00:00]])

* text/livescript

[24] LiveScript は JavaScript の古称です。
受信側実装で対応しているものがありますが、実際に使用している文書や送信側実装があるのかはわかりません。
IANAREG には登録されていません。

* text/x-javascript

[42] Netscape Navigator が解釈できるようです。

[43] >>42 手元にある [[NN]] では確認出来ません。 
[[ScriptTest]] 参照。

* application/ecmascript

[44] 実際に幾らか使用されているようです。
IANAREG には登録されていません。

* application/javascript

[45] text/javascript に対応する媒体型です。
[[text/*媒体型]], [[application/*媒体型]]の定義からすると、
application/javascript の方を使うべきですが、旧来の実装は
text/javascript にしか対応していないものが少なくないですから、
application/javascript は LIMITED USE とされています [ID]。

IANAREG には登録されていません。

,charset	,mime.charset	,省略可	,[[MIME]]・[ID] (See [[charsetパラメーター]])
,version	,	,省略可	,[ID]

* application/x-ecmascript

[48] 受信側実装で対応している
ものがありますが、実際に使用している文書や送信側実装が
あるのかはわかりません。 

* application/x-javascript

[49] [[Apache]] HTTP server などが使用しています。 application/javascript
と同義であり、そう扱うよう [ID] は要請しています。

[50] [[Mozilla]] は対応しています。

[51] Mozilla のソースでは [CODE[application/x-javascript]] が主流で、 [CODE[text/javascript]] もよく使われています

[22] [[VRML]] では [[JavaScript]] の[[媒体型]]は
[CODE(MIME)@en[application/x-javascript]]
と規定しています。

[REFS[
- [26] [CITE[VRML97, ISO/IEC 14772-1:1997 -- Annex C, ECMAScript Scripting Reference]] <http://www.web3d.org/x3d/specifications/vrml/ISO-IEC-14772-IS-VRML97WithAmendment1/part1/javascript.html#MIMEtype>
]REFS]

* text/javascript[VAR[N]].[VAR[N]]

[52] [[WinIE]] が対応しています。次の種類が確認されています。

[FIG(middle list)[
- [CODE[text/javascript1.1]]
- [CODE[text/javascript1.2]]
- [CODE[text/javascript1.3]]
]FIG]

* version パラメーター

[21] JavaScript または ECMAScript の版を書きます。
どういう値を取るのかや既定値は規定されていません [ID]。

[53] [[Mozilla]] 1.3a で確認したところ、値が
[CODE(ABNF)["1".("0"/../"5")]] なら script が実行されます。

[54] >>53 [CODE[text/javascript]] と [CODE[application/x-javascript]] での話。

* 例

[16] [[HTML]] の [CODE(HTMLe)[[[script]]]] 要素で使用してみる例:
[PRE(HTML)[
<script type="text/javascript" src="script.js"/>
]PRE]

版引数つきの例:
[PRE(HTML)[
<script type="text/javascript; version=1.3" src="script.js"/>
]PRE]

[19] [[HTTP]] や [[MIME]] の[[実体]]として JavaScript
を送る例:
[PRE(MIME)[
[[Content-Type]]: text/javascript; charset=[SAMP(charset)[iso-2022-jp]]
[[Content-Disposition]]: [[attachment]]; [[filename]]=[SAMP(file)[script.js]]
var i = 0;
]PRE]

[20] [CODE(file)[[[.htaccess]]]] で[[接尾辞]] [CODE(file)[.js]]
と [CODE(MIME)[text/javascript]] を関連付ける例:
[PRE[
[[AddType]] text/javascript .js
]PRE]

* 歴史

** [CODE(MIME)@en[text/javascript]]

[10] (要調査: [CODE(MIME)[text/javascript]] の初出は HTML 3 Scripting draft または HTML 4 draft でしょうか。)

[14] JavaScript 関連の媒体型を遅ればせながら IANAREG
に登録するための [[Internet Draft]] も書かれましたが、
残念ながら成立にはいたっていません。

(TODO: I-D の名前は?)

[8] JavaScript 系の媒体型を一挙に登録する試みも上手く行かなかったみたいだし、このまま非標準の歴史的媒体型名としてゆくゆくは消えるんだろうか?

[9] まあ当分は生き残り続けると思われるけど。

*** text/javascript が好ましくない n 個の理由

[11] [CODE(MIME)[text/javascript]] は、しばしば望ましくないとされます。

[12] '''そもそも JavaScript を使うなどけしからん''':
JavaScript は Web の[[可接性]]やしばしば[[可用性]]を損なうので使用するべきではないとの意見があります。
しかし、 JavaScript を使うかどうかと、使う時にどういう名前でラベル付けするかは別の次元の問題です。

[2] '''[[IANAREG]] [WEAK[(媒体型に関する IANA 登録簿)]] に登録されていない''':
[CODE(MIME)[text/javascript]] は現時点で IANAREG
に登録されていません。媒体型を使う幾つかの規格は IANA
に登録されていない型の使用を認めていません。

[3] しかしながら、 >>2 だけを理由に [CODE[text/javascript]] を使うのはよくないと言う人は、もっとよく勉強するべきだと言わざるを得ません。 [[Web]] の幾つかの規格では、 IANA 登録名の使用が強制されていません。

[4] >>3 これは [[HTTP]] が出来た時に、 HTTP 通信で使われる媒体型指定はサーバーとクライアントの折衝の結果であって世界的に一意である必要はないと考えられていたことによります。 (この考えが現在でも通用するかはちょっと疑問です。それに、違う識別子を使うよりは同じ識別子を使う方が相互運用性が向上することは確かです。)

[5] しかしまあ、 [[MIME]] で使うときには登録しないといけないのでして。 (でも結局登録しようという [[I-D]] は expire されちゃったしねぇ。)

[6] とまれ、 [[HTML 4]] で使うことは何も問題ないでしょう。 HTML 4 の仕様書の例に出てくるくらいですから。

[13] '''[CODE(MIME)[[[text/[VAR[*]]]]]] を使うのは不適切である''':
[CODE(MIME)[text/[VAR[*]]]] は予備知識がなくても大意が掴める文に使うと定義されているので、
ほとんどすべての場合において JavaScript に
[CODE(MIME)[text/javascript]] という名前を充てるのは不適当です。

ウェブでは歴史的に [CODE(MIME)[text/[VAR[*]]]]
を plain text base の諸形式の媒体型として濫用してきました。
[CODE(MIME)[text/javascript]] もその一つです。

[7] >>2,>>13 の問題から最近は [CODE[[[application/x-javascript]]]] が使われることが多くなってますし、そっちの方がよさげではあります。

** 

- [ID] JavaScript and ECMAScript Media Types <urn:ietf:id:draft-hoehrmann-script-types-00> (expired)

[55] [WEAK[2002-11-16 (土) 16:32]] ''[[名無しさん]]'': 色々使われてて嫌ですね... [[Netscape]] が最初に決めておくべきだった。

[56] [[Mozilla]] 1.3a は [CODE[text/javascript]] や [CODE[application/x-javascript]] に対応しています。

[FIG(quote)[
[FIGCAPTION[
[57] [CITE[Google グループにログイン]] ([TIME[2008-06-07 17:18:29 +09:00]] 版) <https://www.google.com/groups/signin?login_required=1&passive=true&_done=http%3A%2F%2Fgroups.google.co.jp%2Fgroups%2Fcreate%3Fhl%3Dja%26lnk%3Dgcf&cd=US&hl=ja>
]FIGCAPTION]

[PRE(HTML example code)[
<noscript><style type="text/css"><!--
  .noscripthide { display:none; } .noscriptinline { display:inline; } .noscriptblock { display:block; }
--></style></noscript>
<script language="javascript"><!--
  document.write('<style type="text/css">.scripthide { display: none; } .scriptinline { display: inline; } .scriptblock { display: block; }</style>');
//--></script>
<script language="javascript1.2"><!--
  if (document.getElementById)
    document.write('<style type="text/css">.script12hide { display: none; } .script12inline { display: inline; } .script12block { display: block; } .lnav { position: absolute; } .lnavch { margin-left:23.0ex;}</style>');
//--></script>

<script language="javascript1.3"><!--
  if (document.getElementById)
    document.write('<style type="text/css">.script13hide { display: none; } .script13inline { display: inline; } .script13block { display: block; }</style>');
//--></script>
]PRE]
]FIG]

[FIG(quote)[
[FIGCAPTION[
[46] 
[REFS[
- [CITE[IRC logs: freenode / #whatwg / 20090402]] ([TIME[2009-06-12 07:57:58 +09:00]] 版) <http://krijnhoetmer.nl/irc-logs/whatwg/20090402#l-82>
- [CITE[HTML statistics]] ([TIME[2007-09-10 02:32:55 +09:00]] 版) <http://canvex.lazyilluminati.com/misc/stats/scripttypes2.html>
]REFS]
]FIGCAPTION]

># 03:39] <Philip`> Hixie: "the MIME type used to refer to JavaScript in this specification is text/javascript, since that is the most commonly used type." - most commonly used where? http://canvex.lazyilluminati.com/misc/stats/scripttypes2.html says the HTTP Content-Type 1.5 years ago was almost always "application/x-javascript" instead
> [03:45] <Hixie> hm, most commonly used isn't what i meant
> [03:45] <Hixie> most recognisable, maybe?
> [03:46] <Hixie> it's most commonly used in <script type="">, i think
> [03:46] <Hixie> but i haven't checked recently
> [03:47] <Philip`> http://canvex.lazyilluminati.com/misc/stats/scripts2.html - it was the most common <script type> by far
> [03:51] <Hixie> ok
> [03:51] <Hixie> then i'll claim that's what i meant :-P
> [03:51] <Hixie> after all, i don't think i talk about the HTTP type anywhere 

> Script [CODE(HTTP)@en[Content-Type]] values (total count)
,application/x-javascript	,2954 (81.5%)
,text/html	,229 (6.3%)
,text/javascript	,123 (3.4%)

> [CDOE(HTMLe)@en[script]] [CODE(HTMLa)@en[type]] values (total count)
,text/javascript	,31761 (53.8%)
,[missing]	,25676 (43.5%)
,text/JavaScript	,1339 (2.3%)

>[CODE(HTMLe)@en[script]] [CODE(HTMLa)@en[language]] values (total count)
,[missing]	,27315 (46.3%)
,JavaScript	,18198 (30.9%)
,javascript	,6689 (11.3%)
,JavaScript1.2	,2569 (4.4%)
,JavaScript1.1	,1559 (2.6%)
,Javascript	,1077 (1.8%)
,javascript1.2	,513 (0.9%)
]FIG]

[58] [CODE(MIME)@en[[[application/x-ms-jscript]]]] があります。

[47] [CITE@en[Give JavaScript MIME types a <dfn> to refer to · whatwg/html@8d7fe57]] ([TIME[2015-09-03 21:43:40 +09:00]] 版) <https://github.com/whatwg/html/commit/8d7fe572bca136e1397ab8fae57db791fbf8ec13>

[34] [CITE@en[Reference JavaScript MIME type now the HTML Standard defines it · whatwg/fetch@80540f2]]
([TIME[2015-09-18 17:37:25 +09:00]] 版)
<https://github.com/whatwg/fetch/commit/80540f2b891b4d9301c60c5e1e216f40be3d6b80>

[35] [CITE@ja[JSの MIME-Type は text か application か、x- は必要か – カラクリ.jp]] (更新日2015年11月15日版) <http://xn--lcki7of.jp/153/>

[36] [[IETF]] が現実に合わない [[RFC]] を長年放置しているせいで、 >>35
のような混乱させられている記事が未だに執筆されたりしています。

* メモ

[70] [CITE@en[Add <script type="module"> and module resolution/fetching/evaluation · whatwg/html@cd1a9fb]]
([TIME[2016-01-21 22:15:50 +09:00]] 版)
<https://github.com/whatwg/html/commit/cd1a9fb1e83f7d0bc30be8b34ecdaf444a0b19a4>