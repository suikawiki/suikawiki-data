[59] [[HTTP]]、[[電子メール]]、[[ネットニュース]]、[[RTSP]]、[[SIP]] その他の[[プロトコル]]で使われている
[DFN[[CODE(HTTP)[User-Agent:]] 欄]]は、
使用されている[[利用者エージェント]]を表します。

[61] '''誘導''':
[Q[利用者エージェント]]一般については
[Q[[[利用者エージェント]]]]および [Q[[[User Agent]]]]
をご覧下さい。
[[CGI]] での利用に関しては [Q[[CODE(CGI)[[[HTTP_USER_AGENT]]]]]]
の項をご覧下さい。 [[HTTP]] その他に関してはここをご覧下さい。
その他関連プロトコル要素に関しては >>62 をご覧下さい。

* 仕様書

[REFS[
- [83] '''[CITE@en[RFC 7231 - Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content]] ([TIME[2014-06-07 01:55:45 +09:00]] 版) <https://tools.ietf.org/html/rfc7231#section-5.5.3>'''
- [29] [CITE@en[RFC 7231 - Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content]] ([TIME[2014-08-07 05:54:02 +09:00]] 版) <https://tools.ietf.org/html/rfc7231#section-9.6>
- [32] [CITE[UPnP Device Architecture 2.0]] ([TIME[2014-09-05 02:24:48 +09:00]] 版) <http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v2.0.pdf#page=38>
- [37] [CITE[UPnP Device Architecture 2.0]] ([TIME[2014-09-05 02:24:48 +09:00]] 版) <http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v2.0.pdf#page=47>
- [119] [CITE@en-US[Fetch Standard]] ([TIME[2016-03-31 16:33:52 +09:00]] 版) <https://fetch.spec.whatwg.org/#default-user-agent-value>
]REFS]

* 意味

[84] [CODE(HTTP)@en[[[User-Agent:]]]] は、[[要求]]を元々作成した[[利用者エージェント]]についての情報を含めるものです。
これはしばしば[[鯖]]が[[相互運用性]]の問題を究明する補助となったり、
特定の[[利用者エージェント]]の制限を回避したり、
利用されている[[ブラウザー]]や[[OS]]の分析に使ったりするものです。 [SRC[>>83]]

[106] [CODE(HTTP)@en[[[User-Agent:]]]] や [CODE(JS)@en[[[navigator.userAgent]]]]
は、次のような目的で用いられています。
[FIG(list)[
- [107] [[利用者エージェント]]に基づく[[内容折衝]]
-- [112] [[利用者エージェント]]の実装する機能や不具合の状況による分岐
-- [111] [[ダウンロード]]ページ等における[[ダウンロード]]対象や説明文の差し替え
-- [114] 有害な[[利用者エージェント]]からのアクセスの遮断
- [113] [[クライアント]]のアクセス環境の調査
-- [108] [[利用者]]の環境に関する統計的情報の取得 (いわゆる[[アクセス解析]])
-- [110] 正しくない挙動や[[サーバー]]に害を与える[[利用者エージェント]]の特定
-- [109] [[Webアプリケーション]]の[[お問い合わせ]]フォーム等における[[利用者]]の環境の情報の取得
]FIG]

[120] [DFN[[RUBYB[既定[CODE(HTTP)@en[User-Agent]]値]@en[default `[CODE[User-Agent]]` value]]]]は、
[CODE(HTTP)@en[User-Agent:]] [[ヘッダー]]に使う[[利用者エージェント]]定義の値です
[SRC[>>119]]。
この値は [[HTTP-network-or-cache fetch]] で [CODE(HTTP)@en[User-Agent:]]
[[ヘッダー]]に設定されるほか、 [CODE(JS)@en[navigator.userAgent]] でも使われます。

* 構文

[86] 1つ以上の [CODE(ABNF)@en[[[product]]]] または [CODE(ABNF)@en[[[comment]]]]
を、 [[RWS]] 区切りで並べたものとされています。ただし、最初の1つは
[CODE(ABNF)@en[[[product]]]] でなければなりません。 [SRC[>>83]]

[FIG(railroad)[
= [CODE(ABNF)@en[[[product]]]]
= *
== [[RWS]]
== |
=== [CODE(ABNF)@en[[[product]]]]
=== [CODE(ABNF)@en[[[comment]]]]
]FIG]

[88] ここで [CODE(ABNF)@en[[[product]]]] は、[[利用者エージェント]]のソフトウェアと主要な部分製品を識別上の重要なものから順番に並べたもの
[SRC[>>83]] とされています。

[87] 現実にはこの構文は、ヒント程度にしか尊重されていません。 [[HTTP]]
仕様上の[[字句]]では認められていない文字列が使われることもありますし、
[CODE(ABNF)@en[[[product]]]] に複数 [CODE[[[/]]]] が含まれることもあります。
順序も必ずしも重要な順ではありません。実際のソフトウェアの識別に関与しない歴史的な値を設定することも多々あります。

[89] [[送信者]]は、[[生成]]する値を製品の識別に必要な程度に制限する[['''べきです''']]。
[[広告]]その他製品の識別に必要無い情報を[[生成]]しては[['''なりません''']]。
第三者による部分製品からの追加も制限する[['''べきです''']]。 [SRC[>>83]]

[90] 版番号の部分に版情報でないものを含める[['''べきではありません''']]
(つまり、同じ製品の後の版は版番号部分だけが違うべきです)。 [SRC[>>83]]

[92] 他の実装との互換性を示すためにその製品名を含めることは[RUBYB[推奨]@en[encourage]]しません
[SRC[>>83]]。

[33] [[SSDP]] [SRC[>>32]] や [[UPnP]] [SRC[>>37]] における [[HTTP]] ではより細かく構文が決められています。

* 文脈

[85] [[利用者エージェント]]は、特に設定がない限り、各[[要求]]に
[CODE(HTTP)@en[[[User-Agent:]]]] を含める[['''べきです''']] [SRC[>>83]]。

[103] [[サーバー]]によっては、 [CODE(HTTP)@en[[[User-Agent:]]]] がなかったり、
空だったりすると[[要求]]を拒絶することがあるようです。 [[Web互換性]]のためには
[CODE(HTTP)@en[[[User-Agent:]]]] [[ヘッダー]]を要求に含める必要があります。

* プライバシー

[91] [CODE(HTTP)@en[[[User-Agent:]]]] の値は [[fingerprinting]]
に使われることがあり [SRC[>>83]]、注意が必要です。

* 歴史

[FIG(quote)[
[FIGCAPTION[
[82] RFC 1945 (HTTP/1.0) 10.15; RFC 2068 (HTTP/1.1) 14.42; RFC 2616 (HTTP/1.1) 14.43 User-Agent
]FIGCAPTION]

> The User-Agent request-header field contains information about the
user agent originating the request. This is for statistical purposes,
the tracing of protocol violations, and automated recognition of user
agents for the sake of tailoring responses to avoid particular user
agent limitations. [DEL[Although it is not required, user agents should]] [INS[User agents SHOULD]]
include this field with requests. The field can contain multiple product tokens
(Section [DEL[3.7]] [INS[3.8]]) and comments identifying the agent and any subproducts which
form a significant part of the user agent. By convention, the product tokens
are listed in order of their significance for identifying the application.

[DFN[[CODE(HTTP)[User-Agent]] [[要求頭欄]]]]は、要求を作成した[[利用者エージェント]]についての情報を含みます。
これは、統計目的、プロトコル違反の追跡、および特定利用者エージェントの制限を避けるために応答を手直しするための利用者エージェントの自動認識のためのものです。
利用者エージェントは、この欄を要求に含める'''べきです'''。
この欄は、複数の [CODE(ABNF)[[[product]]]] 字句ならびに利用者エージェントおよび利用者エージェントの重要な部分を形成する部分製品を識別する注釈を含めることができます。
慣習的に、 [CODE(ABNF)[product]] 字句は、その応用を識別するのに有意な順に列挙します。

>
- User-Agent     = "User-Agent" ":" 1*( product | comment )

> Example:
- User-Agent: CERN-LineMode/2.15 libwww/2.17b3

[DEL[

> Note: Some current proxy applications append their product
information to the list in the User-Agent field. This is not
recommended, since it makes machine interpretation of these
fields ambiguous.

注意: 既存の[[串]]応用の中には [CODE(HTTP)[User-Agent]] 欄の並びに自身の製品情報を付加するものもあります。
これは、この欄の機械的解釈が曖昧になってしまうので、推奨しません。

> Note: Some existing clients fail to restrict themselves to
the product token syntax within the User-Agent field.

注意: 既存のクライアントの中には [CODE(HTTP)[User-Agent]] 欄の product 字句構文に反しているものもあります。
]DEL]

[INS[

注: 修正部はすべて RFC 1945→RFC 2068 での変更点。
]INS]
]FIG]

** USEFOR draft (電子ニュース・メッセージ) での規定に関して

[44] product の中身が [[HTTP]] では [[token]] でしたが、 usefor
では [[value]] になりました。このおかげで、漢字を使った名前とかも入れられます。

- [45] User-Agent-content   = product-token *( CFWS product-token )
- [46] User-Agent-header    = "User-Agent" ":" SP User-Agent-content *( ";" other-parameter )
- [47] product-token        = value [ "/" product-version ]
- [48] product-version      = value

- [17] [[ietf-usefor]] の議論をちょっと目を離した隙に、 [CODE(ABNF)[product]] が [CODE(ABNF)[token]] に変わってしまいました。 ([[HTTP]] と同じになった。) だから [SAMP["A User Agent"]] も [SAMP["なんかの利用者エージェント"]] も駄目になりました。 (なんでそうなったのかは、議論を追えてないので分かりませぬ。)
- [18] ''17'': [[電子ニュース]]記事の[[国際化]]を目指した [[usefor-article]] にとって大きな後退です。たとえこのままの仕様で [[RFC]] になってしまっても、 [[UTF-8]] が使える''旧仕様のメッセージを流し続けましょう''。そうすれば son-of-usefor でちゃんとなるかもしれん。
- [26] [WEAK[2002-12-22 21:46]] ''>>10'': [[comment]] の中なら [[encoded-word]] でも OK ですね。
- [27] [CODE(ABNF)[product-version]] に [[quoted-string]] を使った例: [CODE[User-Agent: FooNews/"1.0(Beta1)"]]
- [28] [CODE(ABNF)[encoded-word]] を [CODE(ABNF)[comment]] 中に使った例: [CODE[User-Agent: "Bar@"/1.2 (=?us-ascii?q?Micro=24oft_Windoze_XP?= ; i686)]]
- [31] [WEAK[2002-12-25 18:08]] ''>>17'': まだ関係する記事を全部読んでないんですが、どうも電子メイルに gatewaying する時に [CODE(ABNF)[product]] の部分が UTF-8 だったらどうするのかが問題になって、 [[encoded-word]] にするのは鬱だし、いっそのことやめちまえになったっぽいです。'''ま た e n c o d e d - w o r d か !'''

** Client-Specific Web Services by Using User Agent Attributes 

[40] UA: にクライアント情報を一杯詰め込んじまおうという
'''Client-Specific Web Services by Using User Agent Attributes''' <http://www.w3.org/TR/NOTE-agent-attributes> W3C NOTE 12-30-1997。
仕様考えた会社位しか実装例が無いらしい(w)。

- [41] User-Agent: AVE-Front/2.0 (BrowserInfo Screen=640x480x256; InputMethod=REMOCON,KEYBOARD; Page=512K; Product=XXXX/Internet-TV; HTML-Level=3.2; Language=ja.JIS; Category=TV; CPU=SH2; Storage=NO;) 

[42] 一応 [[BNF]] とかでちゃんと定義してある。

= Prop_def = "(" "BrowserInfo" Prop_items ")"
= Prop_items = Prop_item | Prop_items Prop_item 
= Prop_item = Prop_name "=" Prop_value ";"
= Prop_name = STRING
= Prop_value = STRING 

> The upper case and lower case in describing Prop_name and Prop_value 
> have to be discriminated. 

= Prop_name  = "Screen" | "InputMethod" | "Page" | "Product" | "HTML-Level" | "Language" | "Category" | "CPU" | "Storage"  

"Screen", "InputMethod", "Page", "Product", "HTML-Level" は強く推奨らしいぞ。

"Screen" の値: width (pixels) "x" height (pixels) "x" colors (colors
は 2, 4, 8, 16, 32, 64, 128, 256, 32K, 64K, 16M のどれか)

"InputMethod" の値: PEN, KEYBOARD, MOUSE, REMOCON, BUTTON, JOG, ... 
のどれか(複数可)を、読点区切り。 (例では読点の後に SP が。)

以下説明略。面倒だ:-)  理解する側の実装は (まじめにしよーとすると)
面倒だと思うぞ。値の定義がいい加減だ。

ところで [[HTML]] 1.1 ってなに?

* 例

** RFC 2616 に適合する例

- User-Agent: CERN-LineMode/2.15 libwww/2.17b3
- User-Agent: tin/1.2-PL2
- User-Agent: tin/1.3-950621beta-PL0 (Unix)
- User-Agent: tin/unoff-1.3-BETA-970813 (UNIX) (Linux/2.0.30 (i486))
- User-Agent: tin/pre-1.4-971106 (UNIX) (Linux/2.0.30 (i486))
- User-Agent: Mozilla/4.02b7 (X11; I; en; HP-UX B.10.20 9000/712)
- User-Agent: Microsoft-Internet-News/4.70.1161
- User-Agent: Gnus/5.4.64 XEmacs/20.3beta17 ("Bucharest")
- User-Agent: Pluto/1.05h (RISC-OS/3.1) NewsHound/1.30
- User-Agent: inn/1.7.2
- User-Agent: telnet
- User-Agent: T-gnus/6.14.4 (based on Gnus v5.8.7) (revision 01) REMI/1.14.1 (=?ISO-8859-4?Q?Mushigawa=F2sugi?=) Chao/1.14.1 (=?ISO-8859-4?Q?Rokujiz?= =?ISO-8859-4?Q?=F2?=) APEL/10.2 MULE XEmacs/21.2 (beta33) (Melpomene) (i686-pc-linux)
[[#form:'%text (id => field-body, label => {User-Agent: }, size => 20); (%text(id => name, label => {UA ソフトウェア名}, size => 20);; %text(id => comment, label => {備考}, size => 20);) %submit (label => {追加});':'-[%index;] [CODE(HTTP)[User-Agent: %text (source => field-body);]] %text (source => name, prefix => {(}, suffix => {)});%text (source => comment, prefix => { ※});']]

** USEFOR draft に適合する例

- HTTP に適合するものは、 usefor にも適合します。
- User-Agent: "秀丸エディタ"/3.0 "Microsoft(R) Windows(R) Millenium Edition" (Windows Me)
- [49] User-Agent: "西瓜割"/1.5 Message-pm/1.23
[[#form:'%text (id => field-body, label => {User-Agent: }, size => 20); (%text(id => name, label => {UA ソフトウェア名}, size => 20);; %text(id => comment, label => {備考}, size => 20);) %submit (label => {追加});':'-[%index;] [CODE(HTTP)[User-Agent: %text (source => field-body);]] %text (source => name, prefix => {(}, suffix => {)});%text (source => comment, prefix => { ※});']]


** 間違った例とこれへの対処について

- [1]User-Agent: Mozilla/4.7 [ja]C-{C-UDP; EBM-SONY2}
- [2]User-Agent: DoCoMo/1.0/N503i/c10
- [3]User-Agent: H-Hash@StudyingHTTP.NET
- [4]User-Agent: HttpGet/1.0(Win32; GUI; ix86)
- [5]User-Agent: ネットスケープ 2.0
[[#form:'%text (id => field-body, label => {User-Agent: }, size => 20); (%text(id => name, label => {UA ソフトウェア名}, size => 20);; %text(id => comment, label => {備考}, size => 20);) %submit (label => {追加});':'-[%index;] [CODE(HTTP)[User-Agent: %text (source => field-body);]] %text (source => name, prefix => {(}, suffix => {)});%text (source => comment, prefix => { ※});']]

[34] 間違った例でもそれなりに使われている以上、対応する必要もあるでしょう。
(でも頭が痛いなあ。)

[6] >>1 は、 [ja] 以降の部分で []{}; を使うのを止めるか、全体を
comment にしてしまうべきものでしょう。 usefor 的には {} は
OK なんですが。あるいは全体を quoted-string にするとか。
読む側としては、不正だから無視するのが一番楽。
どうしても読むなら、 http-token の代わりに *<"/" を除く CHAR>
を使うとか。それでも後半が2部分に分かれますが。

[7] >>2 は、 N503i 以降を comment にするか、区切りを "/" じゃなくて "-"
にするとかすべきだったと。読む実装側は・・・悩ましい。

[8] >>3 は、 usefor なら quoted-string にしておくとか。 HTTP では無理だねえ。
(こんなところにメイルアドレスなんて入れるなよ。)
読む側は 1 と同じ対処かな。

[9] >>4 は、 comment の前に SP 入れなさい、って話。 HTTP では必須らしいけど、
usefor 的には無くても OK だねぇ。互換性のために入れた方がいいと
思うけど。読む側は無くても解釈できるのが望ましかろう。

[10] >>5 は、実際、生 [[ISO-2022-JP]] (ならまだ良い。) とか 
[[EUC-JP]] とか
[[シフトJIS]] とか入れる人が少なくないらし。御丁寧にも 
[[encoded-word]]
使う人とかもいるらしいねえ。 なんにせよ、 http-token 以外の文字を
使う時は、 quoted-string にしましょ。 (但し usefor only.)

古い版の MacIE は、日本語版では「ネットスケープ 2.0」とかほざくらしい。
シフト JIS でね。英語版では 「Mozilla/2.0」だったと思われ。藁。

[35] <http://www.dais.is.tohoku.ac.jp/logs/agentgripes.html> からめぼしい(謎)もの。
(適当に上の方から。)

- [11]User-Agent: A.G.E.N.T. http://masui.net/agent/libwww-perl/5.44
- [12]User-Agent: Acoon Robot v1.50.001 (www.acoon.de)

[13] >>11 URI 生書きいや〜ん。 >>12 構文としては問題ないけど''名前/版''形式きぼんぬ。

- [51] どうせ規格に違反するなら、 >>44 の usefor の改良された方法で [[quoted-string]] を使うようにしていった方が、見よう見まねの実装で正しい値を使うようになるんじゃないかと思います。(甘いかな。) ですから新しい実装は、 >>44 の usefor の形式に合致する値を出力するのが望ましいと考えられます。
- [52] >>51 の考え方からすれば、現実的に表現力が小さいだけで何の役にも立っていない今の HTTP の書式を無理に使うよりは、 >>44 の usefor のより自由な方式に (現状では HTTP RFC と一致しなくても) 切り替えていった方が良いかもしれません。
- [53] >>10 HTTP/1.0 ([[RFC1945]]) では、 [CODE(ABNF)[%x80-FF]] は [[ISO-8859-1]] と解釈しても'''良い'''のであって強制ではありませんから、'''注釈の中なら'''シフト JIS を入れたり日本語 EUC を入れたり Big5 を入れたりしても問題ありませんね。して欲しくないけど。更に注釈外の生書きはもちろん駄目だけど。
- [54] >>53 また、 [[encoded-word]] を使う場合も注釈内なら構いませんが、注釈外はいけませんね。 (HTTP の場合)
- [55] 但し、 >>44- のように電子ニュースの手法を使って勝手に拡張してしまうなら、 [SAMP["=?us-ascii?q?A_Sample_User_Agent?= (ASUA)"/"2.45 =?us-ascii?q?=28Lilly=29?="]] みたいなのもありだと思います。 ([[MIME]] 的には [[quoted-string]] の中に [CODE(ABNF)[encoded-word]] を入れるのはよくないんだけど、 HTTP 的にはあまり気にしない。)
- [56] もちろん、 >>55 の例は例であって、 US-ASCII だけの文字列を [CODE(ABNF)[encoded-word]] にするなんてばかげたことは (普通は) しないで下さい、念のため。

** 色々な実装における値の付け方

- [20] Mozilla での UA 名の指針
-- [14] '''user-agent string'''
--- <http://www.mozilla.org/build/revised-user-agent-strings.html> (原文)
--- <http://jt.mozilla.gr.jp/build/revised-user-agent-strings.html> (和訳)
- [21] ''J-Sky Web/技術資料 ユーザーエージェントについて''
<http://www.dp.j-phone.com/jsky/user.html>
- [22] ''iモード対応HTMLの考え方'' <http://www.nttdocomo.co.jp/mc-user/i/tag/s2.html>
- [23] ''NTT東日本:Lモード'' <http://www.ntt-east.co.jp/Lmode/06_contents/02_tsukuri.html> から入手できる技術条件説明書 <http://www.ntt-east.co.jp/Lmode/06_contents/pdf/cp_gijutsu2_2.exe>
- [24] [[Monazilla]] <http://members.jcom.home.ne.jp/monazilla/document/oyster_subjecttxt.html>
- [25] [[DOLIB]] 1.00 <http://kage.monazilla.org/system_DOLIB100.html>
- [60] [[au]]] ''技術情報'' <http://www.au.kddi.com/ezfactory/tec/spec/4_4.html>

[64]
[CITE[端末属性通知プロトコルの標準提案]] ([TIME[2002-09-05 20:59:22 +09:00]] 版) <http://www.mcf.to/eia/news/0909protocol.html>

* 実際に使われている値の収集

- [19] [[HTTPのUserAgentの一覧]]
- [43] '''Some Gripes on User-Agent'''
<http://www.dais.is.tohoku.ac.jp/logs/agentgripes.html> [[UA]] の実例が一杯。

[63]
[CITE@en[The ELinks Manual]] ([[Petr Baudis, Jonas Fonseca Madsen, Miciah Dashiel Butler Masters]] 著, [CODE[2007-03-18 16:03:15 +09:00]] 版) <http://elinks.or.cz/documentation/manual.html#useragent>

* 利用者エージェント名詐称問題

[36]
⇒[[MozillaとcompatibleなUAとは?]]を参照。


* User-Agent: 欄の値による処理の分岐

[50] 実際のところ、規格違反の文字列を使う例や詐称により実際の情報が注釈内に押し込まれている例が多すぎることから、仕様に基づいた parser を作って前半(名前)・後半(版)を見て処理を云々というのは現実的でなく、そうした処理をする多くの実装 ([[CGI]] script やサーバーなど。) は[[正規表現]]を使って処理しています。確かにこれが最も現実的な方法でしょう。

[57] ''ブラウザ判別では"Gecko"を調べてください - Web標準普及プロジェクト'' <http://www.mozilla.gr.jp/standards/webtips1005.html>

[58] [[RFC2936]] HTTP MIME 型取扱器判別

* セキュリティー

[15] Security や privacy を理由に、 UA: 欄や 
[[Server]]が送られることに懸念を示す人がいます。

確かに個々の場合において問題が発生する可能性はあるでしょう。
(例えば UA: 欄に特定の文字列が入っていたら攻撃する人がいるとか。)

しかし一般論として、例えばこれらの情報を送らないことで安全性が向上するということはありません。

[16] >>15 わざわざソースから削って出力させなくするような人もいるらしいですが、安全性の向上を狙っているならはっきり言って無駄なことです。

[30] [[RFC 7231]] はソフトウェアの情報を示すことによって既知の[[セキュリティーホール]]を攻撃される危険性があるとしつつも、
実際にはソフトウェアの版に関わらず攻撃される虞があることをも指摘しています
[SRC[>>29]]。

* 関連

[93] [CODE(HTTP)@en[[[User-Agent:]]]] には、 [[DOM]] [[API]]
[CODE(JS)@en[[[navigator.userAgent]]]] からもアクセスできます。

[62]
[CODE(822)[User-Agent:]] 欄があるプロトコル:
- [[RFC 822]] 系[[電子メイル]]・[[電子ニュース]]
- [[HTTP]]
- [[RTSP]]
- [[SIP]]

[CODE(822)[User-Agent:]] 欄に関係するプロトコル要素:
- [CODE(CGI)[[[HTTP_USER_AGENT]]]] [[メタ変数]] ([[CGI]])
- [CODE(CGI)[[[SIP_USER_AGENT]]]] [[メタ変数]] ([[SIP CGI]])
- [CODE(JS)[[[navigator]]]] 物体 ([[DOM水準0]])
- [CODE(HTTP)[[[Server]]:]] 欄 ([[HTTP]], [[RTSP]], [[SIP]])

* メモ

[65] [CITE[UserAgent - iPhone 3G DevWiki]]
(Referenced: [TIME[2009-08-25T18:40:39+09:00]])
<http://wiki.sohaya.com/index.php/UserAgent>

[66] [CITE[IRC logs: freenode / #whatwg / 20100617]]
([TIME[2010-06-27 14:30:04 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20100617#l-752>

[67] [CITE[IRC logs: freenode / #whatwg / 20100913]]
( ([TIME[2010-09-26 22:31:37 +09:00]] 版))
<http://krijnhoetmer.nl/irc-logs/whatwg/20100913>

[68] [CITE[Chrome 11 におけるユーザーエージェント文字列の変更 - Google Japan Developer Relations Blog]]
( ([TIME[2011-06-07 20:00:25 +09:00]] 版))
<http://googledevjp.blogspot.com/2011/06/chrome-11.html>

[69] [CITE[Bug 690287 – Tracking bug for UA sniffers failing to handle a two-digit version]]
( ([TIME[2011-10-04 08:13:27 +09:00]] 版))
<https://bugzilla.mozilla.org/show_bug.cgi?id=690287>

[70] [CITE[Request Headers in the HTTP protocol]]
( ([TIME[2001-11-29 11:01:38 +09:00]] 版))
<http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html#user-agent>

[71] [CITE@en[Gecko user agent string reference - MDN]]
( ([TIME[2012-07-06 00:45:55 +09:00]] 版))
<https://developer.mozilla.org/en/Gecko_user_agent_string_reference>

[72] [CITE@en[Chrome for Android User-Agent - Google Chrome Mobile — Google Developers]]
( ([TIME[2012-06-28 19:56:53 +09:00]] 版))
<https://developers.google.com/chrome/mobile/docs/user-agent>

[73] [CITE@en[IE10 のユーザー エージェント文字列が更新されました - IEBlog 日本語 - Site Home - MSDN Blogs]]
( ([TIME[2012-07-17 03:51:15 +09:00]] 版))
<http://blogs.msdn.com/b/ie_ja/archive/2012/07/16/ie10-user-agent-string-update.aspx>

[74] [CITE[OperaのUAは以後ずっとOpera/9.80になります - by edvakf in hatena]]
( ([TIME[2012-07-17 03:56:00 +09:00]] 版))
<http://d.hatena.ne.jp/edvakf/20090527/1243449333>

[75] [CITE@en[Changes in Opera’s user agent string format - Dev.Opera]]
( ([TIME[2012-07-17 03:56:23 +09:00]] 版))
<http://dev.opera.com/articles/view/opera-ua-string-changes/>

[76] [CITE@ja[Google ウェブマスター向け公式ブログ: スマートフォン版 Googlebot-Mobile の導入について]]
( ([TIME[2012-07-18 14:36:02 +09:00]] 版))
<http://googlewebmastercentral-ja.blogspot.jp/2011/12/googlebot-mobile.html>

[77] [CITE@en[draft-karcz-uuas-00 - Unified User-Agent String (UUAS)]]
( ([TIME[2012-04-30 13:21:14 +09:00]] 版))
<http://tools.ietf.org/html/draft-karcz-uuas-00>

[78] [CITE@en-US-x-hixie[HTML Standard]]
( ([TIME[2012-07-26 07:21:45 +09:00]] 版))
<http://www.whatwg.org/specs/web-apps/current-work/#client-identification>

[79] [CITE@en[Chrome for Android User-Agent - Google Chrome Mobile — Google Developers]]
( ([TIME[2012-06-28 19:56:53 +09:00]] 版))
<https://developers.google.com/chrome/mobile/docs/user-agent>

[80] ( ([TIME[2012-11-09 12:46:44 +09:00]] 版))
<http://www.etsi.org/deliver/etsi_ts/102700_102799/102796/01.02.01_60/ts_102796v010201p.pdf>

[81] [CITE@en-US[Gecko user agent string reference - HTTP | MDN]]
( ([TIME[2014-06-16 13:25:45 +09:00]] 版))
<https://developer.mozilla.org/en-US/docs/Web/HTTP/Gecko_user_agent_string_reference>

[94] [CITE@en[Re: History of device independence, User-Agent header?]]
( ([[Sean B. Palmer]] 著, [TIME[2014-07-15 04:42:58 +09:00]] 版))
<http://lists.w3.org/Archives/Public/public-webhistory/2014Jul/0001.html>

[95] [CITE@en[RFC 3507 - Internet Content Adaptation Protocol (ICAP)]]
( ([TIME[2014-06-08 07:17:07 +09:00]] 版))
<http://tools.ietf.org/html/rfc3507#page-14>

[96] [CITE@en[''''''[''''''whatwg'''''']'''''' Controlling the User-Agent header from script]]
( ([[Anne van Kesteren]] 著, [TIME[2014-10-13 22:53:20 +09:00]] 版))
<http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Oct/0151.html>

[97] [CITE[The Platform for Privacy Preferences 1.0 (P3P1.0) Specification]]
( ([TIME[2002-04-16 22:03:48 +09:00]] 版))
<http://www.w3.org/TR/P3P/#other_http_info>

[98] [CITE@en[RFC 5536 - Netnews Article Format]]
( ([TIME[2014-09-21 18:14:06 +09:00]] 版))
<http://tools.ietf.org/html/rfc5536#section-3.2.13>

[38] [CITE@en[RFC 5965 - An Extensible Format for Email Feedback Reports]]
([TIME[2014-12-21 09:40:25 +09:00]] 版)
<http://tools.ietf.org/html/rfc5965#section-3.1>

[39] >>38 は [[RFC 2616]] を引用して [CODE(MIME)@en[[[message/feedback-report]]]]
における [CODE[[[User-Agent:]]]] を規定していますが、ここでは構文上の[[空白]]が
[[CFWS]] に置き換えられています。 [CODE(ABNF)@en[[[comment]]]] を値の先頭に置くことができます。


[FIG(quote)[
[FIGCAPTION[
[99] [CITE[HbbTV 2.0 Specification (2015-02-02)]]
([TIME[2015-02-10 01:01:20 +09:00]] 版)
<http://www.hbbtv.org/pages/about_hbbtv/HbbTV_specification_2_0.pdf#page=60>
]FIGCAPTION]

> The User-Agent header shall include:
> HbbTV/1.3.1 (<capabilities>; [<vendorName>]; [<modelName>]; [<softwareVersion>];
> [<hardwareVersion>]; <reserved>) 

]FIG]


[FIG(quote)[
[FIGCAPTION[
[100] [CITE[Connecting to a streaming endpoint | Twitter Developers]]
([TIME[2015-03-05 11:50:39 +09:00]] 版)
<https://dev.twitter.com/streaming/overview/connecting>
]FIGCAPTION]

> If your environment precludes setting the User-Agent field, then set an X-User-Agent header.

]FIG]


[101] [CITE@en[`user-agent` header control · Issue #37 · whatwg/fetch]]
([TIME[2015-04-06 11:34:07 +09:00]] 版)
<https://github.com/whatwg/fetch/issues/37>

[102] [CITE@en[Re: user-agent header control]]
([[Anne van Kesteren]] 著, [TIME[2015-04-06 04:12:09 +09:00]] 版)
<https://lists.w3.org/Archives/Public/public-webapps/2015AprJun/0043.html>

[FIG(quote)[
[FIGCAPTION[
[104] [CITE@en[Pipelight - ArchWiki]]
([TIME[2015-07-11 13:26:59 +09:00]] 版)
<https://wiki.archlinux.org/index.php/Pipelight>
]FIGCAPTION]

>  If you are here because you want to watch BlinkBox (UK) you need to install google-chromeAUR (Requires: version 42+) and use the User-Agent Switcher for Chrome extension with a Mac UA string 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36'. Windows UA strings will result in WP209 playback errors due to HDCP.

]FIG]


[105] [CITE@en[Allow User-Agent to be set, but not omitted. Also group all the heade… · whatwg/fetch@dab09b0]]
([TIME[2015-07-30 14:22:21 +09:00]] 版)
<https://github.com/whatwg/fetch/commit/dab09b0c483c46324082df1e54b29ed4c9c02162>

[FIG(quote)[
[FIGCAPTION[
[115] [CITE@en[HTTPS and Keep-Alive Connections - IEInternals - Site Home - MSDN Blogs]]
([TIME[2015-08-16 15:36:27 +09:00]] 版)
<http://blogs.msdn.com/b/ieinternals/archive/2011/03/26/https-and-connection-close-is-your-apache-modssl-server-configuration-set-to-slow.aspx>
]FIGCAPTION]

> In the expression above, any IE version that starts with “1” will be treated as outdated and served connection slowly without Keep-Alive. Internet Explorer 1.0 didn’t even support SSL at all (SSL was added in 2.0), but worse, this loosely-written regular expression will also match future MSIE 10.0, MSIE 11.0, MSIE 12.0 (etc) user-agent strings. Hence, Apache hosts will one day find that the newest browsers are forced into the “slow” lane!

]FIG]


[FIG(quote)[
[FIGCAPTION[
[116] [CITE[iPhoneのアプリ内WebViewのUAまとめ(2015/12/15時点)とjsでの判定方法 - Qiita]]
([TIME[2016-03-07 00:18:01 +09:00]] 版)
<https://qiita.com/nabettu/items/e481412c4ca0f50e7fb5>
]FIGCAPTION]

> FacebookアプリWebView
> Mozilla/5.0 (iPhone; CPU iPhone OS 9_2 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13C75 '''['''FBAN/FBIOS;FBAV/45.0.0.45.96;FBBV/18289579;FBDV/iPhone7,2;FBMD/iPhone;FBSN/iPhone OS;FBSV/9.2;FBSS/2; FBCR/ドコモ;FBID/phone;FBLC/ja_JP;FBOP/5''']'''

]FIG]


[117] [CITE@en[Introduce default `User-Agent` value for usage by HTML · whatwg/fetch@d9a8ac1]]
([TIME[2016-03-09 15:25:13 +09:00]] 版)
<https://github.com/whatwg/fetch/commit/d9a8ac12a33ab6a35826179dc3e8d88d4e06c66d>

[118] [CITE@en[Let Fetch define the default User-Agent value · whatwg/html@026aa96]]
([TIME[2016-03-09 15:25:41 +09:00]] 版)
<https://github.com/whatwg/html/commit/026aa966c944ce0f1180bc906646c00a3f7ebcbb>

[FIG(quote)[
[FIGCAPTION[
[121] [CITE[Acceptヘッダで判別するサーバーサイドのSVGフォールバック - 聴く耳を持たない(片方しか)]]
([TIME[2016-02-24 18:25:24 +09:00]] 版)
<http://d.hatena.ne.jp/rikuo/20151017>
]FIGCAPTION]

> 古いAndroid向けのブラウザアプリ、フィーチャーフォン向けのjig browser、さらにはNew 3DSにもUserAgent文字列を変更できる機能がついています。

]FIG]


[FIG(quote)[
[FIGCAPTION[
[122] [CITE@en[Define that "TV" should appear as token for UA-string when presentation API is used to render on TV · Issue #303 · w3c/presentation-api]]
( ([TIME[2016-05-27 10:58:00 +09:00]]))
<https://github.com/w3c/presentation-api/issues/303>
]FIGCAPTION]

> Mozilla's experience is that the few websites that today target TVs require that a "TV" token is included in the UA string in order for the website to render an appropriate TV UI.
> I think this is something that's worth getting into a specification as quickly as we can, in order to prevent the mess that we currently have on mobile. The problem on mobile was that originally there was no token to indicate "mobile device", which lead to websites solving the problem with perpetually out-of-date databases, harder for new players to enter the space, etc.

]FIG]


[123] [CITE@en[Issue 310456 - chromium - FTP not working behind Authenticating HTTP Proxy using NTLM (Forefront TMG) - Monorail]]
( ([TIME[2016-06-11 12:48:19 +09:00]]))
<https://bugs.chromium.org/p/chromium/issues/detail?id=310456#c18>

[FIG(quote)[
[FIGCAPTION[
[124] [CITE[ARIB TR-B39]]
([TIME[2016-07-25 17:01:00 +09:00]])
<http://www.arib.or.jp/english/html/overview/doc/4-TR-B39v1_0-1p4.pdf#page=309>
]FIGCAPTION]

> HTML ブラウザは、User-Agent ヘッダを図 10-7 に示す書式に合わせて HTTP リクエストのヘ
> ッダに含めて送信しなければならない。
> User-Agent: <others> <SystemName>/1.0
> (<Capability>;<MakerId>;<ModelId>;<MajorVer>;<MinorVer>;
> <reserved>) <others>
> 図 10-7 User-Agent ヘッダ
> <SystemName> : "A-PAB"
> < Capability > : 受信機の能力を表す。
> カンマ(",")区切りで受信機の能力を表す文字列を列挙するものとし、先頭から順に、ブラウザ
> 表示解像度、ビデオ再生解像度を表現する。それ以降の項目については将来の規定項目とする。
> <Capability>=browser_resolution","video_resolution[","reserved]
> browser_resolution="2K"|"4K"|"8K"
> video_resolution="2K"|"4K"|"8K"
> browser_resolution はブラウザで表示可能な最大のコンテンツの解像度を示し、
> video_resolution は video 要素によって再生可能な最大の解像度を示す。それぞれ
> "2K","4K","8K"のいづれかが記述される。記述がない場合は"2K"と見なす。なお、"4K"に
> 対応するものは"2K"にも対応し、"8K"に対応するものは"4K"および"2K"にも対応するもの
> とする。
> <MakerId>:製造メーカーの識別を示す。
> MakerId は 6 桁の文字列で、IEEE 規定の 24bit のカンパニーID(OUI)を base16 の文字列
> で表したものとする。メーカーに対して OUI は複数存在する可能性があるが、そのうち特定
> の1種類を MakerId として使用すること。
> < ModelId >:機種を示すコードであり、10 文字までの文字列である。運用は各メーカーに任され
> る。
> <MajorVer><MinorVer>: 端末のバージョン情報を示し、共に 8 文字までの文字列とする。
> ModelId が同一で、動作が異なる端末には、異なるバージョンを付する。運用は各メーカーに
> 任される。
> <reserved>:将来の拡張のための領域
> <others>: メーカーが自由に使える領域。ただし、本規定の識別子と区別するため、
> <SystemName>で文字列が始まらない必要がある。なお、使用する文字列は RFC 7231 に従
> うものとする。 
> 

]FIG]
