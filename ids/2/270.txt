[1] [[HTTP]] の [DFN[[CODE(HTTP)@en[Digest]] [[一般頭欄]]]]は、その[[メッセージ]]によって記述される[[実現値]]の[RUBYB[[[要約]]]@en[digest]]を表します。

;; [6] [[auth-scheme]] の [[Digest]] ([[Digest認証]]) とは関係ありません。

* 仕様書

[REFS[
- [10] [CITE@en[RFC 3230 - Instance Digests in HTTP]] ([TIME[2014-08-31 18:57:37 +09:00]] 版) <http://tools.ietf.org/html/rfc3230#section-4.2>
]REFS]

* 構文

[4] [CODE(HTTP)@en[[[Digest:]]]] には、名前と値の組を [CODE(HTTP)[[[,]]]]
で区切って複数指定できます。それぞれ、名前と指定された[[算法]]に基づく[[要約]]が値、
という形になっています。

[11] [DFN[[RUBYB[実現値ダイジェスト]@en[instance digest]]]]は、
[[ダイジェストアルゴリズム]]と [CODE(HTTP)[[[=]]]]、
[[ダイジェストアルゴリズム]]の出力によって構成されます [SRC[>>10]]。

[FIG(railroad)[
= [[ダイジェストアルゴリズム]]
= [CODE(HTTP)[[[=]]]]
= アルゴリズムの出力
]FIG]

;; [16] [CODE(HTTP)[[[=]]]] の前後に[[空白]]を挿入できるかは定かではありません。
[[仕様書]]中の例示はすべて[[空白]]を含んでいません。

[12] アルゴリズムの出力は、[[メッセージ]]に関連付けられた[[実現値]]全体について計算したものです [SRC[>>10]]。

;; [[実現値]]は、[[実現値操作]]の適用前のものです。[[差分符号化]]や[[範囲]]指定を行う前の状態であって、必ずしも[[メッセージ本体]]として含まれるものとは限りません。

* 歴史

[FIG(quote)[
[FIGCAPTION[
[7] RFC 3230 (実現値要約) 4.3.2 Digest
]FIGCAPTION]

> The Digest message header field provides a message digest of the
instance described by the message.

[CODE(HTTP)[Digest]] [[メッセージ頭欄]]は、
その[[メッセージ]]が記述する[[実現値]]のメッセージ[[要約]]を提供します。

>
- Digest = "Digest" ":" #(instance-digest)

> The instance described by a message might be fully contained in the
message-body, partially-contained in the message-body, or not at all
contained in the message-body.  The instance is specified by the
Request-URI and any cache-validator contained in the message.

メッセージが記述する実現値は [CODE(ABNF)[[[message-body]]]]
に完全に含まれているかもしれませんし。 [CODE(ABNF)[message-body]]
に部分的に含まれているかもしれませんし、
[CODE(ABNF)[message-body]] に全く含まれていないかもしれません。
実現値は [CODE(ABNF)[[[Request-URI]]]] とメッセージに含まれる任意の
[CODE(ABNF)[[[cache-validator]]]] ([[キャッシュ検証子]]) によって指定されます。

> A Digest header field MAY contain multiple instance-digest values.
This could be useful for responses expected to reside in caches
shared by users with different browsers, for example.

[CODE(HTTP)[Digest]] 頭欄は、複数の [CODE(ABNF)[instance-digest]]
値を含んで'''構いません'''。これは、たとえば異なる[[ブラウザ]]の利用者間で[[キャッシュ]]を共有していると存じていると思われるような応答に有用でしょう。

> A recipient MAY ignore any or all of the instance-digests in a Digest
header field.

受信者は [CODE(HTTP)[Digest]] 頭欄の [CODE(ABNF)[instance-digest]]
の一部または全部を無視して'''構いません'''。

> A sender MAY send an instance-digest using a digest-algorithm without
knowing whether the recipient supports the digest-algorithm, or even
knowing that the recipient will ignore it.

送信者は、受信者がある [CODE(ABNF)[digest-algorithm]]
に対応しているかどうか知らない場合や、あるいは受信者がこれを無視することをしっていた場合ですら、
その [CODE(ABNF)[digest-algorithm]] を使った [CODE(ABNF)[instance-digest]]
を送信して'''構いません'''。

> Examples:
- Digest: md5=HUXZLQLMuI/KZ5KDcJPcOA==
- Digest: SHA=thvDyvhfIqlvFe+A9MYgxAfm1q5=,unixsum=30637
]FIG]

[22] [CITE@en[RFC 3229 - Delta encoding in HTTP]]
( ([TIME[2014-10-26 21:15:25 +09:00]] 版))
<http://tools.ietf.org/html/rfc3229#section-9>

[9] [[RFC 4229]] は[[IANA登録簿]]に状態「[[標準]]」で登録しています [SRC[>>8]]。

[REFS[
- [8] [CITE@en[RFC 4229 - HTTP Header Field Registrations]] ([TIME[2014-11-02 18:53:20 +09:00]] 版) <http://tools.ietf.org/html/rfc4229#section-2.1.44>
]REFS]

* 例

[5] 次のような[[実現値ダイジェスト]]の例があります [SRC[>>10]]。
[FIG(list)[
- [13] [CODE(HTTP)[MD5=HUXZLQLMuI/KZ5KDcJPcOA==]]
- [14] [CODE(HTTP)[sha=thvDyvhfIqlvFe+A9MYgxAfm1q5=]]
- [15] [CODE(HTTP)[UNIXsum=30637]]
]FIG]

[3] [SRC[[[RFC 5843]] 1.1.]]
[PRE(HTTP example code)[
Digest: SHA-256=MWVkMWQxYTRiMzk5MDQ0MzI3NGU5NDEyZTk5OWY1ZGFmNzgyZTJlODYzYjRjYzFhOTlmNTQwYzI2M2QwM2U2MQ==
]PRE]

* 関連

[2] [[MD5]] を使った[[要約]]を入れる[[頭欄]]として [CODE(HTTP)@en[[[Content-MD5]]]]
があり、[[MIME]] や [[HTTP]] で用いられています。 [CODE(HTTP)@en[[[Digest]]]]
はこれをより一般化したものです。

[17] [CODE(HTTP)@en[[[Content-MD5:]]]] の他、[[ダイジェスト認証]]でも[[ダイジェスト値]]を使いますが、
これらは [[payload body]] に関するものです。それに対して [CODE(HTTP)@en[[[Digest:]]]]
は[[実現値]]に関するものです。