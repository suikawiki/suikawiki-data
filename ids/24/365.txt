* 仕様書

[REFS[
- [1] [CITE@en[RFC 7540 - Hypertext Transfer Protocol Version 2 (HTTP/2)]] ([TIME[2015-05-15 10:14:54 +09:00]] 版) <https://tools.ietf.org/html/rfc7540#section-6.8>
]REFS]

* 意味

[2] [CODE[[[GOAWAY]]]] [[フレーム]] ([[フレーム型]] [CODE[[[0x7]]]])
は、[[接続]]の[RUBYB[遮断]@en[shutdown]]をはじめたり、
[RUBYB[誤り条件]@en[error condition]]を通知したりするものです [SRC[>>1]]。

[3] [CODE[[[GOAWAY]]]] を使って、[[エンドポイント]]は既存の[[ストリーム]]の処理は続けつつ、
新しい[[ストリーム]]の受付は中止し、[RUBYB[華麗]@en[graceful]]に停止することができます [SRC[>>1]]。

;; [4] [[サーバー]]のメンテナンスなど管理操作に有用です [SRC[>>1]]。

[5] [CODE[[[GOAWAY]]]] [[フレーム]]の送信と [[peer]] の新しい[[ストリーム]]の開始には[[競合条件]]がありますから、
[CODE[[[GOAWAY]]]] [[フレーム]]には [[peer]] が開始した (上で[[送信者]]が処理した、またはしたかもしれない)
最後 (最大) の[[ストリーム]]の[[ストリーム識別子]]を指定します。
[[送信者]]は、[CODE[[[GOAWAY]]]] [[フレーム]]の送信以後、
その[[ストリーム識別子]]よりも大きな[[ストリーム識別子]]の[[フレーム]]を無視します。 [SRC[>>1]]

* 文脈

[9] [[エンドポイント]]は、[[接続]]を閉じる前に [CODE[[[GOAWAY]]]]
[[フレーム]]を送信する[['''べきです''']] [SRC[>>1]]。

;; [10] おかしな動作の [[peer]] に対しては、 [CODE[[[GOAWAY]]]]
[[フレーム]]を送らずに[[接続]]を閉じても構いません [SRC[>>1]]。

* 処理

[8] [CODE[[[GOAWAY]]]] [[フレーム]]の[[受信者]]は、
示された[[ストリーム識別子]]より大きな[[ストリーム識別子]]の[[ストリーム]]は最初から作られなかったものとして扱うことができます。 [SRC[>>1]]

[6] [CODE[[[GOAWAY]]]] [[フレーム]]の[[受信者]]は、新しい[[ストリーム]]を開いては[['''なりません''']]。 [SRC[>>1]]

;; [7] 新しい[[接続]]を確立して新しい[[ストリーム]]を開始しても構いません [SRC[>>1]]。
