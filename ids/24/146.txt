[4] [[TLS Handshake Protocol]] の [DFN[[CODE[[[CertificateRequest]]]]]]
[[メッセージ]]は、[[サーバー]]が[[クライアント]]に[[クライアント証明書]]を送信することを要求するものです。

* 仕様書

[REFS[
- [1] '''[CITE@en[RFC 5246 - The Transport Layer Security (TLS) Protocol Version 1.2]] ([TIME[2015-03-25 03:49:56 +09:00]] 版) <https://tools.ietf.org/html/rfc5246#section-7.4.4>'''
- [6] [CITE[RFC Errata Report]] ([TIME[2015-04-18 16:06:26 +09:00]] 版) <http://www.rfc-editor.org/errata_search.php?rfc=5246>
]REFS]

* 構文

[5] [CODE[[[CertificateRequest]]]] は、次の欄で構成されます [SRC[>>1]]。
[FIG(list members)[
:[CODE[[[certificate_types]]]]:1[[バイト]][[以上]]2[SUP[8]]-1[[バイト]][[以下]]の、
[[クライアント]]が利用できる[[クライアント証明書]]の種別を表す値
([CODE[[[ClientCertificateType]]]]) のリストです [SRC[>>1]]。
:[CODE[[[supported_signature_algorithms]]]]:2バイト[[以上]]2[SUP[16]]-2[[バイト]][[以下]]の[[署名アルゴリズム]]を表す値
([CODE[[[SignatureAndHashAlgorithm]]]]) のリストです [SRC[>>1, >>6]]。
:[CODE[[[certificate_authorities]]]]:0[[バイト]][[以上]]2[SUP[16]]-1[[バイト]][[以下]]の [[DN]]
(1[[バイト]][[以上]]2[SUP[16]]-1[[バイト]][[以下]]の列) です [SRC[>>1]]。
]FIG]

* 文脈

[2] [[匿名]]でない[[サーバー]]は、選択した [[cipher suite]] において適切なら、
任意選択で[[クライアント]]に[[証明書]]を要求できます [SRC[>>1]]。

[3] [CODE[[[CertificateRequest]]]] [[メッセージ]]は、
[CODE[[[ServerKeyExchange]]]] [[メッセージ]] (送られない場合には[[サーバー]]からの
[CODE[[[Certificate]]]] [[メッセージ]]) の直後に[[サーバー]]から[[クライアント]]に送信します
[SRC[>>1]]。