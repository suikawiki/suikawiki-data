* 仕様書

[REFS[
- [1] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-04-25 04:40:19 +09:00]] 版) <https://html.spec.whatwg.org/#dom-location-assign>
- [7] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-04-25 04:40:19 +09:00]] 版) <https://html.spec.whatwg.org/#dom-location-replace>
]REFS]

* 処理

[2] [CODE(DOMi)@en[[[Location]]]] [[インターフェイス]]の
[DFN[[CODE(DOMm)@en[[[assign]]]]]] [[メソッド]] [SRC[>>1]]
と [DFN[[CODE(DOMm)@en[[[replace]]]]]] [[メソッド]] [SRC[>>7]]
は、次のようにしなければ[['''なりません''']]。
[FIG(steps)[
= [3] 第1引数を [CODE(IDL)@en[[[DOMString]]]] として解釈します。
= [4] 第1引数を[[入口設定群オブジェクト]]の[[API基底URL]]を[[基底URL]]として[[URLの解決]]を行います。
= [5] [[解決]]が成功しなければ、 [CODE(DOMe)@en[[[SecurityError]]]]
[[例外]]を投げ、ここで停止します。
= [8] [CODE(JS)@en[[[location.replace]]]] [[メソッド]]なら、
== [9] [VAR[置換有効]]を[[真]]に設定します。
= [10] それ以外なら、
== [11] [[文脈オブジェクト]]の[[文書]]の[[閲覧文脈]]の[[セッション履歴]]が[[文書]]を
1つだけ含んでおり、それが[[初期「[CODE(URI)@en[about:blank]]」文書]]なら、
=== [12] [VAR[置換有効]]を[[真]]に設定します。
== [13] それ以外なら、
=== [14] [VAR[置換有効]]を[[偽]]に設定します。
= [6] 次の [[navigate]] を行います。
[FIG(list members)[
:[[navigate]] する[[閲覧文脈]]:[[文脈オブジェクト]]の[[文書]]の[[閲覧文脈]]。
:新しい[[資源]]:[[URL]] は、[[解決]]結果。
:[[例外有効]]:[[真]]。
:[[置換有効]]:[VAR[置換有効]]。
:[[原始閲覧文脈]]:[[現職設定群オブジェクト]]の[[有責閲覧文脈]]。
]FIG]
]FIG]

[15] この処理は、 [CODE(DOMi)@en[[[Location]]]] [[オブジェクト]]における
[CODE(DOMi)@en[[[URLUtils]]]] の [[update steps]] から呼び出されることがあります。

;; [CODE(JS)@en[[[location.href]]]] を参照。

[16] [CITE@en[Clarify the error handling for Location#{assign,replace} · whatwg/html@9cbe9b3]]
([TIME[2015-08-30 09:55:05 +09:00]] 版)
<https://github.com/whatwg/html/commit/9cbe9b33bd969ad0590370ad97a3e282226dfd9c>

[17] [CITE@en[Define security around Window, WindowProxy, and Location properly · whatwg/html@acae3df]]
([TIME[2016-03-13 23:39:57 +09:00]] 版)
<https://github.com/whatwg/html/commit/acae3df652b382e9f4f1d1b4dc7e08e2b00df821>

[18] [CITE@en[Define security around Window, WindowProxy, and Location properly · whatwg/html@acae3df]]
([TIME[2016-03-13 23:40:26 +09:00]] 版)
<https://github.com/whatwg/html/commit/acae3df652b382e9f4f1d1b4dc7e08e2b00df821>