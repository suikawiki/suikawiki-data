
* 仕様書

[REFS[
- [1] [CITE@en[RFC 6455 - The WebSocket Protocol]] ([TIME[2015-03-11 20:42:50 +09:00]] 版) <http://tools.ietf.org/html/rfc6455#section-5>
]REFS]

* 構文

[8] [[フレーム]]は、次のような構造です [SRC[>>1]]。
[FIG(packet)[
:width:32

=1 [[FIN]]
=1 [[RSV1]]
=1 [[RSV2]]
=1 [[RSV3]]
=4 [[opcode]]
=1 [[MASK]]
=23 [[payload length]]
=32 [[masking key]]
=32... [[Payload Data]]
]FIG]

* マスク

[2] [[クライアント]]は、[[サーバー]]に送信するすべての[[フレーム]]を[RUBYB[[[マスク]]]@en[mask]]しなければ[['''なりません''']] [SRC[>>1]]。

;; [3] これは、[[プロキシ]]等の[[中間器]]の混乱を防ぐため、また[[セキュリティー]]のために必要な措置です
[SRC[>>1]]。

[5] [[サーバー]]は、[[クライアント]]に[[マスク]]した[[フレーム]]を送信しては[['''なりません''']]
[SRC[>>1]]。

[4] [[サーバー]]は、[[マスク]]されていない[[フレーム]]を受信したら、
[[接続]]を閉じなければ[['''なりません''']] [SRC[>>1]]。
この場合[[サーバー]]は [CODE(HTTP)@en[[[Close]]]] [[フレーム]]を[[状態符号]]
[CODE(HTTP)[[[1002]]]] で送信して構いません [SRC[>>1]]。

[6] [[クライアント]]は、[[マスク]]された[[フレーム]]を受信したら、
[[接続]]を閉じなければ[['''なりません''']] [SRC[>>1]]。
この場合[[クライアント]]は [CODE(HTTP)@en[[[Close]]]] [[フレーム]]を[[状態符号]]
[CODE(HTTP)[[[1002]]]] で送信して構いません [SRC[>>1]]。

* データフレーム

[7] [[クライアント]]も[[サーバー]]も、[[WebSocket接続の確立]]の後、
[CODE(HTTP)[[[Close]]]] [[フレーム]]を送信するまで、任意の時機に[[データフレーム]]を送信できます
[SRC[>>1]]。
