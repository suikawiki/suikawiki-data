* 仕様書

[REFS[
- [1] [CITE@en[RFC 7540 - Hypertext Transfer Protocol Version 2 (HTTP/2)]] ([TIME[2015-05-15 10:14:54 +09:00]] 版) <https://tools.ietf.org/html/rfc7540#section-5.2>
]REFS]

* 意味

[2] [[ストリーム]]を使って[[多重化]]すると、[[TCP接続]]を過剰に使ってしまい、
[[ストリーム]]がブロックされてしまう虞があります。そこで[[フロー制御]]により、
[[接続]]内の[[ストリーム]]が過剰に干渉してしまうことを防ぎます。 [SRC[>>1]]

[3] [[フロー制御]]は、個々の[[ストリーム]]に対しても、[[接続]]全体に対しても使います。 [SRC[>>1]]

[5] [[HTTP/2]] [[フロー制御]]は、プロトコルを変更せずに色々な[[フロー制御]]アルゴリズムを使えるようにしています。 [SRC[>>1]]

[6] [[フロー制御]]は、特定の[[接続]]に関するものです。
単一の[[ホップ]]について適用されるもので、末端から末端までの全体ではありません。 [SRC[>>1]]

[4] [[フロー制御]]には、 [CODE[[[WINDOW_UPDATE]]]] [[フレーム]]を使います。
[[受信者]]は、[[ストリーム]]について、および[[接続]]全体について、
受信できる[[バイト]]数を[[広告]]します。これは [RUBYB[credit に基づく方式]@en[credit-based scheme]]です。
[SRC[>>1]]

[11] しかし [CODE[[[WINDOW_UPDATE]]]] [[フレーム]]をいつ送信するか、
どのように値を決めるか、[[送信者]]が送信するかどう判断するかを [[HTTP/2]]
仕様としては規定していません。実装は適切な[[アルゴリズム]]を実装することができます。
[SRC[>>1]]

[7] [[フロー制御]]は[[受信者]]によって制御されます。
[[受信者]]は[[ストリーム]]について、また[[接続]]全体について、
任意の[[窓サイズ]]を設定することができます。
[[送信者]]は、[[受信者]]による[[フロー制御]]上の制限に従わなければ[['''なりません''']]。
[SRC[>>1]]

[8] 新しい[[ストリーム]]および[[接続]]全体の[[フロー制御窓]]の初期値は、
65535 [[バイト]]です。 [SRC[>>1]]

[9] [[フロー制御]]が適用されるかどうかは、[[フレーム型]]に依存します。
[CODE[[[DATA]]]] [[フレーム]]のみが適用対象で、
それ以外は[[フロー制御窓]]上の領域を消費しません。従って重要な制御フレームが[[フロー制御]]によりブロックされることはありません。
[SRC[>>1]]

[10] [[フロー制御]]は、無効にはできません。 [SRC[>>1]]


