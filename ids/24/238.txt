* 仕様書

[REFS[
- [1] [CITE@en-GB-x-hixie[HTML Standard]] ([TIME[2015-04-25 04:40:19 +09:00]] 版) <https://html.spec.whatwg.org/#a-browsing-context-is-discarded>
]REFS]

* 処理

[2] [DFN[[RUBYB[閲覧文脈が捨てられる]@en[discard a browsing context]]]]時は、
次のようにしなければ[['''なりません''']]。
[FIG(steps)[
= [7] [[利用者エージェント]]から[[閲覧文脈]]への[[強い参照]]があれば、破棄します [SRC[>>1]]。
= [8] [[閲覧文脈]]の[[セッション履歴]]の全[[セッション履歴エントリー]]について、
== [9] [[セッション履歴エントリー]]の[[文書]]について、[[文書を捨てる]]処理を実行します [SRC[>>1]]。
= [10] [[閲覧文脈]]の捨てられたフラグを[[真]]にします。
]FIG]

[12] [[閲覧文脈]]が捨てられた後も、その[[閲覧文脈]]を指した [CODE(DOMi)@en[[[Window]]]]
[[オブジェクト]] (を指した [CODE(DOMi)@en[[[WindowProxy]]]] [[オブジェクト]])
は残っているかもしれません。

[11] [[閲覧文脈]]の捨てられたフラグは、 [CODE(JS)@en[[[window.closed]]]]
から参照されます。初期値は[[偽]]です。

* 文脈

[6] [CODE(HTMLe)@en[[[iframe]]]] [[要素]]や [CODE(HTMLe)@en[[[frame]]]]
[[要素]]が[[文書から削除]]されたら、
その[[入れ子閲覧文脈]]があれば、[[閲覧文脈を捨てる]]処理をしなければ[['''なりません''']]。

[14] [[文書を捨てる]]と、[[閲覧文脈を捨てる]]処理が呼び出されることがあります。

[13] [[閲覧文脈を閉じる]]と、[[閲覧文脈を捨てる]]処理が呼び出されます。

[3] [[利用者エージェント]]は、いつでも (特に[[利用者]]の指示があった場合には)
[[最上位閲覧文脈]]を捨てて構いません [SRC[>>1]]。

[EG[
[4] 例えば[[利用者]]が1つ[[以上]]の[[最上位閲覧文脈]]を持つ[[窓]]を強制的に閉じた場合が該当します
[SRC[>>1]]。
]EG]

[5] [[最上位閲覧文脈]]以外の[[閲覧文脈]]は、 [CODE(DOMi)@en[[[WindowProxy]]]]
が[[ごみ収集]]の対象となった時、捨てなければ[['''なりません''']] [SRC[>>1]]。
