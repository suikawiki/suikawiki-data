[1] [[URL]] は[DFN[[RUBYB[[[起源]]]@en[origin]]]]を持ちます。多くの場合、 [[URL]] の[[起源]]は
[[URL scheme]] と [[authority]] から決まります。

;; [2] [[起源]]一般については、[[起源]]の項を参照。

[8] [[URL]] の[[起源]]は、[[文書]]の[[起源]]などの定義に使われる、
[[起源]]の基礎となるものです。

* 仕様書

[REFS[
- [300] '''[CITE@en-US[URL Standard]] ([TIME[2014-06-27 13:17:26 +09:00]] 版) <http://url.spec.whatwg.org/#origin>'''
- [135] [CITE@en-US-x-hixie[HTML Standard]] ([TIME[2012-02-22 20:11:59 +09:00]] 版) <http://www.whatwg.org/specs/web-apps/current-work/#origin>
]REFS]

* 定義

[301] [[URL]] の[[起源]]は、次の通り決まります。
[FIG(steps)[
= [302] [[URL scheme]] が [CODE(URI)@en[[[blob:]]]] なら、
[[scheme data]] を [[URL]] として[[構文解析]]し、
成功すればその[[起源]]、失敗すれば新しい大域的に固有な識別子です [SRC[>>300]]。
=- [15] [[scheme data]] の先頭部分に[[起源]]が埋め込まれています。
=- [16] [[Blob URL]] も参照。
= [303] [[URL scheme]] が [CODE(URI)@en[[[ftp:]]]],
[CODE(URI)@en[[[gopher:]]]], [CODE(URI)@en[[[http:]]]], [CODE(URI)@en[[[https:]]]],
[CODE(URI)@en[[[ws:]]]], [CODE(URI)@en[[[wss:]]]] なら、
[[URL scheme]]、[[ホスト]]、[[ポート]]の[[三項組]]です。
ただし[[ポート]]が[[空文字列]]なら、[[既定のポート]]です。 [SRC[>>300]]
= [304] [[URL scheme]] が [CODE(URI)@en[[[file:]]]] なら、
何らかの値です。決めかねるときは新しい大域的に固有な識別子です。 [SRC[>>300]]
= [305] それ以外の時は、新しい大域的に固有な識別子です。 [SRC[>>300]]
]FIG]

;; [306] ここでいう [[URL scheme]]、[[ホスト]]、[[ポート]]は [[URL]]
を[[構文解析]]して得られる値なので、[[正準化]]が済んだ値です。

[162] [[URL]] の[[実効スクリプト起源]]は[[起源]]と同じです [SRC[>>135]]。

;; [242] 別名ではありません。

;; [5] [[文書の起源]]と[[文書のURL]]の[[起源]]は必ずしも一致しません。

[EG[
[9] 例えば [CODE(URI)@en[http://foo.example/hoge/fuga]] の[[起源]]は、
[CODE(URI)[http://foo.example]] (= ([CODE[http]], [CODE[foo.example]], [CODE[80]]))
です。
]EG]

[EG[
[11] 例えば [CODE(URI)@en[about:blank]] の[[起源]]は、新しい大域的に固有な識別子です。
]EG]

;; [17] 大域的に固有な識別子は、 [[URL]] ごとに新しいものが発行されます。
文字列として同じ [[URL]] であっても、[[URLの起源]]を取得する毎に異なる起源になります。

* [CODE(URI)@en[file:]] URL の起源

[31] 仕様上 [CODE(URI)@en[[[file:]]]] [[URL]] の[[起源]]は[[実装]]定義となっています。
古い[[利用者エージェント]]は [CODE(URI)@en[[[file:]]]] [[URL]] に対して緩い制限しかかけていませんでしたが、
[[セキュリティー]]上の問題から最近の[[利用者エージェント]]では細かい単位で[[起源]]を設定していたりします。
例えば、[[ディレクトリー]]単位でアクセスを制限したり、[[ファイル]]ごとに完全に別の[[起源]]として扱ったりしています
[SRC[>>23 4.]]。

* Web ブラウザー依存の URL scheme の起源

[12] [[Chrome]] は、 [CODE(HTTP)@en[[[Origin:]] chrome://version]] のように
[CODE(URI)@en[[[chrome:]]]] [[URL]] でも [[URL scheme]] と [[authority]]
で[[起源]]を構成しているようです。 [TIME[2015-07-07T15:23:29.800Z]]

[13] [[Firefox]] は、 [CODE(URI)@en[[[about:mozilla]]]]
から[[要求]]を送信させると [CODE(HTTP)@en[[[Origin:]] [[null]]]]
を送ります。 [TIME[2015-07-07T15:25:37.900Z]]

[14] [[Firefox]] は、 [CODE(URI)@en[[[chrome:]]]] [[URL]] では
[CODE(HTTP)@en[[[Origin:]] chrome://global]] のように [[URL scheme]]
と [[authority]] で[[起源]]を構成するようです。 [TIME[2015-07-07T15:27:29.00Z]]

* 歴史

[3] [[URL]] の[[起源]]ははじめ [[HTML5]] (現在の [[HTML Standard]]) で規定されましたが、
後に [[RFC 6454]] に移動しました。その後更に [[URL Standard]] へと移動しました。

[REFS[
- [23] [CITE@en[RFC 6454 - The Web Origin Concept]] ([TIME[2011-12-12 09:13:37 +09:00]] 版) <http://tools.ietf.org/html/rfc6454>
]REFS]

;; [4] 詳しくは[[起源]]の項を参照してください。

[7] [[HbbTV 2.0]] は次のように規定しています。
[FIG(quote)[
[FIGCAPTION[
[6] ([TIME[2015-02-10 01:01:20 +09:00]] 版) <http://www.hbbtv.org/pages/about_hbbtv/HbbTV_specification_2_0.pdf#page=44>
]FIGCAPTION]
> For resources loaded via DSM-CC object carousel, the origin shall be the DVB URI in the form (as defined in
TS 102 851 [10] clause 6.3.1):
> "dvb" ":" "//" original_network_id "." transport_stream_id "." service_id "." component_tag
]FIG]

[18] [CITE@en[Clarify that "new globally unique identifier" is intentional. Fixes #56. · whatwg/url@330e090]]
([TIME[2015-08-07 11:18:45 +09:00]] 版)
<https://github.com/whatwg/url/commit/330e090c53e9bebc9752757cd237a0bd71877e03>