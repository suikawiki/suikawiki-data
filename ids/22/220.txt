* 仕様書

[REFS[
- [1] [CITE@en-US[DOM Standard]] ([TIME[2014-06-23 14:49:32 +09:00]] 版) <http://dom.spec.whatwg.org/#node-is-inserted>
]REFS]

* 構文解析器による挿入

[8] [[構文解析器]]によって[[挿入]]される[[節点]]は、すべて[[構文解析器]]によって新たに作られたものです。
[[挿入]]の時点ではまだ一度も[[スクリプト]]からアクセスされたことがないものですし、
[[子孫]]も存在しません。[[属性]]は、[[挿入]]と同時に設定されることがありますが、
それ以外の方法で追加されたものは存在しません。

* 節点の挿入

[2] [[節点]]が別の[[節点]]の[[子供]]として[[挿入]]されると、[[フック]]
[DFN[[RUBYB[[[節点の挿入]]]@en[node is inserted]]]] [SRC[>>1]] が呼び出されます。

;; [3] [[DOM Standard]] 上の[[アルゴリズム]]である [[pre-insert]]、[[replace]]、
[[replace all]] によって呼び出されます。

[4] この[[フック]]によって次の[[節点]]が何らかの処理を行います。

[FIG(list)[
- [CODE(HTMLe)@en[[[option]]]] [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[script]]]] [SRC[[[HTML Standard]]]]
]FIG]

[5] 仕様上明確には規定されていませんが、次の動作もこの[[フック]]のタイミングで処理されると思われます。

[FIG(list)[
- [[要素の文書への挿入]] ※ [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[img]]]] ([CODE(HTMLe)@en[[[picture]]]]) [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[source]]]] ([CODE(HTMLe)@en[[[picture]]]]) [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[source]]]] ([[媒体要素]]) ※ [SRC[[[HTML Standard]]]]
- [[画像写像]] [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[style]]]] の[[子孫]] ※ [SRC[[[HTML Standard]]]]
- [CODE(HTMLe)@en[[[track]]]] ※ [SRC[[[HTML Standard]]]]
- [CODE(XML)@en[[[<?xml-stylesheet?>]]]] [SRC[[[CSSOM]]]]
- [[フォーム被関連付け要素]] ※ [SRC[[[HTML Standard]]]]
- [[文書基底URL]]・[[凍結基底URL]]の更新 [SRC[[[HTML Standard]]]]
]FIG]

[6] 「※」は[[構文解析器]]による挿入かどうかで動作が異なることがあります。

[7] なお、[[pre-insert]], [[replace]], [[replace all]] 操作は[[挿入]]に先立って [[adopt]]
を行いますので、その中で[[節点]]の種類によっては [[adopting steps]] も実行されます。
