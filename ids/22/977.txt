* 仕様書

[REFS[
- [1] [CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-6.1>
- [3] [CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-7.4>
- [5] [CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-7.5>
- [8] '''[CITE@en[RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)]] ([TIME[2014-09-21 17:04:59 +09:00]] 版) <http://tools.ietf.org/html/rfc4918#section-10.4>'''
]REFS]

* 意味

[10] [CODE(HTTP)@en[[[If:]]]] [[ヘッダー]]は、
トークンと[[実体タグ]]が特定の[[資源]]と一致するかどうかの条件の状態リストを指定して[[要求]]を[[条件付き]]とするために使うことができます [SRC[>>8]]。

[11] [CODE(HTTP)@en[[[If:]]]] [[ヘッダー]]は、
[[状態トークン]]を指定して、[[クライアント]]が[[状態トークン]]についての知識を有することを示すためにも使うことができます [SRC[>>8]]。
[[状態トークン]]を [CODE(HTTP)@en[[[If:]]]] に指定することを[DFN[[RUBYB[[[提出]]]@en[submit]]]]といいます [SRC[>>1, >>8]]。

;; [2] その意味は[[状態トークン]]の種類によって異なります [SRC[>>8]] が、
[[ロックトークン]]の場合、[[クライアント]]の [[principal]] が[[ロック]]を有すると表明することとなります。

[12] >>10 と >>11 は同じ[[ヘッダー]]に記述されますが、別々に処理されます。
[[状態トークン]]が[[提出]]されたとみなすかどうかと、
[[状態トークン]]が含まれる状態リストを[[鯖]]が実際に評価したか否かや、
含まれる条件が[[真]]に評価されるか否かは、独立しています [SRC[>>8]]。

[6] 変更される[[資源]]が複数ある場合は、関係するすべての[[ロック]]の[[ロックトークン]]を[[提出]]しなければ[['''なりません''']] [SRC[>>5]]。

[EG[
[7] 例えば移動時に移動元と移動先の両方が[[ロック]]されているなら、
両方の[[ロックトークン]]が必要です [SRC[>>5]]。
]EG]

[4] 変更しようとする[[資源]]が[[コレクション]]の[[メンバー]]として間接的に[[ロック]]されている時は、
(直接の[[ロック]]とは別に) [[コレクション]]の[[ロックトークン]]も指定する必要があります [SRC[>>3]]。

* 処理

[14] [CODE(HTTP)@en[[[If:]]]] [[ヘッダー]]が評価された場合で、
すべての状態リストが失敗した場合には、 [CODE(HTTP)[[[412]]]]
[[応答]]を返して失敗しなければ[['''なりません''']] [SRC[>>8]]。
いずれかの状態リストが成功した場合のみ、成功できます [SRC[>>8]]。

[13] 関係するすべての[[ロック]]の[[ロックトークン]]が指定されなかった場合は、
変更操作が失敗しなければ[['''なりません''']]。 [SRC[>>5]]

* 関連

[9] [CODE(HTTP)@en[[[If-Match:]]]] [[ヘッダー]]と似ていますが、
[CODE(HTTP)@en[[[If:]]]] [[ヘッダー]]には[[実体タグ]]の他に[[状態トークン]]も指定できる点が違っています。
