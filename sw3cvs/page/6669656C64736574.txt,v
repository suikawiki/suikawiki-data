head	1.9;
access;
symbols
	suikawiki3-final:1.9
	before-db-leaffile:1.1;
locks; strict;
comment	@# @;
expand	@o@;


1.9
date	2007.12.27.02.40.48;	author wakaba;	state Exp;
branches;
next	1.8;

1.8
date	2007.03.13.02.39.56;	author wakaba;	state Exp;
branches;
next	1.7;

1.7
date	2007.03.08.02.36.44;	author wakaba;	state Exp;
branches;
next	1.6;

1.6
date	2006.02.27.02.12.45;	author wakaba;	state Exp;
branches;
next	1.5;

1.5
date	2005.12.31.02.10.27;	author wakaba;	state Exp;
branches;
next	1.4;

1.4
date	2005.12.23.02.17.13;	author wakaba;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.08.02.06.15;	author wakaba;	state Exp;
branches;
next	1.2;

1.2
date	2004.09.27.02.06.32;	author wakaba;	state Exp;
branches;
next	1.1;

1.1
date	2004.03.27.02.00.46;	author wakaba;	state Exp;
branches;
next	;


desc
@@


1.9
log
@auto-committed
@
text
@* fieldset 要素型 (HTML, XHTML 1)

[5] [DFN[[CODE(HTMLe)[fieldset]] 要素]]は、
[[フォーム]]の[[制御子]]や[RUBY[名札] [ラベル]]をまとめるために使います。

[16]
仕様書: 
- [[HTML 4]] ([[Web Forms 1.0]])
-- [CITE[17.10 Adding structure to forms: the [CODE(HTMLe)[FIELDSET]] and [CODE(HTMLe)[LEGEND]] elements]]
<IW:HTML4:"interact/forms.html#edef-FIELDSET">
- [[Microsoft]]
-- [CITE@@en-us[fieldSet Object]] 
<http://msdn2.microsoft.com/en-us/library/ms535247.aspx>

[17]
:[[開始タグ]]:必須
:[[終了タグ]]:必須
:[[内容模型]] (HTML 4):[CODE(SGML)[([[空白]], [CODE(HTMLe)[[[legend]]]], (%[[flow]])*)]]
:内容模型 (ISO‐HTML):
[CODE(SGML)[(空白, [CODE(HTMLe)[legend]], (%[[block]] | %[[inline]] | [CODE(HTMLe)[[[address]]]])+) −([CODE(HTMLe)[fieldset]])]]
:出現できる文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
(歴史的変遷: <http://suika.fam.cx/www/2004/html/content-fieldset>)
:[[属性]]:
,属性名	,属性値	,既定値	,説明	,出典
,[CODE(HTMLa)@@en[[[align]]]]	,	,	,非標準
,[CODE(HTMLa)[[[class]]]]	,	,(なし)	,[[級]]	,"[HTML 4] %[[coreattrs]] ⊂ %[[attrs]], [XHTML 1] [[Core]] ⊂ [[Common]]"
,[CODE(HTMLa)[[[dir]]]]	,	,	,[[書字方向]]	,"[HTML 4] %[[i18n]] ⊂ %attrs, [XHTML 1] [[I18N]] ⊂ Common"
,[CODE(HTMLa)[[[id]]]]	,[CODE(SGML)[[[ID]]]]	,(なし)	,一意識別子	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"
,[CODE(HTMLa)[[[lang]]]]	,	,	,[[自然言語]]	,[HTML 4] %i18n ⊂ %attrs
,[CODE(HTMLa)[[[xml]]:lang]]	,	,	,自然言語	,[XHTML 1] I18N ⊂ Common
,[CODE(HTMLa)[[[onclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %[[events]] ⊂ %attrs, [XHTML 1] [[Events]] ⊂ Common"
,[CODE(HTMLa)[[[ondblclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeydown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeypress]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeyup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousedown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousemove]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseout]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseover]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[style]]]]	,	,	,スタイル情報	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] [[Style]] ⊂ Common"
,[CODE(HTMLa)[[[title]]]]	,	,	,注釈的題	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"

** 内容模型

[6] [[HTML 4]] の [[DTD]] では、 [CODE(HTMLe)[fieldset]]
要素型の内容模型は [CODE(SGML)[(#[[PCDATA]], [CODE(HTMLe)[LEGEND]], ([VAR[%flow]])*)]]
とされていますが、注釈で、 [CODE(SGML)[#PCDATA]]
は[[混合内容]]問題を解決するためで、
[[空白]]のみが許される、とされています。

もし内容模型が [CODE(SGML)[([CODE(HTMLe)[legend]], ([VAR[%flow]])*)]]
であったとすると、
[PRE(HTML)[
<fieldset>
  <legend/>
  %flow;
</fieldset>
]PRE]

のように [CODE(HTMLe)[legend]] の開始タグの前に空白がある時に、
(この内容模型は [CODE[[VAR[%flow]]]] 内に [CODE(SGML)[#PCDATA]] が含まれているため、混合内容であり、)
その空白が [CODE(SGML)[#PCDATA]] に該当する[[データ]]とされてしまいます。
しかし、 [CODE(HTMLe)[fieldset]] 要素内にはデータより先に
[CODE(HTMLe)[legend]] 要素が必要ですから、非[[妥当]]にされてしまいます。

この問題には、
- [CODE(HTMLe)[legend]] 要素の開始タグは必ず
[CODE(HTMLe)[fieldset]] 要素の開始タグの直後に書く
(字下げは諦める)
- [CODE(HTMLe)[[[textflow]]]] 要素型や [CODE(HTMLe)[[[bodytext]]]] 要素型のようなダミーを用意する
- [CODE(SGML)[#PCDATA]] を許してしまう
(厳密性を諦める)

の三つの解法があります。 HTML 4 は最終的には三番目の解法を
選択しました。

[7] ところで、 HTML 4 DTD 注釈には
[Q[per specification only whitespace is allowed there]<IW:HTML4:"interact/forms.html#h-17.10">]
と書いてありますけど、仕様書のどこに書いてあるのでしょうか?
(HTML 4 DTD 内の注釈は[RUBYB[参考] [informative]]だし、
心許ないなあ。でも ISO‐HTML の注釈は[RUBYB[規定] [normative]]だ。)

[10]
[[XHTML 1]] では、 [[XML]] の制約から、
更に自由な内容模型 [CODE(XML)[(#PCDATA | %[CODE(HTMLe)[legend]].qname; | %[[Flow.mix]];)*]] になってしまっています。

だけど混合内容問題を解決するために〜という注釈は残ったままなので意味不明になっています。 ([CODE(HTMLe)[fieldset]] 内は全く要素か空白しか入れられないように読めてしまう。)
たとえば: <http://www.w3.org/TR/2001/REC-xhtml-modularization-20010410/xhtml-modularization.html#dtdelement_fieldset.qname>

[11]
HTML 4 でも XHTML 1 でも、 [CODE(HTMLe)[form]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることはできませんから、 [CODE(HTMLe)[form]] 要素の子孫である [CODE(HTMLe)[fieldset]] 要素の子孫として [CODE(HTMLe)[form]] 要素を入れることはできません。しかし、
[CODE(HTMLe)[form]] 要素の子孫ではない [CODE(HTMLe)[fieldset]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることは可能のようです。

[15] ISO‐HTML では [CODE(HTMLe)[fieldset]]
要素の入れ子は禁止されています。

[20]
HTML 4 DTD の[[注釈]] (参考) の説明:

> #PCDATA is to solve the mixed content problem,
per specification only whitespace is allowed there!

[[#comment]]

** 文脈

[29] [[Cougar]] (>>25) 以来、 [CODE(HTMLe)@@en[[[fieldset]]]] 
は[[ブロック水準要素]] ([CODE(SGML)@@en[%[[block]];]])
に分類されています。

[30] ちなみに、 [[HTML 2.0]] の [[DTD]] では[[フォーム制御子]]は
[CODE(HTMLe)@@en[[[form]]]] [[要素]]内でしか使えないことになっていましたが、
[[HTML 3.2]] や [[HTML 4]] ([[Cougar]]) では[[行内要素]]
([CODE(SGML)@@en[%[[text]];]]) とされていて、 [CODE(HTMLe)@@en[[[form]]]]
の外でも使えます。 [CODE(HTMLe)@@en[[[fieldset]]]] 
[[要素]]も特に [CODE(HTMLe)@@en[[[form]]]] [[要素]]内に限定されてはいません。

[[#comment]]

** UA による利用

[[#comment]]


*** レンダリング

[8] [CODE(HTMLe)[fieldset]] による集団化情報を使って、
[[視覚UA]] は[[タブ]]を使ったレンダリングができますし、
[[音声UA]] もより分かりやすいレンダリングができます。
従って利用者はよりフォームの制御子等の目的を理解しやすくなり、
文書の[[アクセス可能性]]が高まります。 [SRC[HTML 4 17.10]]

[18]
HTML 4 (というか HTML 3 Form) 
の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な[Q[集団化]]に留まったのでしょう。

しかし、同じ [CODE(HTMLe)[[[form]]]] 内の近隣の
[CODE(HTMLe)[[[fieldset]]]] をまとめてタブ集合として表示する
UA なんて見たことがありません。

実際にタブとしてレンダリングするには [CODE(HTMLe)[[[li]]]]
に対する [CODE(HTMLe)[[[ul]]]] のような包含子要素が要るのではないでしょうか。

[9] [[WinIE]] や [[Gecko]] などは、
[PRE[
+- LEGEND ------------------------+
| Label: Control........          |
| Label: Control........          |
+---------------------------------+
]PRE]

のような既定スタイルを持っています。枠線は[Q[窪み]]です。
(Windoze の設定 dialog box などでよくでてくる、
集団化のためのあれと同じ style です。)

[21]
[[Opnewave SDK]]では[[要素]]の上下に[CODE(HTMLe)@@en[[[hr]]]]のような線が引かれるのが既定スタイルです。

[22]
>>9 は[[Microsoft Windows]]の ([[Windows 95]]以来の) [[GUI]]における[CODE(HTMLe)@@en[[[fieldset]]]]相当の表現ですが、[[Microsoft Office]]は [WEAK[(確か97以来)]]
[PRE(aafig)[
 LEGEND -------------------------
  Label: Control........           
  Label: Control........           
]PRE]

のようになっています。

[23]
>>9 は[[Microsoft Windows]]の ([[Windows 95]]以来の) [[GUI]]における[CODE(HTMLe)@@en[[[fieldset]]]]相当の表現ですが、[[Microsoft Office]]は [WEAK[(確か97以来)]]
[PRE(aafig)[
 LEGEND -------------------------
  Label: Control........           
  Label: Control........           
]PRE]

のようになっています。

[28] [[WinIE]] の古い版では、 [CODE(HTMLa)@@en[[[align]]]]
[[属性]]が [CODE(HTMLe)@@en[[[img]]]] [[要素]]の場合のように実装されていたそうです。

;; <http://www.tohoho-web.com/html/fieldset.htm>

[[#comment]]




** 不思議解釈

[1]
''地獄変00:blockquoteはもう古い〜fieldsetの伝説(legend)!!'' <http://blog.livedoor.jp/jigokuhen00/archives/169129.html#content>
([[名無しさん]] [WEAK[2004-03-23 02:15:27 +00:00]])

[2]
>>1 は[[引用]]のために (特定 [[UA]] の見た目の理由から) [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[[[legend]]]] を使おうと提案して叩かれた例。

;; 著者が一日でこんなに叩かれましたと出してる URI がほとんど某方面なのが藁える。

[3]
だけど、 >>1 みたいなことを考える人が出てくるのって、
- [[HTML 3]] の [CODE(HTMLe)[[[credit]]]] や表の [CODE(HTMLe)[[[caption]]]] に相当する要素型が無い
- [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] の典型的レンダリング(謎)を CSS で気軽に(謎)実現する方法がない

のが原因でしょ。それが解決されない限りまた繰り返されるだろうなあ。
(Form control 以外の集団化・見出し付けのために [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] を使うというネタはたしか外出だし。)

[[#comment]]


** 他との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。

[[#comment]]

** 歴史

[25] [CODE(HTMLe)@@en[[[fieldset]]]] [[要素]]は1996年7月10日の
[[Cougar]] ([[HTML 4]]) [[DTD]] 案で初めて登場しました。

;; <http://suika.fam.cx/gate/2007/schema/schema/d5713b08467c2ce6c88318ad9af7bf92/prop.html>

[27] [[WinIE]] は 4.0 から実装しています。

[[WinIE 4]] の最初の公開版 (Platform Preview 英語版) 
は1997年4月に配布開始されています。このとき既に 
[CODE(HTMLe)@@en[[[fieldset]]]] 
[[要素]]が実装されていたかは定かではありませんが、
いずれにしても >>25 より後ということになります。

一般公開されていないα版は1996年6月にできているらしいです。
その時点で実装されていたとすれば、 >>25 より前になります。

もっとも、当時 [[Microsoft]] は [[HTML WG]] に参加していたので、
[[Microsoft]] が [[HTML WG]] に提案し、かつほぼ同時に [[WinIE]]
に実装した、という可能性もあります。

[26] [[Classic Mozilla]] では実装されず、 [[Gecko]] 版 [[Mozilla]] 
で初めて実装されたようです。

1998年11月付けの[[画面写真]]に [CODE(HTMLe)@@en[[[fieldset]]]]
[[要素]]の例が示されています。

;; [CITE[NGLayout Project: Screen Shots]] 
([TIME[2007-09-08 17:38:45 +09:00]] 版) 
<http://www.mozilla.org/newlayout/screenshots/>

- [31] [CITE[Bug 944 &#8211; FIELDSET and LEGEND don't work]] 
<https://bugzilla.mozilla.org/show_bug.cgi?id=944>
- [36] [CITE[Bug 1860 &#8211; HTML4: <FIELDSET><LEGEND>Title</LEGEND></FIELDSET>]] 
<https://bugzilla.mozilla.org/show_bug.cgi?id=1860>
- [34] [CITE[Bug 2358 &#8211; parser: frameset terminates early]] 
<https://bugzilla.mozilla.org/show_bug.cgi?id=2358>
- [35] [CITE[Bug 3854 &#8211; Pages not displayed correctly]]
<https://bugzilla.mozilla.org/show_bug.cgi?id=3854>
- [32]
[CITE[Bug 6452 &#8211; HTML 4 FIELDSET (and LEGEND) display broken]] 
<https://bugzilla.mozilla.org/show_bug.cgi?id=6452>
- [33] [CITE[Bug 8869 &#8211; legend has incorrect vertical positioning]] 
<https://bugzilla.mozilla.org/show_bug.cgi?id=8869>

[[#comment]]

** 実装

[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>

[[#comment]]

** 例

[19] 薬暦フォームの例 [SRC[HTML 4 17.10]]
[PRE(HTML)[
<FORM action="[VAR[...]]" method="post">
 <P>
 <FIELDSET>
  <LEGEND>Personal Information</LEGEND>
  Last Name: <INPUT name="personal_lastname" type="text" tabindex="1">
  First Name: <INPUT name="personal_firstname" type="text" tabindex="2">
  Address: <INPUT name="personal_address" type="text" tabindex="3">
  ...more personal information...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Medical History</LEGEND>
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Smallpox" tabindex="20"> Smallpox
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Mumps" tabindex="21"> Mumps
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Dizziness" tabindex="22"> Dizziness
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Sneezing" tabindex="23"> Sneezing
  ...more medical history...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Current Medication</LEGEND>
  Are you currently taking any medication? 
  <INPUT name="medication_now" 
         type="radio" 
         value="Yes" tabindex="35">Yes
  <INPUT name="medication_now" 
         type="radio" 
         value="No" tabindex="35">No
  If you are currently taking medication, please indicate
  it in the space below:
  <TEXTAREA name="current_medication" 
            rows="20" cols="50"
            tabindex="40">
  </TEXTAREA>
 </FIELDSET>
</FORM>
]PRE]

HTML 4 仕様書は、更にスタイル・シートやスクリプトで制御子の位置を揃えたり、
色を変えたり、 [Q[Current Medication]] で [Q[Yes]] と答えた場合のみ
[CODE(HTMLe)[textarea]] を有効にしたりすると更に利用者にとって分かりやすくなるであろうと指摘しています。
([CODE(HTMLe)[[[label]]]] も使った方が良いでしょう。)

[24]
'''一般の見出し・本文のマーク付けに濫用した例'''
[PRE(HTML bad example code)[
    <TR>
      <TD>
      <FORM>
      <FIELDSET><LEGEND><A name="600"><B>紀元前600年頃世界初のデリバティブ</B></A></LEGEND><BR>
      デリバティブとは、主に(金融などから)派生した商品のことで、有名なものに先物取引、オプション取引、スワップ取引がある。その中のオプション取引(オプションとは、権利料のことで、例えば一定期間の後に決まった金額で株式などを買うことのできる権利の値段をいう)で大もうけをした人物が紀元前の600年ごろにいたという記録がある。<BR>
      <BR>
      アリストテレスの「政治学」の中に出てくる話で、哲学者のターレスという人物が、星の観測からオリーブの大豊作を予想し、オリーブ絞り機の権利料(収穫期のオリーブ絞り機を使うことのできる権利)を買い占めて大もうけした話がある。<BR>
      <BR>
      </FIELDSET>
      </FORM>
      </TD>
    </TR>
]PRE]

;; 出典: [CITE[株にまつわる金融の歴史・出来事・動き]] 
(2006年2月付け) <http://tyotiku.fc2web.com/stock1.html>

;; >>1 も参照。

[[#comment]]


** メモ

[[#comment]]


* メモ@


1.8
log
@auto-committed
@
text
@d1 370
a370 329


* fieldset 要素型 (HTML, XHTML 1)

[5] [DFN[[CODE(HTMLe)[fieldset]] 要素]]は、
[[フォーム]]の[[制御子]]や[RUBY[名札] [ラベル]]をまとめるために使います。

[16]
仕様書: 
- [[HTML 4]] ([[Web Forms 1.0]])
-- [CITE[17.10 Adding structure to forms: the [CODE(HTMLe)[FIELDSET]] and [CODE(HTMLe)[LEGEND]] elements]]
<IW:HTML4:"interact/forms.html#edef-FIELDSET">

[17]
:[[開始タグ]]:必須
:[[終了タグ]]:必須
:[[内容模型]] (HTML 4):[CODE(SGML)[([[空白]], [CODE(HTMLe)[[[legend]]]], (%[[flow]])*)]]
:内容模型 (ISO‐HTML):
[CODE(SGML)[(空白, [CODE(HTMLe)[legend]], (%[[block]] | %[[inline]] | [CODE(HTMLe)[[[address]]]])+) −([CODE(HTMLe)[fieldset]])]]
:出現できる文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
(歴史的変遷: <http://suika.fam.cx/www/2004/html/content-fieldset>)
:[[属性]]:
,属性名	,属性値	,既定値	,説明	,出典
,[CODE(HTMLa)@@en[[[align]]]]	,	,	,非標準
,[CODE(HTMLa)[[[class]]]]	,	,(なし)	,[[級]]	,"[HTML 4] %[[coreattrs]] ⊂ %[[attrs]], [XHTML 1] [[Core]] ⊂ [[Common]]"
,[CODE(HTMLa)[[[dir]]]]	,	,	,[[書字方向]]	,"[HTML 4] %[[i18n]] ⊂ %attrs, [XHTML 1] [[I18N]] ⊂ Common"
,[CODE(HTMLa)[[[id]]]]	,[CODE(SGML)[[[ID]]]]	,(なし)	,一意識別子	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"
,[CODE(HTMLa)[[[lang]]]]	,	,	,[[自然言語]]	,[HTML 4] %i18n ⊂ %attrs
,[CODE(HTMLa)[[[xml]]:lang]]	,	,	,自然言語	,[XHTML 1] I18N ⊂ Common
,[CODE(HTMLa)[[[onclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %[[events]] ⊂ %attrs, [XHTML 1] [[Events]] ⊂ Common"
,[CODE(HTMLa)[[[ondblclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeydown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeypress]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeyup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousedown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousemove]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseout]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseover]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[style]]]]	,	,	,スタイル情報	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] [[Style]] ⊂ Common"
,[CODE(HTMLa)[[[title]]]]	,	,	,注釈的題	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"


[25]
Only today!!!
[URL=http://hometown.aol.com/stanwatch/stan-watch.html><b>stan watch</b>[/URL] <A HREF="http://hometown.aol.com/stanwatch/stan-watch.html"><b>stan watch</b></A> http://hometown.aol.com/stanwatch/stan-watch.html 
http://hometown.aol.com/stanwatch/stan-watch.html 
([[Eblanchik]] [support@@microsoft.com])


[26]
Best site!! Man i love you!!!!!!
http://hometown.aol.com/FlwArrangements/floralarrangements/Floral-Arrangements.html - Floral Arrangements<a href= http://hometown.aol.com/FlwArrangements/floralarrangements/Floral-Arrangements.html >Floral Arrangements</a>[url= http://hometown.aol.com/FlwArrangements/floralarrangements/Floral-Arrangements.html ]Floral Arrangements[/url]
http://hometown.aol.com/FlwArrangements/floralarrangements/Floral-Arrangements.html
([[theman]] [openbfor@@rtydg.com])


[[#comment]]


** 内容模型

[6] [[HTML 4]] の [[DTD]] では、 [CODE(HTMLe)[fieldset]]
要素型の内容模型は [CODE(SGML)[(#[[PCDATA]], [CODE(HTMLe)[LEGEND]], ([VAR[%flow]])*)]]
とされていますが、注釈で、 [CODE(SGML)[#PCDATA]]
は[[混合内容]]問題を解決するためで、
[[空白]]のみが許される、とされています。

もし内容模型が [CODE(SGML)[([CODE(HTMLe)[legend]], ([VAR[%flow]])*)]]
であったとすると、
[PRE(HTML)[
<fieldset>
  <legend/>
  %flow;
</fieldset>
]PRE]

のように [CODE(HTMLe)[legend]] の開始タグの前に空白がある時に、
(この内容模型は [CODE[[VAR[%flow]]]] 内に [CODE(SGML)[#PCDATA]] が含まれているため、混合内容であり、)
その空白が [CODE(SGML)[#PCDATA]] に該当する[[データ]]とされてしまいます。
しかし、 [CODE(HTMLe)[fieldset]] 要素内にはデータより先に
[CODE(HTMLe)[legend]] 要素が必要ですから、非[[妥当]]にされてしまいます。

この問題には、
- [CODE(HTMLe)[legend]] 要素の開始タグは必ず
[CODE(HTMLe)[fieldset]] 要素の開始タグの直後に書く
(字下げは諦める)
- [CODE(HTMLe)[[[textflow]]]] 要素型や [CODE(HTMLe)[[[bodytext]]]] 要素型のようなダミーを用意する
- [CODE(SGML)[#PCDATA]] を許してしまう
(厳密性を諦める)

の三つの解法があります。 HTML 4 は最終的には三番目の解法を
選択しました。

[7] ところで、 HTML 4 DTD 注釈には
[Q[per specification only whitespace is allowed there]<IW:HTML4:"interact/forms.html#h-17.10">]
と書いてありますけど、仕様書のどこに書いてあるのでしょうか?
(HTML 4 DTD 内の注釈は[RUBYB[参考] [informative]]だし、
心許ないなあ。でも ISO‐HTML の注釈は[RUBYB[規定] [normative]]だ。)

[10]
[[XHTML 1]] では、 [[XML]] の制約から、
更に自由な内容模型 [CODE(XML)[(#PCDATA | %[CODE(HTMLe)[legend]].qname; | %[[Flow.mix]];)*]] になってしまっています。

だけど混合内容問題を解決するために〜という注釈は残ったままなので意味不明になっています。 ([CODE(HTMLe)[fieldset]] 内は全く要素か空白しか入れられないように読めてしまう。)
たとえば: <http://www.w3.org/TR/2001/REC-xhtml-modularization-20010410/xhtml-modularization.html#dtdelement_fieldset.qname>

[11]
HTML 4 でも XHTML 1 でも、 [CODE(HTMLe)[form]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることはできませんから、 [CODE(HTMLe)[form]] 要素の子孫である [CODE(HTMLe)[fieldset]] 要素の子孫として [CODE(HTMLe)[form]] 要素を入れることはできません。しかし、
[CODE(HTMLe)[form]] 要素の子孫ではない [CODE(HTMLe)[fieldset]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることは可能のようです。

[15] ISO‐HTML では [CODE(HTMLe)[fieldset]]
要素の入れ子は禁止されています。

[20]
HTML 4 DTD の[[注釈]] (参考) の説明:

> #PCDATA is to solve the mixed content problem,
per specification only whitespace is allowed there!

([[名無しさん]] [sage])

[[#comment]]


** UA による利用

[[#comment]]


*** レンダリング

[8] [CODE(HTMLe)[fieldset]] による集団化情報を使って、
[[視覚UA]] は[[タブ]]を使ったレンダリングができますし、
[[音声UA]] もより分かりやすいレンダリングができます。
従って利用者はよりフォームの制御子等の目的を理解しやすくなり、
文書の[[アクセス可能性]]が高まります。 [SRC[HTML 4 17.10]]

[18]
HTML 4 (というか HTML 3 Form) 
の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な[Q[集団化]]に留まったのでしょう。

しかし、同じ [CODE(HTMLe)[[[form]]]] 内の近隣の
[CODE(HTMLe)[[[fieldset]]]] をまとめてタブ集合として表示する
UA なんて見たことがありません。

実際にタブとしてレンダリングするには [CODE(HTMLe)[[[li]]]]
に対する [CODE(HTMLe)[[[ul]]]] のような包含子要素が要るのではないでしょうか。

[9] [[WinIE]] や [[Gecko]] などは、
[PRE[
+- LEGEND ------------------------+
| Label: Control........          |
| Label: Control........          |
+---------------------------------+
]PRE]

のような既定スタイルを持っています。枠線は[Q[窪み]]です。
(Windoze の設定 dialog box などでよくでてくる、
集団化のためのあれと同じ style です。)

[21]
[[Opnewave SDK]]では[[要素]]の上下に[CODE(HTMLe)@@en[[[hr]]]]のような線が引かれるのが既定スタイルです。
([[名無しさん]] [sage])

[22]
>>9 は[[Microsoft Windows]]の ([[Windows 95]]以来の) [[GUI]]における[CODE(HTMLe)@@en[[[fieldset]]]]相当の表現ですが、[[Microsoft Office]]は [WEAK[(確か97以来)]]
[PRE(aafig)[
 LEGEND -------------------------
  Label: Control........           
  Label: Control........           
]PRE]

のようになっています。

([[名無しさん]] [sage])

[23]
>>9 は[[Microsoft Windows]]の ([[Windows 95]]以来の) [[GUI]]における[CODE(HTMLe)@@en[[[fieldset]]]]相当の表現ですが、[[Microsoft Office]]は [WEAK[(確か97以来)]]
[PRE(aafig)[
 LEGEND -------------------------
  Label: Control........           
  Label: Control........           
]PRE]

のようになっています。

([[名無しさん]] [sage])

[[#comment]]


** 実装

[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>

[[#comment]]


** 不思議解釈

[1]
''地獄変00:blockquoteはもう古い〜fieldsetの伝説(legend)!!'' <http://blog.livedoor.jp/jigokuhen00/archives/169129.html#content>
([[名無しさん]] [WEAK[2004-03-23 02:15:27 +00:00]])

[2]
>>1 は[[引用]]のために (特定 [[UA]] の見た目の理由から) [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[[[legend]]]] を使おうと提案して叩かれた例。

;; 著者が一日でこんなに叩かれましたと出してる URI がほとんど某方面なのが藁える。

[3]
だけど、 >>1 みたいなことを考える人が出てくるのって、
- [[HTML 3]] の [CODE(HTMLe)[[[credit]]]] や表の [CODE(HTMLe)[[[caption]]]] に相当する要素型が無い
- [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] の典型的レンダリング(謎)を CSS で気軽に(謎)実現する方法がない

のが原因でしょ。それが解決されない限りまた繰り返されるだろうなあ。
(Form control 以外の集団化・見出し付けのために [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] を使うというネタはたしか外出だし。)

[[#comment]]


** 他との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。

[[#comment]]


** 例

[19] 薬暦フォームの例 [SRC[HTML 4 17.10]]
[PRE(HTML)[
<FORM action="[VAR[...]]" method="post">
 <P>
 <FIELDSET>
  <LEGEND>Personal Information</LEGEND>
  Last Name: <INPUT name="personal_lastname" type="text" tabindex="1">
  First Name: <INPUT name="personal_firstname" type="text" tabindex="2">
  Address: <INPUT name="personal_address" type="text" tabindex="3">
  ...more personal information...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Medical History</LEGEND>
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Smallpox" tabindex="20"> Smallpox
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Mumps" tabindex="21"> Mumps
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Dizziness" tabindex="22"> Dizziness
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Sneezing" tabindex="23"> Sneezing
  ...more medical history...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Current Medication</LEGEND>
  Are you currently taking any medication? 
  <INPUT name="medication_now" 
         type="radio" 
         value="Yes" tabindex="35">Yes
  <INPUT name="medication_now" 
         type="radio" 
         value="No" tabindex="35">No
  If you are currently taking medication, please indicate
  it in the space below:
  <TEXTAREA name="current_medication" 
            rows="20" cols="50"
            tabindex="40">
  </TEXTAREA>
 </FIELDSET>
</FORM>
]PRE]

HTML 4 仕様書は、更にスタイル・シートやスクリプトで制御子の位置を揃えたり、
色を変えたり、 [Q[Current Medication]] で [Q[Yes]] と答えた場合のみ
[CODE(HTMLe)[textarea]] を有効にしたりすると更に利用者にとって分かりやすくなるであろうと指摘しています。
([CODE(HTMLe)[[[label]]]] も使った方が良いでしょう。)

[24]
'''一般の見出し・本文のマーク付けに濫用した例'''
[PRE(HTML bad example code)[
    <TR>
      <TD>
      <FORM>
      <FIELDSET><LEGEND><A name="600"><B>紀元前600年頃世界初のデリバティブ</B></A></LEGEND><BR>
      デリバティブとは、主に(金融などから)派生した商品のことで、有名なものに先物取引、オプション取引、スワップ取引がある。その中のオプション取引(オプションとは、権利料のことで、例えば一定期間の後に決まった金額で株式などを買うことのできる権利の値段をいう)で大もうけをした人物が紀元前の600年ごろにいたという記録がある。<BR>
      <BR>
      アリストテレスの「政治学」の中に出てくる話で、哲学者のターレスという人物が、星の観測からオリーブの大豊作を予想し、オリーブ絞り機の権利料(収穫期のオリーブ絞り機を使うことのできる権利)を買い占めて大もうけした話がある。<BR>
      <BR>
      </FIELDSET>
      </FORM>
      </TD>
    </TR>
]PRE]

;; 出典: [CITE[株にまつわる金融の歴史・出来事・動き]] 
(2006年2月付け) <http://tyotiku.fc2web.com/stock1.html>

;; >>1 も参照。

([[名無しさん]] [sage])

[[#comment]]


** メモ

[[#comment]]


@


1.7
log
@auto-committed
@
text
@a43 1

d45 2
a46 2
Only today!!!
[URL=http://hometown.aol.com/stanwatch/stan-watch.html><b>stan watch</b>[/URL] <A HREF="http://hometown.aol.com/stanwatch/stan-watch.html"><b>stan watch</b></A> http://hometown.aol.com/stanwatch/stan-watch.html 
d49 7
@


1.6
log
@auto-committed
@
text
@d44 8
d292 19
d312 1
a312 25
[24]
'''一般の見出し・本文のマーク付けに濫用した例'''
[PRE(HTML bad example code)[
    <TR>
      <TD>

      <FORM>
      <FIELDSET><LEGEND><A name="600"><B>紀元前600年頃世界初のデリバティブ</B></A></LEGEND><BR>
      デリバティブとは、主に(金融などから)派生した商品のことで、有名なものに先物取引、オプション取引、スワップ取引がある。その中のオプション取引(オプションとは、権利料のことで、例えば一定期間の後に決まった金額で株式などを買うことのできる権利の値段をいう)で大もうけをした人物が紀元前の600年ごろにいたという記録がある。<BR>
      <BR>
      アリストテレスの「政治学」の中に出てくる話で、哲学者のターレスという人物が、星の観測からオリーブの大豊作を予想し、オリーブ絞り機の権利料(収穫期のオリーブ絞り機を使うことのできる権利)を買い占めて大もうけした話がある。<BR>
      <BR>
      </FIELDSET>

      </FORM>
      </TD>
    </TR>
]PRE]

;; 出典: [CITE[株にまつわる金融の歴史・出来事・動き]] 
(2006年2月付け) <http://tyotiku.fc2web.com/stock1.html>


;; >>1 も参照。

a314 1

@


1.5
log
@auto-committed
@
text
@d165 7
d173 1
a173 9
[23]
>>9 は[[Microsoft Windows]]の ([[Windows 95]]以来の) [[GUI]]における[CODE(HTMLe)@@en[[[fieldset]]]]相当の表現ですが、[[Microsoft Office]]は [WEAK[(確か97以来)]]
[PRE(aafig)[
 LEGEND -------------------------
  Label: Control........           
  Label: Control........           
]PRE]
のようになっています。

a176 1

d283 30
@


1.4
log
@auto-committed
@
text
@d1 171
a171 144


* fieldset 要素型 (HTML, XHTML 1)

[5] [DFN[[CODE(HTMLe)[fieldset]] 要素]]は、
[[フォーム]]の[[制御子]]や[RUBY[名札] [ラベル]]をまとめるために使います。

[16]
仕様書: 
- [[HTML 4]] ([[Web Forms 1.0]])
-- [CITE[17.10 Adding structure to forms: the [CODE(HTMLe)[FIELDSET]] and [CODE(HTMLe)[LEGEND]] elements]]
<IW:HTML4:"interact/forms.html#edef-FIELDSET">

[17]
:[[開始タグ]]:必須
:[[終了タグ]]:必須
:[[内容模型]] (HTML 4):[CODE(SGML)[([[空白]], [CODE(HTMLe)[[[legend]]]], (%[[flow]])*)]]
:内容模型 (ISO‐HTML):
[CODE(SGML)[(空白, [CODE(HTMLe)[legend]], (%[[block]] | %[[inline]] | [CODE(HTMLe)[[[address]]]])+) −([CODE(HTMLe)[fieldset]])]]
:出現できる文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
(歴史的変遷: <http://suika.fam.cx/www/2004/html/content-fieldset>)
:[[属性]]:
,属性名	,属性値	,既定値	,説明	,出典
,[CODE(HTMLa)@@en[[[align]]]],,,非標準
,[CODE(HTMLa)[[[class]]]]	,	,(なし)	,[[級]]	,"[HTML 4] %[[coreattrs]] ⊂ %[[attrs]], [XHTML 1] [[Core]] ⊂ [[Common]]"
,[CODE(HTMLa)[[[dir]]]]	,	,	,[[書字方向]]	,"[HTML 4] %[[i18n]] ⊂ %attrs, [XHTML 1] [[I18N]] ⊂ Common"
,[CODE(HTMLa)[[[id]]]]	,[CODE(SGML)[[[ID]]]]	,(なし)	,一意識別子	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"
,[CODE(HTMLa)[[[lang]]]]	,	,	,[[自然言語]]	,[HTML 4] %i18n ⊂ %attrs
,[CODE(HTMLa)[[[xml]]:lang]]	,	,	,自然言語	,[XHTML 1] I18N ⊂ Common
,[CODE(HTMLa)[[[onclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %[[events]] ⊂ %attrs, [XHTML 1] [[Events]] ⊂ Common"
,[CODE(HTMLa)[[[ondblclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeydown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeypress]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeyup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousedown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousemove]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseout]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseover]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[style]]]]	,	,	,スタイル情報	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] [[Style]] ⊂ Common"
,[CODE(HTMLa)[[[title]]]]	,	,	,注釈的題	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"


[[#comment]]


** 内容模型

[6] [[HTML 4]] の [[DTD]] では、 [CODE(HTMLe)[fieldset]]
要素型の内容模型は [CODE(SGML)[(#[[PCDATA]], [CODE(HTMLe)[LEGEND]], ([VAR[%flow]])*)]]
とされていますが、注釈で、 [CODE(SGML)[#PCDATA]]
は[[混合内容]]問題を解決するためで、
[[空白]]のみが許される、とされています。

もし内容模型が [CODE(SGML)[([CODE(HTMLe)[legend]], ([VAR[%flow]])*)]]
であったとすると、
[PRE(HTML)[
<fieldset>
  <legend/>
  %flow;
</fieldset>
]PRE]

のように [CODE(HTMLe)[legend]] の開始タグの前に空白がある時に、
(この内容模型は [CODE[[VAR[%flow]]]] 内に [CODE(SGML)[#PCDATA]] が含まれているため、混合内容であり、)
その空白が [CODE(SGML)[#PCDATA]] に該当する[[データ]]とされてしまいます。
しかし、 [CODE(HTMLe)[fieldset]] 要素内にはデータより先に
[CODE(HTMLe)[legend]] 要素が必要ですから、非[[妥当]]にされてしまいます。

この問題には、
- [CODE(HTMLe)[legend]] 要素の開始タグは必ず
[CODE(HTMLe)[fieldset]] 要素の開始タグの直後に書く
(字下げは諦める)
- [CODE(HTMLe)[[[textflow]]]] 要素型や [CODE(HTMLe)[[[bodytext]]]] 要素型のようなダミーを用意する
- [CODE(SGML)[#PCDATA]] を許してしまう
(厳密性を諦める)

の三つの解法があります。 HTML 4 は最終的には三番目の解法を
選択しました。

[7] ところで、 HTML 4 DTD 注釈には
[Q[per specification only whitespace is allowed there]<IW:HTML4:"interact/forms.html#h-17.10">]
と書いてありますけど、仕様書のどこに書いてあるのでしょうか?
(HTML 4 DTD 内の注釈は[RUBYB[参考] [informative]]だし、
心許ないなあ。でも ISO‐HTML の注釈は[RUBYB[規定] [normative]]だ。)

[10]
[[XHTML 1]] では、 [[XML]] の制約から、
更に自由な内容模型 [CODE(XML)[(#PCDATA | %[CODE(HTMLe)[legend]].qname; | %[[Flow.mix]];)*]] になってしまっています。

だけど混合内容問題を解決するために〜という注釈は残ったままなので意味不明になっています。 ([CODE(HTMLe)[fieldset]] 内は全く要素か空白しか入れられないように読めてしまう。)
たとえば: <http://www.w3.org/TR/2001/REC-xhtml-modularization-20010410/xhtml-modularization.html#dtdelement_fieldset.qname>

[11]
HTML 4 でも XHTML 1 でも、 [CODE(HTMLe)[form]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることはできませんから、 [CODE(HTMLe)[form]] 要素の子孫である [CODE(HTMLe)[fieldset]] 要素の子孫として [CODE(HTMLe)[form]] 要素を入れることはできません。しかし、
[CODE(HTMLe)[form]] 要素の子孫ではない [CODE(HTMLe)[fieldset]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることは可能のようです。

[15] ISO‐HTML では [CODE(HTMLe)[fieldset]]
要素の入れ子は禁止されています。


[20]
HTML 4 DTD の[[注釈]] (参考) の説明:
>  #PCDATA is to solve the mixed content problem,
per specification only whitespace is allowed there!


([[名無しさん]] [sage])


[[#comment]]


** UA による利用

[[#comment]]


*** レンダリング

[8] [CODE(HTMLe)[fieldset]] による集団化情報を使って、
[[視覚UA]] は[[タブ]]を使ったレンダリングができますし、
[[音声UA]] もより分かりやすいレンダリングができます。
従って利用者はよりフォームの制御子等の目的を理解しやすくなり、
文書の[[アクセス可能性]]が高まります。 [SRC[HTML 4 17.10]]

[18]
HTML 4 (というか HTML 3 Form) 
の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な[Q[集団化]]に留まったのでしょう。

しかし、同じ [CODE(HTMLe)[[[form]]]] 内の近隣の
[CODE(HTMLe)[[[fieldset]]]] をまとめてタブ集合として表示する
UA なんて見たことがありません。

実際にタブとしてレンダリングするには [CODE(HTMLe)[[[li]]]]
に対する [CODE(HTMLe)[[[ul]]]] のような包含子要素が要るのではないでしょうか。

[9] [[WinIE]] や [[Gecko]] などは、
[PRE[
+- LEGEND ------------------------+
| Label: Control........          |
| Label: Control........          |
+---------------------------------+
d173 1
d175 119
a293 119
のような既定スタイルを持っています。枠線は[Q[窪み]]です。
(Windoze の設定 dialog box などでよくでてくる、
集団化のためのあれと同じ style です。)

[[#comment]]


** 実装

[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>

[[#comment]]


** 不思議解釈

[1]
''地獄変00:blockquoteはもう古い〜fieldsetの伝説(legend)!!'' <http://blog.livedoor.jp/jigokuhen00/archives/169129.html#content>
([[名無しさん]] [WEAK[2004-03-23 02:15:27 +00:00]])

[2]
>>1 は[[引用]]のために (特定 [[UA]] の見た目の理由から) [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[[[legend]]]] を使おうと提案して叩かれた例。

;; 著者が一日でこんなに叩かれましたと出してる URI がほとんど某方面なのが藁える。

[3]
だけど、 >>1 みたいなことを考える人が出てくるのって、
- [[HTML 3]] の [CODE(HTMLe)[[[credit]]]] や表の [CODE(HTMLe)[[[caption]]]] に相当する要素型が無い
- [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] の典型的レンダリング(謎)を CSS で気軽に(謎)実現する方法がない

のが原因でしょ。それが解決されない限りまた繰り返されるだろうなあ。
(Form control 以外の集団化・見出し付けのために [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] を使うというネタはたしか外出だし。)

[[#comment]]


** 他との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。

[[#comment]]


** 例

[19] 薬暦フォームの例 [SRC[HTML 4 17.10]]
[PRE(HTML)[
<FORM action="[VAR[...]]" method="post">
 <P>
 <FIELDSET>
  <LEGEND>Personal Information</LEGEND>
  Last Name: <INPUT name="personal_lastname" type="text" tabindex="1">
  First Name: <INPUT name="personal_firstname" type="text" tabindex="2">
  Address: <INPUT name="personal_address" type="text" tabindex="3">
  ...more personal information...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Medical History</LEGEND>
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Smallpox" tabindex="20"> Smallpox
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Mumps" tabindex="21"> Mumps
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Dizziness" tabindex="22"> Dizziness
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Sneezing" tabindex="23"> Sneezing
  ...more medical history...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Current Medication</LEGEND>
  Are you currently taking any medication? 
  <INPUT name="medication_now" 
         type="radio" 
         value="Yes" tabindex="35">Yes
  <INPUT name="medication_now" 
         type="radio" 
         value="No" tabindex="35">No
  If you are currently taking medication, please indicate
  it in the space below:
  <TEXTAREA name="current_medication" 
            rows="20" cols="50"
            tabindex="40">
  </TEXTAREA>
 </FIELDSET>
</FORM>
]PRE]

HTML 4 仕様書は、更にスタイル・シートやスクリプトで制御子の位置を揃えたり、
色を変えたり、 [Q[Current Medication]] で [Q[Yes]] と答えた場合のみ
[CODE(HTMLe)[textarea]] を有効にしたりすると更に利用者にとって分かりやすくなるであろうと指摘しています。
([CODE(HTMLe)[[[label]]]] も使った方が良いでしょう。)

[[#comment]]


** メモ

[[#comment]]


@


1.3
log
@auto-committed
@
text
@d1 102
a102 102



* fieldset 要素型 (HTML, XHTML 1)

[5] [DFN[[CODE(HTMLe)[fieldset]] 要素]]は、
[[フォーム]]の[[制御子]]や[RUBY[名札] [ラベル]]をまとめるために使います。

[16]
仕様書: 
- [[HTML 4]] ([[Web Forms 1.0]])
-- [CITE[17.10 Adding structure to forms: the [CODE(HTMLe)[FIELDSET]] and [CODE(HTMLe)[LEGEND]] elements]]
<IW:HTML4:"interact/forms.html#edef-FIELDSET">

[17]
:[[開始タグ]]:必須
:[[終了タグ]]:必須
:[[内容模型]] (HTML 4):[CODE(SGML)[([[空白]], [CODE(HTMLe)[[[legend]]]], (%[[flow]])*)]]
:内容模型 (ISO‐HTML):
[CODE(SGML)[(空白, [CODE(HTMLe)[legend]], (%[[block]] | %[[inline]] | [CODE(HTMLe)[[[address]]]])+) −([CODE(HTMLe)[fieldset]])]]
:出現できる文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
(歴史的変遷: <http://suika.fam.cx/www/2004/html/content-fieldset>)
:[[属性]]:
,属性名	,属性値	,既定値	,説明	,出典
,[CODE(HTMLa)[[[class]]]]	,	,(なし)	,[[級]]	,"[HTML 4] %[[coreattrs]] ⊂ %[[attrs]], [XHTML 1] [[Core]] ⊂ [[Common]]"
,[CODE(HTMLa)[[[dir]]]]	,	,	,[[書字方向]]	,"[HTML 4] %[[i18n]] ⊂ %attrs, [XHTML 1] [[I18N]] ⊂ Common"
,[CODE(HTMLa)[[[id]]]]	,[CODE(SGML)[[[ID]]]]	,(なし)	,一意識別子	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"
,[CODE(HTMLa)[[[lang]]]]	,	,	,[[自然言語]]	,[HTML 4] %i18n ⊂ %attrs
,[CODE(HTMLa)[[[xml]]:lang]]	,	,	,自然言語	,[XHTML 1] I18N ⊂ Common
,[CODE(HTMLa)[[[onclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %[[events]] ⊂ %attrs, [XHTML 1] [[Events]] ⊂ Common"
,[CODE(HTMLa)[[[ondblclick]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeydown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeypress]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeyup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousedown]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousemove]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseout]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseover]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseup]]]]	,[CODE(SGML)[%[[Script]]]]	,(なし)	,	,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[style]]]]	,	,	,スタイル情報	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] [[Style]] ⊂ Common"
,[CODE(HTMLa)[[[title]]]]	,	,	,注釈的題	,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"


[[#comment]]


** 内容模型

[6] [[HTML 4]] の [[DTD]] では、 [CODE(HTMLe)[fieldset]]
要素型の内容模型は [CODE(SGML)[(#[[PCDATA]], [CODE(HTMLe)[LEGEND]], ([VAR[%flow]])*)]]
とされていますが、注釈で、 [CODE(SGML)[#PCDATA]]
は[[混合内容]]問題を解決するためで、
[[空白]]のみが許される、とされています。

もし内容模型が [CODE(SGML)[([CODE(HTMLe)[legend]], ([VAR[%flow]])*)]]
であったとすると、
[PRE(HTML)[
<fieldset>
  <legend/>
  %flow;
</fieldset>
]PRE]

のように [CODE(HTMLe)[legend]] の開始タグの前に空白がある時に、
(この内容模型は [CODE[[VAR[%flow]]]] 内に [CODE(SGML)[#PCDATA]] が含まれているため、混合内容であり、)
その空白が [CODE(SGML)[#PCDATA]] に該当する[[データ]]とされてしまいます。
しかし、 [CODE(HTMLe)[fieldset]] 要素内にはデータより先に
[CODE(HTMLe)[legend]] 要素が必要ですから、非[[妥当]]にされてしまいます。

この問題には、
- [CODE(HTMLe)[legend]] 要素の開始タグは必ず
[CODE(HTMLe)[fieldset]] 要素の開始タグの直後に書く
(字下げは諦める)
- [CODE(HTMLe)[[[textflow]]]] 要素型や [CODE(HTMLe)[[[bodytext]]]] 要素型のようなダミーを用意する
- [CODE(SGML)[#PCDATA]] を許してしまう
(厳密性を諦める)

の三つの解法があります。 HTML 4 は最終的には三番目の解法を
選択しました。

[7] ところで、 HTML 4 DTD 注釈には
[Q[per specification only whitespace is allowed there]<IW:HTML4:"interact/forms.html#h-17.10">]
と書いてありますけど、仕様書のどこに書いてあるのでしょうか?
(HTML 4 DTD 内の注釈は[RUBYB[参考] [informative]]だし、
心許ないなあ。でも ISO‐HTML の注釈は[RUBYB[規定] [normative]]だ。)

[10]
[[XHTML 1]] では、 [[XML]] の制約から、
更に自由な内容模型 [CODE(XML)[(#PCDATA | %[CODE(HTMLe)[legend]].qname; | %[[Flow.mix]];)*]] になってしまっています。

だけど混合内容問題を解決するために〜という注釈は残ったままなので意味不明になっています。 ([CODE(HTMLe)[fieldset]] 内は全く要素か空白しか入れられないように読めてしまう。)
たとえば: <http://www.w3.org/TR/2001/REC-xhtml-modularization-20010410/xhtml-modularization.html#dtdelement_fieldset.qname>

[11]
HTML 4 でも XHTML 1 でも、 [CODE(HTMLe)[form]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることはできませんから、 [CODE(HTMLe)[form]] 要素の子孫である [CODE(HTMLe)[fieldset]] 要素の子孫として [CODE(HTMLe)[form]] 要素を入れることはできません。しかし、
[CODE(HTMLe)[form]] 要素の子孫ではない [CODE(HTMLe)[fieldset]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることは可能のようです。

[15] ISO‐HTML では [CODE(HTMLe)[fieldset]]
要素の入れ子は禁止されています。


[20]
d107 159
a265 159

([[名無しさん]] [sage])


[[#comment]]


** UA による利用

[[#comment]]


*** レンダリング

[8] [CODE(HTMLe)[fieldset]] による集団化情報を使って、
[[視覚UA]] は[[タブ]]を使ったレンダリングができますし、
[[音声UA]] もより分かりやすいレンダリングができます。
従って利用者はよりフォームの制御子等の目的を理解しやすくなり、
文書の[[アクセス可能性]]が高まります。 [SRC[HTML 4 17.10]]

[18]
HTML 4 (というか HTML 3 Form) 
の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な[Q[集団化]]に留まったのでしょう。

しかし、同じ [CODE(HTMLe)[[[form]]]] 内の近隣の
[CODE(HTMLe)[[[fieldset]]]] をまとめてタブ集合として表示する
UA なんて見たことがありません。

実際にタブとしてレンダリングするには [CODE(HTMLe)[[[li]]]]
に対する [CODE(HTMLe)[[[ul]]]] のような包含子要素が要るのではないでしょうか。

[9] [[WinIE]] や [[Gecko]] などは、
[PRE[
+- LEGEND ------------------------+
| Label: Control........          |
| Label: Control........          |
+---------------------------------+
]PRE]

のような既定スタイルを持っています。枠線は[Q[窪み]]です。
(Windoze の設定 dialog box などでよくでてくる、
集団化のためのあれと同じ style です。)

[[#comment]]


** 実装

[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>

[[#comment]]


** 不思議解釈

[1]
''地獄変00:blockquoteはもう古い〜fieldsetの伝説(legend)!!'' <http://blog.livedoor.jp/jigokuhen00/archives/169129.html#content>
([[名無しさん]] [WEAK[2004-03-23 02:15:27 +00:00]])

[2]
>>1 は[[引用]]のために (特定 [[UA]] の見た目の理由から) [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[[[legend]]]] を使おうと提案して叩かれた例。

;; 著者が一日でこんなに叩かれましたと出してる URI がほとんど某方面なのが藁える。

[3]
だけど、 >>1 みたいなことを考える人が出てくるのって、
- [[HTML 3]] の [CODE(HTMLe)[[[credit]]]] や表の [CODE(HTMLe)[[[caption]]]] に相当する要素型が無い
- [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] の典型的レンダリング(謎)を CSS で気軽に(謎)実現する方法がない

のが原因でしょ。それが解決されない限りまた繰り返されるだろうなあ。
(Form control 以外の集団化・見出し付けのために [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] を使うというネタはたしか外出だし。)

[[#comment]]


** 他との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。

[[#comment]]


** 例

[19] 薬暦フォームの例 [SRC[HTML 4 17.10]]
[PRE(HTML)[
<FORM action="[VAR[...]]" method="post">
 <P>
 <FIELDSET>
  <LEGEND>Personal Information</LEGEND>
  Last Name: <INPUT name="personal_lastname" type="text" tabindex="1">
  First Name: <INPUT name="personal_firstname" type="text" tabindex="2">
  Address: <INPUT name="personal_address" type="text" tabindex="3">
  ...more personal information...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Medical History</LEGEND>
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Smallpox" tabindex="20"> Smallpox
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Mumps" tabindex="21"> Mumps
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Dizziness" tabindex="22"> Dizziness
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Sneezing" tabindex="23"> Sneezing
  ...more medical history...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Current Medication</LEGEND>
  Are you currently taking any medication? 
  <INPUT name="medication_now" 
         type="radio" 
         value="Yes" tabindex="35">Yes
  <INPUT name="medication_now" 
         type="radio" 
         value="No" tabindex="35">No
  If you are currently taking medication, please indicate
  it in the space below:
  <TEXTAREA name="current_medication" 
            rows="20" cols="50"
            tabindex="40">
  </TEXTAREA>
 </FIELDSET>
</FORM>
]PRE]

HTML 4 仕様書は、更にスタイル・シートやスクリプトで制御子の位置を揃えたり、
色を変えたり、 [Q[Current Medication]] で [Q[Yes]] と答えた場合のみ
[CODE(HTMLe)[textarea]] を有効にしたりすると更に利用者にとって分かりやすくなるであろうと指摘しています。
([CODE(HTMLe)[[[label]]]] も使った方が良いでしょう。)

[[#comment]]


** メモ

[[#comment]]


@


1.2
log
@auto-committed
@
text
@d1 265
a265 244

* fieldset 要素型 (HTML, XHTML 1)

[5] [DFN[[CODE(HTMLe)[fieldset]] 要素]]は、
[[フォーム]]の[[制御子]]や[RUBY[名札][ラベル]]をまとめるために使います。

[16]
仕様書: 
- [[HTML 4]] ([[Web Forms 1.0]])
-- [CITE[17.10 Adding structure to forms: the [CODE(HTMLe)[FIELDSET]] and [CODE(HTMLe)[LEGEND]] elements]]
<IW:HTML4:"interact/forms.html#edef-FIELDSET">

[17]
:[[開始タグ]]:必須
:[[終了タグ]]:必須
:[[内容模型]] (HTML 4):[CODE(SGML)[([[空白]], [CODE(HTMLe)[[[legend]]]], (%[[flow]])*)]]
:内容模型 (ISO‐HTML):
[CODE(SGML)[(空白, [CODE(HTMLe)[legend]], (%[[block]] | %[[inline]] | [CODE(HTMLe)[[[address]]]])+) −([CODE(HTMLe)[fieldset]])]]
:出現できる文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
(歴史的変遷: <http://suika.fam.cx/www/2004/html/content-fieldset>)
: [[属性]] :
,属性名,属性値,既定値,説明,出典
,[CODE(HTMLa)[[[class]]]],,(なし),[[級]],"[HTML 4] %[[coreattrs]] ⊂ %[[attrs]], [XHTML 1] [[Core]] ⊂ [[Common]]"
,[CODE(HTMLa)[[[dir]]]],,,[[書字方向]],"[HTML 4] %[[i18n]] ⊂ %attrs, [XHTML 1] [[I18N]] ⊂ Common"
,[CODE(HTMLa)[[[id]]]],[CODE(SGML)[[[ID]]]],(なし),一意識別子,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"
,[CODE(HTMLa)[[[lang]]]],,,[[自然言語]],"[HTML 4] %i18n ⊂ %attrs"
,[CODE(HTMLa)[[[xml]]:lang]],,,自然言語     ,"[XHTML 1] I18N ⊂ Common"
,[CODE(HTMLa)[[[onclick]]]]   ,[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %[[events]] ⊂ %attrs, [XHTML 1] [[Events]] ⊂ Common"
,[CODE(HTMLa)[[[ondblclick]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeydown]]]] ,[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeypress]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onkeyup]]]]   ,[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousedown]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmousemove]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseout]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseover]]]],[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[onmouseup]]]] ,[CODE(SGML)[%[[Script]]]],(なし),,"[HTML 4] %events ⊂ %attrs, [XHTML 1] Events ⊂ Common"
,[CODE(HTMLa)[[[style]]]]   ,,,スタイル情報 ,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] [[Style]] ⊂ Common"
,[CODE(HTMLa)[[[title]]]]   ,,,注釈的題     ,"[HTML 4] %coreattrs ⊂ %attrs, [XHTML 1] Core ⊂ Common"


[[#comment]]

** 内容模型

[6] [[HTML 4]] の [[DTD]] では、 [CODE(HTMLe)[fieldset]]
要素型の内容模型は [CODE(SGML)[(#[[PCDATA]], [CODE(HTMLe)[LEGEND]], ([VAR[%flow]])*)]]
とされていますが、注釈で、 [CODE(SGML)[#PCDATA]]
は[[混合内容]]問題を解決するためで、
[[空白]]のみが許される、とされています。

もし内容模型が [CODE(SGML)[([CODE(HTMLe)[legend]], ([VAR[%flow]])*)]]
であったとすると、
[PRE(HTML)[
<fieldset>
  <legend/>
  %flow;
</fieldset>
]PRE]

のように [CODE(HTMLe)[legend]] の開始タグの前に空白がある時に、
(この内容模型は [CODE[[VAR[%flow]]]] 内に [CODE(SGML)[#PCDATA]] が含まれているため、混合内容であり、)
その空白が [CODE(SGML)[#PCDATA]] に該当する[[データ]]とされてしまいます。
しかし、 [CODE(HTMLe)[fieldset]] 要素内にはデータより先に
[CODE(HTMLe)[legend]] 要素が必要ですから、非[[妥当]]にされてしまいます。

この問題には、
- [CODE(HTMLe)[legend]] 要素の開始タグは必ず
[CODE(HTMLe)[fieldset]] 要素の開始タグの直後に書く
(字下げは諦める)
- [CODE(HTMLe)[[[textflow]]]] 要素型や [CODE(HTMLe)[[[bodytext]]]] 要素型のようなダミーを用意する
- [CODE(SGML)[#PCDATA]] を許してしまう
(厳密性を諦める)

の三つの解法があります。 HTML 4 は最終的には三番目の解法を
選択しました。

[7] ところで、 HTML 4 DTD 注釈には
[Q[per specification only whitespace is allowed there]<IW:HTML4:"interact/forms.html#h-17.10">]
と書いてありますけど、仕様書のどこに書いてあるのでしょうか?
(HTML 4 DTD 内の注釈は[RUBYB[参考] [informative]]だし、
心許ないなあ。でも ISO‐HTML の注釈は[RUBYB[規定][normative]]だ。)

[10]
[[XHTML 1]] では、 [[XML]] の制約から、
更に自由な内容模型 [CODE(XML)[(#PCDATA | %[CODE(HTMLe)[legend]].qname; | %[[Flow.mix]];)*]] になってしまっています。

だけど混合内容問題を解決するために〜という注釈は残ったままなので意味不明になっています。 ([CODE(HTMLe)[fieldset]] 内は全く要素か空白しか入れられないように読めてしまう。)
たとえば: <http://www.w3.org/TR/2001/REC-xhtml-modularization-20010410/xhtml-modularization.html#dtdelement_fieldset.qname>


[11]
HTML 4 でも XHTML 1 でも、 [CODE(HTMLe)[form]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることはできませんから、 [CODE(HTMLe)[form]] 要素の子孫である [CODE(HTMLe)[fieldset]] 要素の子孫として [CODE(HTMLe)[form]] 要素を入れることはできません。しかし、
[CODE(HTMLe)[form]] 要素の子孫ではない [CODE(HTMLe)[fieldset]] 要素の子孫に [CODE(HTMLe)[form]] 要素を入れることは可能のようです。

[15] ISO‐HTML では [CODE(HTMLe)[fieldset]]
要素の入れ子は禁止されています。

[[#comment]]


** UA による利用
[[#comment]]
*** レンダリング

[8] [CODE(HTMLe)[fieldset]] による集団化情報を使って、
[[視覚UA]] は[[タブ]]を使ったレンダリングができますし、
[[音声UA]] もより分かりやすいレンダリングができます。
従って利用者はよりフォームの制御子等の目的を理解しやすくなり、
文書の[[アクセス可能性]]が高まります。 [SRC[HTML 4 17.10]]

[18]
HTML 4 (というか HTML 3 Form) 
の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な[Q[集団化]]に留まったのでしょう。

しかし、同じ [CODE(HTMLe)[[[form]]]] 内の近隣の
[CODE(HTMLe)[[[fieldset]]]] をまとめてタブ集合として表示する
UA なんて見たことがありません。

実際にタブとしてレンダリングするには [CODE(HTMLe)[[[li]]]]
に対する [CODE(HTMLe)[[[ul]]]] のような包含子要素が要るのではないでしょうか。

[9] [[WinIE]] や [[Gecko]] などは、
[PRE[
+- LEGEND ------------------------+
| Label: Control........          |
| Label: Control........          |
+---------------------------------+
]PRE]

のような既定スタイルを持っています。枠線は[Q[窪み]]です。
(Windoze の設定 dialog box などでよくでてくる、
集団化のためのあれと同じ style です。)

[[#comment]]

** 実装

[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>

[[#comment]]
** 不思議解釈

[1]
''地獄変00:blockquoteはもう古い〜fieldsetの伝説(legend)!!'' <http://blog.livedoor.jp/jigokuhen00/archives/169129.html#content>
([[名無しさん]] [WEAK[2004-03-23 02:15:27 +00:00]])

[2]
>>1 は[[引用]]のために (特定 [[UA]] の見た目の理由から) [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[[[legend]]]] を使おうと提案して叩かれた例。

;; 著者が一日でこんなに叩かれましたと出してる URI がほとんど某方面なのが藁える。


[3]
だけど、 >>1 みたいなことを考える人が出てくるのって、
- [[HTML 3]] の [CODE(HTMLe)[[[credit]]]] や表の [CODE(HTMLe)[[[caption]]]] に相当する要素型が無い
- [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] の典型的レンダリング(謎)を CSS で気軽に(謎)実現する方法がない

のが原因でしょ。それが解決されない限りまた繰り返されるだろうなあ。
(Form control 以外の集団化・見出し付けのために [CODE(HTMLe)[fieldset]] + [CODE(HTMLe)[legend]] を使うというネタはたしか外出だし。)

[[#comment]]

** 他との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。

[[#comment]]

** 例

[19] 薬暦フォームの例 [SRC[HTML 4 17.10]]
[PRE(HTML)[
<FORM action="[VAR[...]]" method="post">
 <P>
 <FIELDSET>
  <LEGEND>Personal Information</LEGEND>
  Last Name: <INPUT name="personal_lastname" type="text" tabindex="1">
  First Name: <INPUT name="personal_firstname" type="text" tabindex="2">
  Address: <INPUT name="personal_address" type="text" tabindex="3">
  ...more personal information...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Medical History</LEGEND>
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Smallpox" tabindex="20"> Smallpox
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Mumps" tabindex="21"> Mumps
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Dizziness" tabindex="22"> Dizziness
  <INPUT name="history_illness" 
         type="checkbox" 
         value="Sneezing" tabindex="23"> Sneezing
  ...more medical history...
 </FIELDSET>
 <FIELDSET>
  <LEGEND>Current Medication</LEGEND>
  Are you currently taking any medication? 
  <INPUT name="medication_now" 
         type="radio" 
         value="Yes" tabindex="35">Yes
  <INPUT name="medication_now" 
         type="radio" 
         value="No" tabindex="35">No

  If you are currently taking medication, please indicate
  it in the space below:
  <TEXTAREA name="current_medication" 
            rows="20" cols="50"
            tabindex="40">
  </TEXTAREA>
 </FIELDSET>
</FORM>
]PRE]

HTML 4 仕様書は、更にスタイル・シートやスクリプトで制御子の位置を揃えたり、
色を変えたり、 [Q[Current Medication]] で [Q[Yes]] と答えた場合のみ
[CODE(HTMLe)[textarea]] を有効にしたりすると更に利用者にとって分かりやすくなるであろうと指摘しています。
([CODE(HTMLe)[[[label]]]] も使った方が良いでしょう。)

[[#comment]]
** メモ
[[#comment]]


@


1.1
log
@auto-committed
@
text
@a0 2
#?SuikaWiki/0.9

d5 7
a11 3
form control や label を集団化します。
集団化すると利用者は control や label 
の目的を理解しやすくなります。
d13 1
d19 21
a39 20
:出現可能文脈:[CODE(SGML)[%[[block]]]] が出現できる場所。
ただし、 [CODE(HTMLe)[[[button]]]] 要素の子孫を除く。
:[[属性]]:
,[CODE(HTMLa)[[[class]]]]	,	,	,[[級]]	,"[HTML4] %[[coreattr]], [ISO-HTML] %[[core]], [XHTML 1] [[Core]]"
,[CODE(HTMLa)[[[dir]]]]	,	,	,[[書字方向]]	,"[HTML4] %[[i18n]], [ISO-HTML] %i18n, [XHTML 1] [[Bi-directional Text]]"
,[CODE(HTMLa)[[[id]]]]	,	,	,一意識別子	,"[HTML4] %coreattr, [ISO-HTML] %core, [XHTML 1] Core"
,[CODE(HTMLa)[[[lang]]]]	,	,	,[[自然言語]]	,"[HTML4] %i18n, [ISO-HTML] %i18n"
,[CODE(HTMLa)[[[xml]]:lang]]	,	,	,自然言語	,[XHTML 1] [[I18N]]
,[CODE(HTMLa)[[[onclick]]]]	,	,	,	,"[HTML4] %[[events]], [XHTML 1] [[Intrinsic Events]]"
,[CODE(HTMLa)[[[ondblclick]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onkeydown]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onkeypress]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onkeyup]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onmousedown]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onmouseout]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onmousemove]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onmouseover]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[onmouseup]]]]	,	,	,	,"[HTML4] %events, [XHTML 1] Intrinsic Events"
,[CODE(HTMLa)[[[style]]]]	,	,	,スタイル情報	,"[HTML4] %coreattr, [XHTML 1] [[Style Attribute]]"
,[CODE(HTMLa)[[[title]]]]	,	,	,注釈的題	,"[HTML4] %coreattr, [ISO-HTML] %core, [XHTML 1] Core"
a41 2
仕様書: <IW:HTML4:"interact/forms.html#edef-FIELDSET">

a100 17
** 他の要素型等との関係

[12] [CODE(HTMLe)[[[legend]]]] 要素型は、必ず
[CODE(HTMLe)[fieldset]] 要素型とセットで使用します。

[13] [CODE(HTMLe)[[[input]]]] 要素や
[CODE(HTMLe)[[[button]]]] 要素 ([CODE(HTMLa)[[[type]]]]
が [CODE(HTML)[[[reset]]]]) を [CODE(HTMLe)[fieldset]]
要素内で使用すると、適用範囲 (初期化される範囲)
は [CODE(HTMLe)[fieldset]] 要素内に限定されます。

[14] [CODE(HTMLe)[input]] 要素 ([CODE(HTMLa)[type]]
が [CODE(HTML)[[[file]]]]) は典型的に 
[CODE(HTMLe)[fieldset]] により (ブラウザ内部的に) 
構造化されると [[ISO-HTML]] 利用者の指針
<http://purl.org/NET/ISO+IEC.15445/Users-Guide.html#CL.I.FILE>
に書いてあります。
d102 1
d104 1
d106 10
a115 7
** レンダリング

[8] HTML 4 仕様書は、視覚 UA は[[タブ]]付け誘導が可能、
発話 UA は発話誘導が可能だと言っています。

HTML 4 (というか HTML 3 Form) の最初期の草案ではもろにタブをマークする方法も検討されていたこともあったようですが、
最終的にレンダリングに中立な集団化に留まったのでしょう。
d121 3
d132 1
a132 1
のような既定スタイルを持っています。枠線は“窪み”です。
d138 1
d140 5
a144 1
** メモ
d154 1
a154 1
([[名無しさん]])
d164 75
a238 2
[4]
''iCabのぺ〜じ - A氏からの手紙(FIELDSETの扱いについて)'' <http://www.gld.mmtr.or.jp/~tanico/Ah/001Al.html>
d240 2
@

