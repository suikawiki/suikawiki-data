head	1.1;
access;
symbols
	suika-20100509:1.1
	before-graph-20090923:1.1;
locks; strict;
comment	@# @;
expand	@b@;


1.1
date	2008.11.17.02.02.32;	author wakaba;	state Exp;
branches;
next	;


desc
@@


1.1
log
@converted from SuikaWiki3 <http://suika.fam.cx/gate/cvs/suikawiki/wikidata/page/CAD1BFF4C2ABC7FBCDD7C1C7.txt>
@
text
@#?SuikaWiki/0.9
[1] [[XSLT]] では、3種類の[[変数]]を[[束縛]]できる[[要素型]]があります。
-[CODE(XSLTe)[[VAR[xslt:]][[variable]]]] : 変数の束縛 <http://www.w3.org/TR/xslt#element-variable>
-[CODE(XSLTe)[[VAR[xslt:]][[param]]]] : 引数の束縛 <http://www.w3.org/TR/xslt#element-param>
-[CODE(XSLTe)[[VAR[xslt:]][[with-param]]]] : 引数の束縛 (雛形呼出し時) <http://www.w3.org/TR/xslt#element-with-param>

(variable と parameter は同じ名前空間にあって、
両者をまとめて変数といいます。
Variable と parameter は幾つかの場面では扱いが異なりますが、
多くの場合では同じ扱いになります。)

属性:
,[CODE(XSLTa)[[[name]]]],[[QName]],(必須),変数名
,[CODE(XSLTa)[[[select]]]],[[式]] ,(内容),値

[2]
- [CODE(XSLTa)[select]] 属性が指定されている場合、
この式を評価した結果を変数の値とします。
- [CODE(XSLTa)[select]] 属性が指定されていない場合、
要素の内容を雛形として評価した結果を変数の値とします。
但しこの型は[[結果木素片]]となります。
-- 結果木素片では、[[根節]] ([[DOM]] では[[文書素片節]]に当たる。) の下に雛形によって生成された節が生えます。
-- [[基底URI]] の情報も保存されます。
基底 URI をもてないはずの[[文節]]などでどうするかについては触れられていないんですが、どうしたらいいんでしょう?
-- 根節の直下には[[属性節]]や[[名前空間節]]は来れません。
[[誤り]]となり、通知するか、又は無視することで回復しなければなりません。
- 但し、 [CODE(XSLTa)[select]] 属性が指定されておらず、
要素の内容が空である場合には、変数の値は空文字列とします。

[3] 新しい名前の変数が定義される時に、
同じ名前の変数が定義済みである場合には、
元の束縛は[DFN[[[影]]]]化 (shadow) します。
新しい変数束縛の有効範囲から出たら元の変数束縛が復活します。
[WEAK[[[perl]] でいう [[my]] とか [[local]] みたいなものですな。]]

但し、同じ雛形内で束縛された変数が影化するのは[[誤り]]です。
([[最上位要素]]として束縛された変数を別途雛形内で束縛するのは構いません。)

ちなみに、 XSLT では変数の代入の概念がありません。

[4] 最上位要素として使う場合、
同じ名前の変数が同じ[[輸入優先度]]で束縛されれば誤りとなります。
通知するか、又は最後のものを採用しなければなりません。

最上位要素の変数既定値決定に当たっては、[[現在節]]は[[根節]]、
現在節並びは根節だけの並びになります。

最上位要素の変数既定値決定に当たって変数 [VAR(XPath)[$x]]
が必要であれば、先に変数 [VAR(XPath)[$x]]
の既定値を確定します。
直接又は間接に自身を参照している場合は誤りとします。

- [5] [CODE[param]] の方は既定値なので、そのスタイル・シートや雛形の外側から値を与えることが出来ます。雛形に引数を与える時は [CODE(XSLTe)[[VAR[xslt:]]with-param]] を [CODE(XSLTe)[[VAR[xslt:]][[apply-templates]]]] 又は [CODE(XSLTe)[[VAR[xslt:]][[call-template]]]] の子として使います。スタイル・シートの引数 (最上位要素として宣言された変数束縛) の値の設定方法は実装依存です。
- [6] [CODE(XSLTe)[[VAR[xslt:]]param]] 要素は [CODE(XSLTe)[[VAR[xslt:]][[template]]]] 要素の最初の部分になければなりません。 [CODE(XSLTe)[[VAR[xslt:]]param]] 要素は雛形中の禁止されていない任意の場所で使えます。いずれの要素も最上位要素としても使えます。

[7] [CODE(XSLTe)[[VAR[xslt:]]with-param]] 要素を使って、雛形で定義されていない引数を与えることは問題ありません。 [CODE(XSLTe)[[VAR[xslt:]]with-param]] 要素で同じ名前の引数を複数個与えた場合どうなるかは仕様書には載ってません。

[8] >>7 誤りになりました。
<http://www.w3.org/1999/11/REC-xslt-19991116-errata/#E16>
最後の〜という回復の規定は''ありません''。

@
