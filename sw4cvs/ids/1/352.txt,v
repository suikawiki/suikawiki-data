head	1.38;
access;
symbols
	suika-20100509:1.12
	before-graph-20090923:1.11;
locks; strict;
comment	@# @;
expand	@b@;


1.38
date	2014.01.05.08.40.57;	author wakaba;	state Exp;
branches;
next	1.37;

1.37
date	2013.11.28.14.22.46;	author wakaba;	state Exp;
branches;
next	1.36;

1.36
date	2013.11.28.06.03.03;	author wakaba;	state Exp;
branches;
next	1.35;

1.35
date	2013.10.14.23.00.41;	author wakaba;	state Exp;
branches;
next	1.34;

1.34
date	2013.09.29.02.19.48;	author wakaba;	state Exp;
branches;
next	1.33;

1.33
date	2013.09.17.00.52.59;	author wakaba;	state Exp;
branches;
next	1.32;

1.32
date	2013.07.13.01.22.38;	author wakaba;	state Exp;
branches;
next	1.31;

1.31
date	2013.06.15.15.05.49;	author wakaba;	state Exp;
branches;
next	1.30;

1.30
date	2013.03.30.06.42.37;	author wakaba;	state Exp;
branches;
next	1.29;

1.29
date	2013.02.22.08.27.21;	author wakaba;	state Exp;
branches;
next	1.28;

1.28
date	2012.11.17.13.33.58;	author wakaba;	state Exp;
branches;
next	1.27;

1.27
date	2012.11.17.13.13.58;	author wakaba;	state Exp;
branches;
next	1.26;

1.26
date	2012.11.05.23.25.07;	author wakaba;	state Exp;
branches;
next	1.25;

1.25
date	2012.09.29.01.19.38;	author wakaba;	state Exp;
branches;
next	1.24;

1.24
date	2012.06.13.12.00.20;	author wakaba;	state Exp;
branches;
next	1.23;

1.23
date	2012.01.15.09.22.12;	author wakaba;	state Exp;
branches;
next	1.22;

1.22
date	2012.01.15.09.17.08;	author wakaba;	state Exp;
branches;
next	1.21;

1.21
date	2011.10.23.10.08.03;	author wakaba;	state Exp;
branches;
next	1.20;

1.20
date	2011.10.22.12.58.05;	author wakaba;	state Exp;
branches;
next	1.19;

1.19
date	2011.10.10.12.13.16;	author wakaba;	state Exp;
branches;
next	1.18;

1.18
date	2011.10.10.12.09.08;	author wakaba;	state Exp;
branches;
next	1.17;

1.17
date	2011.10.10.10.09.13;	author wakaba;	state Exp;
branches;
next	1.16;

1.16
date	2011.08.20.03.27.24;	author wakaba;	state Exp;
branches;
next	1.15;

1.15
date	2011.04.03.08.37.46;	author wakaba;	state Exp;
branches;
next	1.14;

1.14
date	2010.09.20.05.54.36;	author wakaba;	state Exp;
branches;
next	1.13;

1.13
date	2010.09.20.05.42.34;	author wakaba;	state Exp;
branches;
next	1.12;

1.12
date	2010.02.06.12.31.35;	author wakaba;	state Exp;
branches;
next	1.11;

1.11
date	2009.09.16.23.43.52;	author wakaba;	state Exp;
branches;
next	1.10;

1.10
date	2009.08.23.11.57.37;	author wakaba;	state Exp;
branches;
next	1.9;

1.9
date	2009.08.06.23.19.55;	author wakaba;	state Exp;
branches;
next	1.8;

1.8
date	2009.02.11.01.07.42;	author wakaba;	state Exp;
branches;
next	1.7;

1.7
date	2009.02.10.02.42.43;	author wakaba;	state Exp;
branches;
next	1.6;

1.6
date	2008.12.28.11.25.09;	author wakaba;	state Exp;
branches;
next	1.5;

1.5
date	2008.12.15.11.04.13;	author wakaba;	state Exp;
branches;
next	1.4;

1.4
date	2008.12.15.11.02.10;	author wakaba;	state Exp;
branches;
next	1.3;

1.3
date	2008.11.25.11.34.58;	author wakaba;	state Exp;
branches;
next	1.2;

1.2
date	2008.11.22.23.54.47;	author wakaba;	state Exp;
branches;
next	1.1;

1.1
date	2008.11.11.23.49.16;	author wakaba;	state Exp;
branches;
next	;


desc
@@


1.38
log
@updated by (anon)
@
text
@
[38]
本稿では、 [Q@@en[lang]] と呼ばれるものについて説明しています。
[Q@@en[lang]] は[[英語]]の [Q@@en[[[language]]]]
の省略形として非常に良く用いられる語で、
文脈によって[[自然言語]]を指したり[[プログラム言語]]、
[[マーク付け言語]]その他、あるいはそれらをまとめて指したりします。

[[自然言語]]を指定する[[プロトコル要素]]等に関しては、
[Q[[[言語情報]]]]の項も併せてご覧下さい。


* lang 属性 (HTML, XHTML 1)

[11] [[HTML]] のほとんどの[[要素型]]で定義されている[[属性]]
[CODE(HTMLa)[lang]] は、その[[要素]]の[[属性値]]および文[[内容]]
(text content) の基底言語 (base language) を指定します。

この属性の値は [CODE(SGML)[%[[LanguageCode]];]] 型 ([[IETF]] の[[言語札]])
であり、[[大文字]]・[[小文字]]は区別されません。
既定値は[RUBYB[未知] [unknown]]です。

[25]
仕様書:
- [[HTML 4]]
-- [CODE(HTMLa)[lang]] 属性 <IW:HTML4:"struct/dirlang.html#adef-lang">
- [[XHTML 1.0]]
-- [CSECTION[C.7. The [CODE(HTMLa)[lang]] and [CODE(HTMLa)[xml:lang]] Attributes]]
(参考) <IW:XHTML10:"C_7">

[15] なお、ここで[[言語]]とは[[自然言語]]であって、
[[プログラム言語]]は除外されています。
(<IW:HTML4:"struct/dirlang.html#langcodes"> 参照。)

[12] この属性の値は、 [[UA]] が種々の用途で使います。
<IW:HTML4:"struct/dirlang.html#idx-language-1"> に挙げられている例としては:
- [[検索円陣]]の補助情報
- [[発話合成]]の補助情報
- 高品質[[写植]]のための[[異体グリフ]]選択の補助
- [[引用符]]集合を選ぶための補助
- [[ハイフン付け]], [[合字]] ([[リガチャ]]), [[文字間]]の決定の補助
- 綴り検査・文法検査の補助情報

があります。

[13] [CODE(HTMLa)[lang]] 属性の意図は、 UA が特定言語における旧来の文化的慣習に基づいてより有意義に内容を[[描画]]できるようにということにあります。
UA に特定言語では型破りな文字をさほど意味のない方法で描画することを求めるものではありません。
UA は、 [CODE(HTMLa)[lang]] 属性で指定された値に関わらず、
全ての文字を描画するように最前の努力をなさなければなりません [HTML4]。

という良く分からない文章の心は、 [CODE(HTML)[[CODE(HTMLa)[lang]]=en]]
にしたら (そうしなければ表示されていたはずの) 漢字が[[豆腐]]とかに化けてしまう糞 UA
逝っとくれと、そういうことですかねぇ。 >>4 の例からみても。違いますか?

[[#comment]]


** 代替

[24] [[XHTML 1.0]] で [[XML]] の
[CODE(XMLa)[[[xml]]:lang]] 属性が [[XHTML]] 
に取り入れられました。

[[XHTML 1.0]] 互換性指針によれば、[WEAK[互換性指針に従う文書は]] 
[CODE(HTMLa)[lang]] と [CODE(HTMLa)[xml:lang]] の両方を指定するべきです。
[CODE(HTMLa)[xml:lang]] が優先されます。 [SRC[XHTML 1.0 C.7]]

[[#comment]]


** 継承

[16] ある要素の言語は、次の情報から決定されます。
(先のものが優先度が高い。)

= その要素の [CODE(HTMLa)[lang]] 属性値
= 一番近い [CODE(HTMLa)[lang]] 属性を持つ要素の [CODE(HTMLa)[lang]] 属性値
-- 一般には、[[先祖要素]]
-- [[表]]の[[こま]]では、その[[行]]の最初のこまだったりもする。
= [[HTTP]] の [CODE(HTTP)[[[Content-Language]]]] 頭欄
= [[UA]] の既定値・利用者の設定

(<IW:HTML4:"struct/dirlang.html#h-8.1.2"> 参照。)
[17] 実際には HTML は HTTP 以外でも使われますから、 HTTP
に限らず転送プロトコル一般の言語情報を第3位と解釈するのがよいでしょう。

転送プロトコルが複数組み合わされる場合は (各プロトコル(群)で特に規定がある場合はそれによるとし、そうでない場合は) 内側の (HTML 文書に近い) プロトコルの情報が優先されるとするのがよいでしょう。

[18] [CODE(HTMLa)[[[http-equiv]]]] な [CODE(HTMLe)[[[meta]]]] 要素を使って
[CODE(HTTP)[Content-Language]] を指定する方法も実際には良く使われています。
HTML 4 が触れていない以上、厳密に HTML 4 に従う UA
では無視するのが良いのかもしれませんが、現実路線(謎)の UA
は HTTP など上位プロトコルが言語情報を持たないときにはこれを参照してもよいのではないでしょうか。

[19] ところで、 HTTP では [SAMP(HTTP)[Content-Language: ja, en]]
のように複数の言語を指定できるのですが、 HTML 4 ではできません。
実装者はその辺注意されたし。

[22]
表の中では [CODE(SGML)[%[[cellvalign]]]]
と同じ継承規則が使われると HTML 4
では規定されています。

[[#comment]]


** 言語札の階層性

[10] 言語札は [SAMP(lang)[ja-JP]], [SAMP(lang)[en-US]] 
のような階層構造を持っています。

HTML 4 は、言語情報による処理に際して、まず全体の一致を試み、
次に最初の部分の一致によるべきだとしています。
<IW:HTML4:"struct/dirlang.html#h-8.1.3"> 参照。

こうすれば、たとえ [SAMP(lang)[ja-JP]] の処理を知らなくても、
[SAMP(lang)[ja]] の処理さえ知っていれば、それなりの結果が期待できます。

[[#comment]]


** 歴史

[26]
仕様書:
- [DEL[[[RFC 2070]] ([[IETF]] [[提案標準]])]] ([[廃止]])
-- [CSECTION@@en[3. The LANG attribute]]

[27]
[[標準]]として最初に [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]が [[HTML]] に導入されたのは [[HTML 2.x]]
([[RFC 2070]]) でした。 [[HTML 2.x]] ではすべての[[要素型]]のうち、
意味をなさないと考えられた
[CODE(HTMLe)@@en[[[br]]]], [CODE(HTMLe)@@en[[[hr]]]],
[CODE(HTMLe)@@en[[[base]]]], [CODE(HTMLe)@@en[[[nextid]]]], 
[CODE(HTMLe)@@en[[[meta]]]]
''以外''すべてに [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]が追加されました [SRC[[[RFC 2070]] 3.]]。

[28]
[[RFC 2070]] は[[属性値]]として [[RFC 1766]]
の[[言語札]]を参照しつつも構文と意味を独自に規定
[WEAK[(というか[[コピペ]])]] していました。
>>10 の階層的比較に関する規定や >>16
の継承に関する規定もありました。

[36] '''XHTML m12n における事実上の廃止'''
[[XHTML m12n]] では[[抽象モジュール]]定義に [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]は含まれず、[[遺物再定義]] [[DTDモジュール]]の定義にひっそり含まれています。

[[XHTML m12n]] を基に構築されている [[XHTML 1.1]] や [[XHTML Basic]]
にはそもそも[[遺物]]モジュールが取込まれていませんから、
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]は存在しません。

仕様書:
- [[XHTML m12n]]
-- [[遺物再定義]] [[DTDモジュール]]
<IW:XHTML1m12n:"dtd_module_defs.html#a_module_Legacy_Redeclarations">

[49] [CITE@@en[XHTML+RDFa and @@lang]] ([[Shane McCarron]] 著, [TIME[2009-01-30 02:21:49 +09:00]] 版) <http://lists.w3.org/Archives/Public/public-xhtml2/2009Jan/0110.html>

>
The XHTML 2 Working Group has been asked to re-introduce the lang 
attribute into XHTML family languages.  Basically this is so that 
assistive technologies will correctly identify the language of content. 
>  It will also address some issues that arise when content is
served up as text/html instead of application/xhtml+xml.



** 例

[14] [HTML4] から。
[PRE[
<P><Q lang="en">Her super-powers were the result of
&gamma;-radiation,</Q> he explained.</P>
]PRE]

- UA は、英語の内容を適切な方法の描画 (たとえば引用符の取り扱い) を試みるべきです。
- UA は、英語の文字でなくても最前の努力でもって表示を試みなければなりません。

([CODE(HTMLe)[p]] 要素またはそれより上位の要素でも [CODE(HTML)[[CODE(HTMLa)[lang]]=en]] とちゃんと指定しておかないと、引用符は決定できないと思うのですけどねぇ。)

[23]
[[英語]]の文章の中に[[日本語]]
([[羅馬字]]表記) が混じっている例

[PRE(HTML example)[
<p>Horizontal in vertical ("<span lang="ja">Tate-chu-yoko</span>")
</p>
]PRE]

> [SAMP(HTML)[In Japanese, this effect is known as <a href="#g-tatechuyoko">"<span lang="ja">Tate</span>-<span lang="ja">chu</span>-<span lang="ja">yoko</span>"</a>.]]

共に出典は
[CITE[CSS3 Text Module]] 
<http://www.w3.org/TR/2003/CR-css3-text-20030514/#writing-mode>

[[#comment]]


** 関連

[39] '''文字コードとの関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]は、
[[文字コード]] ([[符号化文字集合]]や[[符号化方式]])
とは[[直交]]するものです。[[文字コード]]の選択によって
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]の要/不要や値が影響を受けることは''ありません''。

[40] '''文字種との関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]による[[言語]]の指定は、
その[[要素]]の[[内容]]として使われる[[文字]]の種類
([[用字系]]や[[正書法]]等) とは直接は関係''ありません''。

[[言語]]と[[文字]]の種類の間には元々強い関係が存在するので、
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]と[[内容]]の[[文字]]にも強い関係が認められますが、
それ以上の制約は存在しません。例えば、 [CODE(HTMLa)@@en[[[lang]]]]
が [CODE(lang)@@en[[[ja]]]] で、[[内容]]が[[アラビア文字]]であったとしても、
(それが[[日本語]]を表記したものなら) 何ら問題ありません。

[41] '''レンダリングとの関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]による[[言語]]の指定は、
その[[要素]]の[[内容]]を[[視覚的]]、[[音声]]、その他の方法によって適切に[[レンダリング]]するための情報の1つとして利用されます。

[[#comment]]


** メモ

[37]
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]が [[XML]] に取込まれて
[CODE(XMLa)@@en[[[xml]]:[[lang]]]] [[属性]]となった背景には、
[[XLink 1.0]] と同様に、 [[HTML]] に限らず汎用的に使えそうなものは [[XML]]
系[[マーク付け言語]]共用の語彙にしてしまおうという思惑が見え隠れしています。

それ自体は至極結構なことですが、それがために旧来の [[HTML]]
と [[XHTML 1]] の致命的な断絶を招いてしまいました。言語属性の普及状況がいまいちなのも
[[XHTML 1]] の普及状況がいまいちなのもこの問題が大きな原因の
1つだというのは言い過ぎでしょうか。

[42]
[CITE@@en-US[Internationalization Best Practices: Specifying Language in XHTML & HTML Content]] ([CODE[2007-02-16 05:52:24 +09:00]] 版) <http://www.w3.org/International/geo/html-tech/tech-lang.html>
([[名無しさん]])

[44]
[CITE@@en[lang attributes accross (X)HTML versions - W3C Q&A Weblog]] ([CODE[2007-08-31 19:12:14 +09:00]] 版) <http://www.w3.org/QA/2007/08/xhtml-html-lang-attributes.html>

[47] [CITE@@en[MAMA: Common attributes - Opera Developer Community]] ([TIME[2008-11-25 20:33:55 +09:00]] 版) <http://dev.opera.com/articles/view/mama-common-attributes/#lang>

* xml:lang 属性 (XML)

- [4] [[xml]]:lang 特殊属性: <http://www.w3.org/TR/REC-xml#sec-lang-tag>
- [3] [[XSL-FO]] の [CODE(XML)[xml:lang]] 属性の値には [CODE(XSL)[inherit]] を指定できます。 ([[言語札]>>40] 参照)
- 
[5] XML 1.0 [ABBR[FE] [First Edition]] では[[言語札]]の構文も定義されていました (<http://www.w3.org/TR/1998/REC-xml-19980210#sec-lang-tag>) が、 [ABBR[SE] [Second Edition]] では RFC に一任されています。

[7] XML 1.0 [[SE]] Errata では重大な変更が加えられています。型が [CODE(SGML)[[[NMTOKEN]]]] から [CODE(SGML)[[[CDATA]]]] に変更され、空文字列が認められました。
- [8] >>7 空文字列だと言語指定取消し (指定なし。) になります。 ([[XML名前空間]]の 1.1 版と似たような変更ですね。) ''Errata in REC-xml-20001006'' <http://www.w3.org/XML/xml-V10-2e-errata#E41>

[21]
[CODE(lang)[[[und]]]] (決定できない) という言語札もあったりしますが、空文字列はもっと積極的に、どの言語にも属さない場合 (絵とか) に使う、のではないでしょうかねぇ。
([[名無しさん]])

[35]
[[XInclude 1.0]] では言語情報を[[取込み]]の前後で保存するために
[CODE(InfoProp)[[[言語]]]][[特性]]を定義し、
[CODE(XMLa)@@en[[[xml]]:[[lang]]]] 属性 (とそこに記された情報)
の処理を規定しています。

** 応用

[46] [[Atom 1.0]] や [[AtomPub]] や [[RFC 6721]] で定義されたすべての[[要素]]は [CODE(XMLa)@@en[[[xml]]:[[lang]]]]
[[属性]]を持つことができます。どちらの仕様でも指定された[[言語]]はその[[要素]]と[[子孫]]に適用されると説明されていますが、
[[Atom 1.0]] では更に [[Language-Sensitive]] とされた[[要素]]や[[属性]]にのみ有意であると規定されています
[SRC@@en[[[Atom 1.0]] 2.]]。

[REFS[
- [78] [CITE@@en[RFC 4287 - The Atom Syndication Format]] ([TIME[2008-08-30 23:12:03 +09:00]] 版) <http://tools.ietf.org/html/rfc4287#section-2>
- [79] [CITE@@en[RFC 5023 - The Atom Publishing Protocol]] ([TIME[2008-11-20 18:52:14 +09:00]] 版) <http://tools.ietf.org/html/rfc5023#section-2.1.3>
- [80] [CITE@@en[RFC 6721 - The Atom "deleted-entry" Element]] ([TIME[2012-12-31 01:08:20 +09:00]] 版) <http://tools.ietf.org/html/rfc6721#page-4>
]REFS]

[55] 
[CITE@@en[Speech Synthesis Markup Language (SSML) Version 1.1]] ([TIME[2010-09-08 00:26:19 +09:00]] 版) <http://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#adef_xmllang>

* メモ

[1] [CODE(HTML)[lang]] 属性の値で [[CJK]] [[字形]]を区別するのは、間違ってはいませんが良い考えではありません。 (でも [[Unicode]] には他に方法はないです。)

[2] >>1 [[異体字タグ]]? 萎えるな。それに [[XML]] でそれは使えるんだろうか?

[45]
[CITE[英語翻訳 - エキサイト 翻訳]] ([TIME[2008-02-11 12:33:33 +09:00]] 版) <http://www.excite.co.jp/world/english/>

>
[PRE(CSS illegal example code)[
.en_m { lang: EN; font-family: Verdana; }
.en_s { lang: EN; font-family: Verdana; }
]PRE]

[48] [CITE[Document Structure – SVG Tiny 1.2]] ([TIME[2008-12-20 02:31:29 +09:00]] 版) <http://www.w3.org/TR/2008/REC-SVGTiny12-20081222/struct.html#XMLLangAttribute>

[50] [CITE[EMMA: Extensible MultiModal Annotation markup language]] ([TIME[2009-02-03 15:38:28 +09:00]] 版) <http://www.w3.org/TR/2009/REC-emma-20090210/#s4.2.5>

本文では [[BCP 47]] (日付は2006年、リンク先は最新版) を参照していますが、[[データ型]]としては
[[XML Schema]] (日付は第2版、リンク先は最新版) の [CODE(XML)@@en[[[xs:language]]]]
になっています。

[51] [CITE[IRC logs: freenode / #whatwg / 20090508]]
([TIME[2009-08-07 07:55:55 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20090508#l-73>

[52] [CITE[IRC logs: freenode / #whatwg / 20090602]]
([TIME[2009-08-23 20:57:07 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20090602#l-368>

[53] [CITE@@en[XHTML2 Working Group Teleconference -- 16 Sep 2009]]
([TIME[2009-09-16 23:43:23 +09:00]] 版)
<http://www.w3.org/2009/09/16-xhtml-minutes.html#item05>

[54] [CITE[IRC logs: freenode / #whatwg / 20100205]]
([TIME[2010-02-06 17:25:36 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20100205#l-166>

[56] [CITE@@en[Speech Synthesis Markup Language (SSML) Version 1.1]]
( ([TIME[2010-09-08 00:26:19 +09:00]] 版))
<http://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#edef_lang>

[57] [CITE@@en[RFC 3920 - Extensible Messaging and Presence Protocol (XMPP): Core]] ([TIME[2011-03-31 08:02:17 +09:00]] 版) <http://tools.ietf.org/html/rfc3920#section-9.1.5>

[CODE(XML)@@en[[[NMTOKEN]]]] でなければ[['''なりません''']]。
[[RFC 3066]] [[言語タグ]]でなければ[['''なりません''']]。

[58] [CITE[Document Structure – SVG 1.1 (Second Edition)]]
( ([TIME[2011-08-10 12:35:27 +09:00]] 版))
<http://www.w3.org/TR/2011/REC-SVG11-20110816/struct.html#LangSpaceAttrs>

[REFS[
- [72] [CITE@@en[RFC 5196 - Session Initiation Protocol (SIP) User Agent Capability Extension to Presence Information Data Format (PIDF)]] ([TIME[2011-11-20 19:42:05 +09:00]] 版) <http://tools.ietf.org/html/rfc5196#page-9>
- [74] [CITE@@en[RFC 4482 - CIPID: Contact Information for the Presence Information Data Format]] ([TIME[2011-11-20 21:10:10 +09:00]] 版) <http://tools.ietf.org/html/rfc4482#section-7>
]REFS]

[73] >>72 では省略時の既定値が [CODE(lang)@@en[[[i-default]]]] です。

[75] [CITE[Web Application Description Language]]
( ([TIME[2009-09-10 03:59:24 +09:00]] 版))
<http://www.w3.org/Submission/2009/SUBM-wadl-20090831/#x3-80002.3>

[76] [CITE@@en[Web Applications 1.0 r7421 Encourage lang=[SPAN[']][SPAN[']] on root element.]]
( ([TIME[2012-09-29 03:44:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7420&to=7421>


[77] [CITE@@en[Re: xml:lang in the light of error frequencies]]
( ([[Ian Hickson]] 著, [TIME[2008-08-12 19:12:39 +09:00]] 版))
<http://lists.w3.org/Archives/Public/public-html/2008Aug/0301.html>

[81] [CITE@@en[Web Applications 1.0 r7894     Don't set the language when it's just spaces.]]
( ([TIME[2013-06-05 05:27:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7893&to=7894>

[82] [CITE[''''''[''''''whatwg'''''']'''''' HTML: A DOM attribute that returns the language of a node]]
( ([TIME[2013-07-13 09:28:35 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-July/040044.html>

[83] [CITE[''''''[''''''whatwg'''''']'''''' HTML: A DOM attribute that returns the language of a node]]
( ([TIME[2013-09-17 00:43:23 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040846.html>

[84] [CITE@@en[Bug 23512 – API to expose actual language of a node, to aid scripts doing localisation and CJK editors during copy&paste and drag&drop]]
( ([TIME[2013-10-14 23:00:35 +09:00]] 版))
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=23512>

[85] [CITE@@en[XHTML+RDFa 1.1 - Second Edition]]
( ([TIME[2013-08-15 17:11:45 +09:00]] 版))
<http://www.w3.org/TR/2013/REC-xhtml-rdfa-20130822/#s_xhtmlrdfa>

[86] [CITE@@en[HTML+RDFa 1.1]]
( ([TIME[2013-08-20 15:49:04 +09:00]] 版))
<http://www.w3.org/TR/2013/REC-html-rdfa-20130822/#additional-rdfa-processing-rules>

[87] [CITE@@en-US[XML Binding Language (XBL) 2.0]]
( ([TIME[2007-03-16 22:20:16 +09:00]] 版))
<http://www.w3.org/TR/2007/CR-xbl-20070316/#forwarding0>@


1.37
log
@updated by (anon)
@
text
@d383 5
a387 1
<http://www.w3.org/TR/2013/REC-html-rdfa-20130822/#additional-rdfa-processing-rules>@


1.36
log
@updated by (anon)
@
text
@d379 5
a383 1
<http://www.w3.org/TR/2013/REC-xhtml-rdfa-20130822/#s_xhtmlrdfa>@


1.35
log
@updated by (anon)
@
text
@d375 5
a379 1
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=23512>@


1.34
log
@updated by (anon)
@
text
@d371 5
a375 1
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040846.html>@


1.33
log
@updated by (anon)
@
text
@a288 11
* lang() 関数 (XPath)

[6] [[XPath]] の[[関数]] [CODE(XPath)[[[lang()]]]] って使えないと思いません? 引数に[[言語札]]を与えることで、その言語 (前方一致。) であるかどうかを [[boolean]] として返します。だから例えば、 [[XSLT]] を使って多言語文書から特定言語の段落を抜き出す、とかには使えても、特定要素ノードの言語を調べる、には使えない。 ([CODE(XML)[xml:lang]] 属性使ってもいいけど、この属性の値は継承するから・・・あ、 [CODE(XPath)[ancestor-or-self::*[@@xml:lang]/@@xml:lang]] という手があるか。)

[20] >>6 でもそれじゃあ上位プロトコルによる情報までは手が及ばない。
っていうか XPath 全体として、上位プロトコル提供の情報には access
不能 or 困難だよねぇ。

[43]
[CITE[d:id:quaa]] ([CODE[2007-08-06 19:32:28 +09:00]] 版) <http://d.hatena.ne.jp/quaa/20070805#p1>

d359 12
a370 12
<http://lists.w3.org/Archives/Public/public-html/2008Aug/0301.html>

[81] [CITE@@en[Web Applications 1.0 r7894     Don't set the language when it's just spaces.]]
( ([TIME[2013-06-05 05:27:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7893&to=7894>

[82] [CITE[''''''[''''''whatwg'''''']'''''' HTML: A DOM attribute that returns the language of a node]]
( ([TIME[2013-07-13 09:28:35 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-July/040044.html>

[83] [CITE[''''''[''''''whatwg'''''']'''''' HTML: A DOM attribute that returns the language of a node]]
( ([TIME[2013-09-17 00:43:23 +09:00]] 版))
@


1.32
log
@updated by (anon)
@
text
@d378 5
a382 1
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-July/040044.html>@


1.31
log
@updated by (anon)
@
text
@d374 5
a378 1
<http://html5.org/tools/web-apps-tracker?from=7893&to=7894>@


1.30
log
@updated by (anon)
@
text
@d370 5
a374 1
<http://lists.w3.org/Archives/Public/public-html/2008Aug/0301.html>@


1.29
log
@updated by (anon)
@
text
@d275 1
a275 1
[46] [[Atom 1.0]] や [[AtomPub]] で定義されたすべての[[要素]]は [CODE(XMLa)@@en[[[xml]]:[[lang]]]]
d280 5
a284 3
;; [CITE@@en[RFC 4287 - The Atom Syndication Format]] ([TIME[2008-08-30 23:12:03 +09:00]] 版) <http://tools.ietf.org/html/rfc4287#section-2>

;; [CITE@@en[RFC 5023 - The Atom Publishing Protocol]] ([TIME[2008-11-20 18:52:14 +09:00]] 版) <http://tools.ietf.org/html/rfc5023#section-2.1.3>
d366 4
a369 4


[77] [CITE@@en[Re: xml:lang in the light of error frequencies]]
( ([[Ian Hickson]] 著, [TIME[2008-08-12 19:12:39 +09:00]] 版))
@


1.28
log
@updated by (anon)
@
text
@d364 5
@


1.27
log
@updated by (anon)
@
text
@a296 134
([[名無しさん]])

[[#comment]]


* [CODE(CSS)@@en[:lang([VAR@@ja[言語タグ]])]] 擬似クラス (選択子)

[29]
[[選択子]]の 
[DFN[[CODE(CSS)@@en[:lang([VAR@@ja[[[言語タグ]]]])]] [[擬似クラス]]]]は、
指定された[[言語]]の[[要素]]と[[一致]]します。

** 仕様書

[REFS[
- [59] [CITE@@en[Selectors Level 3]] ([TIME[2011-09-29 22:16:17 +09:00]] 版) <http://www.w3.org/TR/selectors/#lang-pseudo>
]REFS]

** 意味

[61] [CODE(CSS)@@en[[[:lang()]]]] [[擬似クラス]]は、[[要素]]の[[自然言語]]が指定された値と等しいか、
または指定された値の後に [CODE(CSS)[[[-]]]] が続いている時、その[[要素]]と[[一致]]します。
ここで[[要素]]の[[自然言語]]は[[文書言語]]によって定義されるものであり、必要に応じて [[BCP 47]]
の[[言語タグ]]の構文に正規化したもの、とされています。 [SRC[>>59]]

** 構文

[63] [CODE(CSS)@@en[[[:lang]]]] の直後に括弧で括って[[言語タグ]]を指定する必要があります。

[66] [[言語タグ]]は [[CSS]] の[[識別子]]で[['''なければなりません''']]。
[[言語タグ]]として正しいものである必要はありません。 [SRC[>>59]]

** 大文字と小文字

[64] [CODE(CSS)@@en[[[lang]]]] の部分は[[ASCII大文字・小文字不区別]]です。

[65] [[言語タグ]]も[[ASCII大文字・小文字不区別]]です [SRC[>>59]]。

** 要素の言語

[33]
[[一致]]判定の対象となる、[[文書木]]側の[[言語]]の情報源は、
[[文書]]の[[マーク付け言語]]によって異なります。
[[HTML]] では [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]や [[HTTP]] からの情報が使われますし、
[[XML]] では [CODE(XMLa)@@en[[[xml]]:[[lang]]]]
[[属性]]や[[マーク付け言語]]依存の方法で得られた情報が使われます。
[SRC@@en[[[CSS 2]], [[CSS 2.1]], Selectors3 >>59]]

[62] ... という話は仕様書では例として挙げられているだけのようで、
詳細は各[[マーク付け言語]]の仕様が規定するべきということと思われます。
但し [[CSS 2.1]] や[[選択子3]]では、各[[文書]]や[[プロトコル]]で
[[BCP 47]] の[[言語札]]を使うことや [[XML]]
では [CODE(XMLa)@@en[[[xml]]:[[lang]]]] 
[[属性]]を使うことが推奨されています [SRC[>>59]]。

** 妥当性

[67] 構文的に正しくないと[[非妥当]]です。例えば[[言語タグ]]が指定されていないと[[非妥当]]です
[SRC[>>59]]。

** 歴史

[31]
[CODE(CSS)@@en[:lang([VAR[C]])]] で、 [CODE(CSS)@@en[[VAR[C]]]]
は[[言語札]]を指定します。[[言語札]]として [[CSS 2]]
勧告では [[HTML 4.0]] と [[RFC 1766]] が、選択子勧告候補 
[SRC@@en[Selectors3 CR]] では [[HTML 4.01]] と [[RFC 3066]]
が参照されています。 [[HTML 4]] は [[RFC 1766]]
を参照しています。

[[CSS 2.1]] 作業原案は[[ハイフン]]区切りの文字列とだけ規定しています。
また、空文字列でもよく、その場合何と一致するかは未定義とされています。

;; メモ: 執筆の時点で Selectors 勧告候補は CSS 2.0 
勧告に基づいた規定になっており、次の原案で CSS 2.1
作業原案における改訂を反映するものと思われます。

*** CSS2

[REFS[
- [70] [CITE@@en[Selectors]] ([TIME[1998-03-25 23:00:31 +09:00]] 版) <http://www.w3.org/TR/1998/PR-CSS2-19980324/selector.html#x40>
- [30] [[CSS 2]]
-- [CSECTION@@en[5.11.4 The language pseudo-class: :lang]]
<http://www.w3.org/TR/CSS2/selector.html#lang>
]REFS]

[71] >>70 で追加されました。

*** 選択子3

[REFS[
- [60] [CITE@@en[Selectors]]
-- [CSECTION@@en[6.6.3 The language pseudo-class :lang]]
<http://www.w3.org/TR/2001/CR-css3-selectors-20011113/#lang-pseudo>
]REFS]

[32]
[CODE(CSS)@@en[:lang([VAR@@en[C]])]] [[擬似クラス]]と[[言語]]との[[一致]]の判定は
[[属性選択子]]の [CODE(CSS)[[[|=]]]] [[演算子]]と同じ方法によります。
[SRC@@en[[[CSS 2]], [[CSS 2.1]]]]
という規定がなぜか Selectors 勧告候補にはありませんでした。

** 関連

[68] [[属性選択子]]で [CODE(CSS)[[[|=]]]] を指定した場合と同じように機能しますが、
[CODE(CSS)@@en[[[:lang]]]] は実装が知っている[[文書]]の[[意味]]に基づき効果が及ぶ点が異なっています
[SRC[>>59]]。

[EG[
[69] 例えば [CODE(CSS)@@en[[[:lang(ja)]]]] は [CODE(HTMLa)@@en[[[lang]]]] [[属性]]が
[CODE(lang)[[[ja]]]] である[[要素]]だけでなく、 (それを継承している) [[子孫]]の[[要素]]にも[[一致]]します。
また [CODE(HTMLa)@@en[[[lang]]]] [[属性]]が明示されていなくても、 [[HTTP]]
の [CODE(HTTP)@@en[[[Content-Language]]]] 欄に指定されていれば、それを継承している[[要素]]にも[[一致]]します。
更に [CODE(HTMLa)@@en[[[lang]]]] と [CODE(XMLa)@@en[[[xml:lang]]]] が混在していても正しく動作します。
]EG]

** メモ

[34]
巷の [[CSS]] の解説の中には、
[PRE(CSS example code)[
:lang(ja)
]PRE]

と
[PRE(CSS example code)[
[lang|="ja"]
]PRE]

が同じだとしているものがありますが、
>>32 や >>33 の通り同じでは''ありません''。
似たような意味を持つことは確かですが、
似ているからこそ読者の誤解を招かないように正確な解説を心がけるべきです。
@


1.26
log
@updated by (anon)
@
text
@d489 9
a497 13
[73] >>72 では省略時の既定値が [CODE(lang)@@en[[[i-default]]]] です。

[75] [CITE[Web Application Description Language]]
( ([TIME[2009-09-10 03:59:24 +09:00]] 版))
<http://www.w3.org/Submission/2009/SUBM-wadl-20090831/#x3-80002.3>

[76] [CITE@@en[Web Applications 1.0 r7421 Encourage lang='' on root element.]]
( ([TIME[2012-09-29 03:44:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7420&to=7421>

[77] [CITE@@en[Web Applications 1.0 r7504        Add <lang> to WebVTT.]]
( ([TIME[2012-11-06 06:03:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=7503&to=7504>@


1.25
log
@updated by (anon)
@
text
@d497 5
a501 1
<http://html5.org/tools/web-apps-tracker?from=7420&to=7421>@


1.24
log
@updated by (anon)
@
text
@d493 5
a497 1
<http://www.w3.org/Submission/2009/SUBM-wadl-20090831/#x3-80002.3>@


1.23
log
@updated by (anon)
@
text
@d489 5
a493 1
[73] >>72 では省略時の既定値が [CODE(lang)@@en[[[i-default]]]] です。@


1.22
log
@updated by (anon)
@
text
@d486 1
@


1.21
log
@updated by (anon)
@
text
@d482 7
a488 1
<http://www.w3.org/TR/2011/REC-SVG11-20110816/struct.html#LangSpaceAttrs>@


1.20
log
@updated by (anon)
@
text
@d378 1
d384 2
@


1.19
log
@updated by (anon)
@
text
@d380 1
a380 1
<IW:CSS2:"selector.html#lang">
@


1.18
log
@updated by (anon)
@
text
@d326 3
d353 5
d397 14
@


1.17
log
@updated by (anon)
@
text
@d315 1
a315 1
** 構文
d317 4
a320 7
[31]
[CODE(CSS)@@en[:lang([VAR[C]])]] で、 [CODE(CSS)@@en[[VAR[C]]]]
は[[言語札]]を指定します。[[言語札]]として [[CSS 2]]
勧告では [[HTML 4.0]] と [[RFC 1766]] が、選択子勧告候補 
[SRC@@en[Selectors]] では [[HTML 4.01]] と [[RFC 3066]]
が参照されています。 [[HTML 4]] は [[RFC 1766]]
を参照しています。
d322 1
a322 2
[[CSS 2.1]] 作業原案は[[ハイフン]]区切りの文字列とだけ規定しています。
また、空文字列でもよく、その場合何と一致するかは未定義とされています。
d324 1
a324 3
メモ: 執筆の時点で Selectors 勧告候補は CSS 2.0 
勧告に基づいた規定になっており、次の原案で CSS 2.1
作業原案における改訂を反映するものと思われます。
d326 1
a326 1
[[#comment]]
d328 1
d330 1
a330 1
** 一致
d332 1
a332 5
[32]
[CODE(CSS)@@en[:lang([VAR@@en[C]])]] [[擬似クラス]]と[[言語]]との[[一致]]の判定は
[[属性選択子]]の [CODE(CSS)[[[|=]]]] [[演算子]]と同じ方法によります。
[SRC@@en[[[CSS 2]], [[CSS 2.1]]]]
という規定がなぜか Selectors 勧告候補にはありません。
d341 1
a341 1
[SRC@@en[[[CSS 2]], [[CSS 2.1]], Selectors]]
d343 1
a343 1
という話は仕様書では例として挙げられているだけのようで、
d345 2
a346 2
但し [[CSS 2.1]] には、各[[文書]]や[[プロトコル]]で
[[RFC 3066]] の[[言語札]]を使うことや [[XML]]
d348 1
a348 1
[[属性]]を使うことが推奨されています。
d352 17
d383 6
a406 3
[[#comment]]


@


1.16
log
@updated by (anon)
@
text
@d302 1
a302 1
* [CODE(CSS)@@en[:lang([VAR@@ja[言語札]])]] 擬似クラス (選択子)
d306 1
a306 1
[DFN[[CODE(CSS)@@en[:lang([VAR@@ja[[[言語札]]]])]] [[擬似クラス]]]]は、
d309 1
a309 8
[30]
仕様書:
- [[CSS 2]]
-- [CSECTION@@en[5.11.4 The language pseudo-class: :lang]]
<IW:CSS2:"selector.html#lang">
- [CITE@@en[Selectors]]
-- [CSECTION@@en[6.6.3 The language pseudo-class :lang]]
<http://www.w3.org/TR/2001/CR-css3-selectors-20011113/#lang-pseudo>
d311 3
d359 9
a367 1
[[#comment]]
d369 5
d442 4
a445 4
[[RFC 3066]] [[言語タグ]]でなければ[['''なりません''']]。

[58] [CITE[Document Structure – SVG 1.1 (Second Edition)]]
( ([TIME[2011-08-10 12:35:27 +09:00]] 版))
@


1.15
log
@updated by (anon)
@
text
@d433 5
a437 1
[[RFC 3066]] [[言語タグ]]でなければ[['''なりません''']]。@


1.14
log
@updated by (anon)
@
text
@d424 10
a433 5
<http://krijnhoetmer.nl/irc-logs/whatwg/20100205#l-166>

[56] [CITE@@en[Speech Synthesis Markup Language (SSML) Version 1.1]]
( ([TIME[2010-09-08 00:26:19 +09:00]] 版))
<http://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#edef_lang>@


1.13
log
@updated by (anon)
@
text
@d424 5
a428 1
<http://krijnhoetmer.nl/irc-logs/whatwg/20100205#l-166>@


1.12
log
@updated by (anon)
@
text
@d284 2
a285 3
[[#comment]]


d408 16
a423 16
になっています。

[51] [CITE[IRC logs: freenode / #whatwg / 20090508]]
([TIME[2009-08-07 07:55:55 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20090508#l-73>

[52] [CITE[IRC logs: freenode / #whatwg / 20090602]]
([TIME[2009-08-23 20:57:07 +09:00]] 版)
<http://krijnhoetmer.nl/irc-logs/whatwg/20090602#l-368>

[53] [CITE@@en[XHTML2 Working Group Teleconference -- 16 Sep 2009]]
([TIME[2009-09-16 23:43:23 +09:00]] 版)
<http://www.w3.org/2009/09/16-xhtml-minutes.html#item05>

[54] [CITE[IRC logs: freenode / #whatwg / 20100205]]
([TIME[2010-02-06 17:25:36 +09:00]] 版)
@


1.11
log
@updated by (anon)
@
text
@d421 5
a425 1
<http://www.w3.org/2009/09/16-xhtml-minutes.html#item05>@


1.10
log
@updated by (anon)
@
text
@d417 5
a421 1
<http://krijnhoetmer.nl/irc-logs/whatwg/20090602#l-368>@


1.9
log
@updated by (anon)
@
text
@d413 5
a417 1
<http://krijnhoetmer.nl/irc-logs/whatwg/20090508#l-73>@


1.8
log
@updated by (anon)
@
text
@d409 5
a413 1
になっています。@


1.7
log
@updated by (anon)
@
text
@d403 7
a409 1
[48] [CITE[Document Structure – SVG Tiny 1.2]] ([TIME[2008-12-20 02:31:29 +09:00]] 版) <http://www.w3.org/TR/2008/REC-SVGTiny12-20081222/struct.html#XMLLangAttribute>@


1.6
log
@updated by (anon)
@
text
@d160 9
a168 1
[[#comment]]
@


1.5
log
@updated by (anon)
@
text
@d395 1
a395 3

([[名無しさん]])

@


1.4
log
@updated by (anon)
@
text
@d268 3
a270 1
[[属性]]を持つことができます。
@


1.3
log
@updated by (anon)
@
text
@d265 3
a267 1
[46] [[AtomPub]] で定義されたすべての[[要素]]は [CODE(XMLa)@@en[[[xml]]:[[lang]]]]
d269 2
@


1.2
log
@updated by (anon)
@
text
@a241 3
([[名無しさん]])

[[#comment]]
d243 1
@


1.1
log
@converted from SuikaWiki3 <http://suika.fam.cx/gate/cvs/suikawiki/wikidata/page/6C616E67.txt>
@
text
@d1 382
a382 377

[38]
本稿では、 [Q@@en[lang]] と呼ばれるものについて説明しています。
[Q@@en[lang]] は[[英語]]の [Q@@en[[[language]]]]
の省略形として非常に良く用いられる語で、
文脈によって[[自然言語]]を指したり[[プログラム言語]]、
[[マーク付け言語]]その他、あるいはそれらをまとめて指したりします。

[[自然言語]]を指定する[[プロトコル要素]]等に関しては、
[Q[[[言語情報]]]]の項も併せてご覧下さい。


* lang 属性 (HTML, XHTML 1)

[11] [[HTML]] のほとんどの[[要素型]]で定義されている[[属性]]
[CODE(HTMLa)[lang]] は、その[[要素]]の[[属性値]]および文[[内容]]
(text content) の基底言語 (base language) を指定します。

この属性の値は [CODE(SGML)[%[[LanguageCode]];]] 型 ([[IETF]] の[[言語札]])
であり、[[大文字]]・[[小文字]]は区別されません。
既定値は[RUBYB[未知] [unknown]]です。

[25]
仕様書:
- [[HTML 4]]
-- [CODE(HTMLa)[lang]] 属性 <IW:HTML4:"struct/dirlang.html#adef-lang">
- [[XHTML 1.0]]
-- [CSECTION[C.7. The [CODE(HTMLa)[lang]] and [CODE(HTMLa)[xml:lang]] Attributes]]
(参考) <IW:XHTML10:"C_7">

[15] なお、ここで[[言語]]とは[[自然言語]]であって、
[[プログラム言語]]は除外されています。
(<IW:HTML4:"struct/dirlang.html#langcodes"> 参照。)

[12] この属性の値は、 [[UA]] が種々の用途で使います。
<IW:HTML4:"struct/dirlang.html#idx-language-1"> に挙げられている例としては:
- [[検索円陣]]の補助情報
- [[発話合成]]の補助情報
- 高品質[[写植]]のための[[異体グリフ]]選択の補助
- [[引用符]]集合を選ぶための補助
- [[ハイフン付け]], [[合字]] ([[リガチャ]]), [[文字間]]の決定の補助
- 綴り検査・文法検査の補助情報

があります。

[13] [CODE(HTMLa)[lang]] 属性の意図は、 UA が特定言語における旧来の文化的慣習に基づいてより有意義に内容を[[描画]]できるようにということにあります。
UA に特定言語では型破りな文字をさほど意味のない方法で描画することを求めるものではありません。
UA は、 [CODE(HTMLa)[lang]] 属性で指定された値に関わらず、
全ての文字を描画するように最前の努力をなさなければなりません [HTML4]。

という良く分からない文章の心は、 [CODE(HTML)[[CODE(HTMLa)[lang]]=en]]
にしたら (そうしなければ表示されていたはずの) 漢字が[[豆腐]]とかに化けてしまう糞 UA
逝っとくれと、そういうことですかねぇ。 >>4 の例からみても。違いますか?

[[#comment]]


** 代替

[24] [[XHTML 1.0]] で [[XML]] の
[CODE(XMLa)[[[xml]]:lang]] 属性が [[XHTML]] 
に取り入れられました。

[[XHTML 1.0]] 互換性指針によれば、[WEAK[互換性指針に従う文書は]] 
[CODE(HTMLa)[lang]] と [CODE(HTMLa)[xml:lang]] の両方を指定するべきです。
[CODE(HTMLa)[xml:lang]] が優先されます。 [SRC[XHTML 1.0 C.7]]

[[#comment]]


** 継承

[16] ある要素の言語は、次の情報から決定されます。
(先のものが優先度が高い。)

= その要素の [CODE(HTMLa)[lang]] 属性値
= 一番近い [CODE(HTMLa)[lang]] 属性を持つ要素の [CODE(HTMLa)[lang]] 属性値
-- 一般には、[[先祖要素]]
-- [[表]]の[[こま]]では、その[[行]]の最初のこまだったりもする。
= [[HTTP]] の [CODE(HTTP)[[[Content-Language]]]] 頭欄
= [[UA]] の既定値・利用者の設定

(<IW:HTML4:"struct/dirlang.html#h-8.1.2"> 参照。)
[17] 実際には HTML は HTTP 以外でも使われますから、 HTTP
に限らず転送プロトコル一般の言語情報を第3位と解釈するのがよいでしょう。

転送プロトコルが複数組み合わされる場合は (各プロトコル(群)で特に規定がある場合はそれによるとし、そうでない場合は) 内側の (HTML 文書に近い) プロトコルの情報が優先されるとするのがよいでしょう。

[18] [CODE(HTMLa)[[[http-equiv]]]] な [CODE(HTMLe)[[[meta]]]] 要素を使って
[CODE(HTTP)[Content-Language]] を指定する方法も実際には良く使われています。
HTML 4 が触れていない以上、厳密に HTML 4 に従う UA
では無視するのが良いのかもしれませんが、現実路線(謎)の UA
は HTTP など上位プロトコルが言語情報を持たないときにはこれを参照してもよいのではないでしょうか。

[19] ところで、 HTTP では [SAMP(HTTP)[Content-Language: ja, en]]
のように複数の言語を指定できるのですが、 HTML 4 ではできません。
実装者はその辺注意されたし。

[22]
表の中では [CODE(SGML)[%[[cellvalign]]]]
と同じ継承規則が使われると HTML 4
では規定されています。

[[#comment]]


** 言語札の階層性

[10] 言語札は [SAMP(lang)[ja-JP]], [SAMP(lang)[en-US]] 
のような階層構造を持っています。

HTML 4 は、言語情報による処理に際して、まず全体の一致を試み、
次に最初の部分の一致によるべきだとしています。
<IW:HTML4:"struct/dirlang.html#h-8.1.3"> 参照。

こうすれば、たとえ [SAMP(lang)[ja-JP]] の処理を知らなくても、
[SAMP(lang)[ja]] の処理さえ知っていれば、それなりの結果が期待できます。

[[#comment]]


** 歴史

[26]
仕様書:
- [DEL[[[RFC 2070]] ([[IETF]] [[提案標準]])]] ([[廃止]])
-- [CSECTION@@en[3. The LANG attribute]]

[27]
[[標準]]として最初に [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]が [[HTML]] に導入されたのは [[HTML 2.x]]
([[RFC 2070]]) でした。 [[HTML 2.x]] ではすべての[[要素型]]のうち、
意味をなさないと考えられた
[CODE(HTMLe)@@en[[[br]]]], [CODE(HTMLe)@@en[[[hr]]]],
[CODE(HTMLe)@@en[[[base]]]], [CODE(HTMLe)@@en[[[nextid]]]], 
[CODE(HTMLe)@@en[[[meta]]]]
''以外''すべてに [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]が追加されました [SRC[[[RFC 2070]] 3.]]。

[28]
[[RFC 2070]] は[[属性値]]として [[RFC 1766]]
の[[言語札]]を参照しつつも構文と意味を独自に規定
[WEAK[(というか[[コピペ]])]] していました。
>>10 の階層的比較に関する規定や >>16
の継承に関する規定もありました。

[36] '''XHTML m12n における事実上の廃止'''
[[XHTML m12n]] では[[抽象モジュール]]定義に [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]は含まれず、[[遺物再定義]] [[DTDモジュール]]の定義にひっそり含まれています。

[[XHTML m12n]] を基に構築されている [[XHTML 1.1]] や [[XHTML Basic]]
にはそもそも[[遺物]]モジュールが取込まれていませんから、
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]は存在しません。

仕様書:
- [[XHTML m12n]]
-- [[遺物再定義]] [[DTDモジュール]]
<IW:XHTML1m12n:"dtd_module_defs.html#a_module_Legacy_Redeclarations">

[[#comment]]


** 例

[14] [HTML4] から。
[PRE[
<P><Q lang="en">Her super-powers were the result of
&gamma;-radiation,</Q> he explained.</P>
]PRE]

- UA は、英語の内容を適切な方法の描画 (たとえば引用符の取り扱い) を試みるべきです。
- UA は、英語の文字でなくても最前の努力でもって表示を試みなければなりません。

([CODE(HTMLe)[p]] 要素またはそれより上位の要素でも [CODE(HTML)[[CODE(HTMLa)[lang]]=en]] とちゃんと指定しておかないと、引用符は決定できないと思うのですけどねぇ。)

[23]
[[英語]]の文章の中に[[日本語]]
([[羅馬字]]表記) が混じっている例

[PRE(HTML example)[
<p>Horizontal in vertical ("<span lang="ja">Tate-chu-yoko</span>")
</p>
]PRE]

> [SAMP(HTML)[In Japanese, this effect is known as <a href="#g-tatechuyoko">"<span lang="ja">Tate</span>-<span lang="ja">chu</span>-<span lang="ja">yoko</span>"</a>.]]

共に出典は
[CITE[CSS3 Text Module]] 
<http://www.w3.org/TR/2003/CR-css3-text-20030514/#writing-mode>

[[#comment]]


** 関連

[39] '''文字コードとの関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]は、
[[文字コード]] ([[符号化文字集合]]や[[符号化方式]])
とは[[直交]]するものです。[[文字コード]]の選択によって
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]の要/不要や値が影響を受けることは''ありません''。

[40] '''文字種との関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]による[[言語]]の指定は、
その[[要素]]の[[内容]]として使われる[[文字]]の種類
([[用字系]]や[[正書法]]等) とは直接は関係''ありません''。

[[言語]]と[[文字]]の種類の間には元々強い関係が存在するので、
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]と[[内容]]の[[文字]]にも強い関係が認められますが、
それ以上の制約は存在しません。例えば、 [CODE(HTMLa)@@en[[[lang]]]]
が [CODE(lang)@@en[[[ja]]]] で、[[内容]]が[[アラビア文字]]であったとしても、
(それが[[日本語]]を表記したものなら) 何ら問題ありません。

[41] '''レンダリングとの関係'''

[CODE(HTMLa)@@en[[[lang]]]] [[属性]]による[[言語]]の指定は、
その[[要素]]の[[内容]]を[[視覚的]]、[[音声]]、その他の方法によって適切に[[レンダリング]]するための情報の1つとして利用されます。

[[#comment]]


** メモ

[37]
[CODE(HTMLa)@@en[[[lang]]]] [[属性]]が [[XML]] に取込まれて
[CODE(XMLa)@@en[[[xml]]:[[lang]]]] [[属性]]となった背景には、
[[XLink 1.0]] と同様に、 [[HTML]] に限らず汎用的に使えそうなものは [[XML]]
系[[マーク付け言語]]共用の語彙にしてしまおうという思惑が見え隠れしています。

それ自体は至極結構なことですが、それがために旧来の [[HTML]]
と [[XHTML 1]] の致命的な断絶を招いてしまいました。言語属性の普及状況がいまいちなのも
[[XHTML 1]] の普及状況がいまいちなのもこの問題が大きな原因の
1つだというのは言い過ぎでしょうか。

[42]
[CITE@@en-US[Internationalization Best Practices: Specifying Language in XHTML & HTML Content]] ([CODE[2007-02-16 05:52:24 +09:00]] 版) <http://www.w3.org/International/geo/html-tech/tech-lang.html>
([[名無しさん]])

[44]
[CITE@@en[lang attributes accross (X)HTML versions - W3C Q&A Weblog]] ([CODE[2007-08-31 19:12:14 +09:00]] 版) <http://www.w3.org/QA/2007/08/xhtml-html-lang-attributes.html>
([[名無しさん]])

[[#comment]]


* xml:lang 属性 (XML)

- [4] [[xml]]:lang 特殊属性: <http://www.w3.org/TR/REC-xml#sec-lang-tag>
- [3] [[XSL-FO]] の [CODE(XML)[xml:lang]] 属性の値には [CODE(XSL)[inherit]] を指定できます。 ([[言語札]>>40] 参照)
- 
[5] XML 1.0 [ABBR[FE] [First Edition]] では[[言語札]]の構文も定義されていました (<http://www.w3.org/TR/1998/REC-xml-19980210#sec-lang-tag>) が、 [ABBR[SE] [Second Edition]] では RFC に一任されています。

[7] XML 1.0 [[SE]] Errata では重大な変更が加えられています。型が [CODE(SGML)[[[NMTOKEN]]]] から [CODE(SGML)[[[CDATA]]]] に変更され、空文字列が認められました。
- [8] >>7 空文字列だと言語指定取消し (指定なし。) になります。 ([[XML名前空間]]の 1.1 版と似たような変更ですね。) ''Errata in REC-xml-20001006'' <http://www.w3.org/XML/xml-V10-2e-errata#E41>

[21]
[CODE(lang)[[[und]]]] (決定できない) という言語札もあったりしますが、空文字列はもっと積極的に、どの言語にも属さない場合 (絵とか) に使う、のではないでしょうかねぇ。
([[名無しさん]])

[35]
[[XInclude 1.0]] では言語情報を[[取込み]]の前後で保存するために
[CODE(InfoProp)[[[言語]]]][[特性]]を定義し、
[CODE(XMLa)@@en[[[xml]]:[[lang]]]] 属性 (とそこに記された情報)
の処理を規定しています。
([[名無しさん]])

[[#comment]]


* lang() 関数 (XPath)

[6] [[XPath]] の[[関数]] [CODE(XPath)[[[lang()]]]] って使えないと思いません? 引数に[[言語札]]を与えることで、その言語 (前方一致。) であるかどうかを [[boolean]] として返します。だから例えば、 [[XSLT]] を使って多言語文書から特定言語の段落を抜き出す、とかには使えても、特定要素ノードの言語を調べる、には使えない。 ([CODE(XML)[xml:lang]] 属性使ってもいいけど、この属性の値は継承するから・・・あ、 [CODE(XPath)[ancestor-or-self::*[@@xml:lang]/@@xml:lang]] という手があるか。)

[20] >>6 でもそれじゃあ上位プロトコルによる情報までは手が及ばない。
っていうか XPath 全体として、上位プロトコル提供の情報には access
不能 or 困難だよねぇ。

[43]
[CITE[d:id:quaa]] ([CODE[2007-08-06 19:32:28 +09:00]] 版) <http://d.hatena.ne.jp/quaa/20070805#p1>
([[名無しさん]])

[[#comment]]


* [CODE(CSS)@@en[:lang([VAR@@ja[言語札]])]] 擬似クラス (選択子)

[29]
[[選択子]]の 
[DFN[[CODE(CSS)@@en[:lang([VAR@@ja[[[言語札]]]])]] [[擬似クラス]]]]は、
指定された[[言語]]の[[要素]]と[[一致]]します。

[30]
仕様書:
- [[CSS 2]]
-- [CSECTION@@en[5.11.4 The language pseudo-class: :lang]]
<IW:CSS2:"selector.html#lang">
- [CITE@@en[Selectors]]
-- [CSECTION@@en[6.6.3 The language pseudo-class :lang]]
<http://www.w3.org/TR/2001/CR-css3-selectors-20011113/#lang-pseudo>


** 構文

[31]
[CODE(CSS)@@en[:lang([VAR[C]])]] で、 [CODE(CSS)@@en[[VAR[C]]]]
は[[言語札]]を指定します。[[言語札]]として [[CSS 2]]
勧告では [[HTML 4.0]] と [[RFC 1766]] が、選択子勧告候補 
[SRC@@en[Selectors]] では [[HTML 4.01]] と [[RFC 3066]]
が参照されています。 [[HTML 4]] は [[RFC 1766]]
を参照しています。

[[CSS 2.1]] 作業原案は[[ハイフン]]区切りの文字列とだけ規定しています。
また、空文字列でもよく、その場合何と一致するかは未定義とされています。

メモ: 執筆の時点で Selectors 勧告候補は CSS 2.0 
勧告に基づいた規定になっており、次の原案で CSS 2.1
作業原案における改訂を反映するものと思われます。

[[#comment]]


** 一致

[32]
[CODE(CSS)@@en[:lang([VAR@@en[C]])]] [[擬似クラス]]と[[言語]]との[[一致]]の判定は
[[属性選択子]]の [CODE(CSS)[[[|=]]]] [[演算子]]と同じ方法によります。
[SRC@@en[[[CSS 2]], [[CSS 2.1]]]]
という規定がなぜか Selectors 勧告候補にはありません。

[33]
[[一致]]判定の対象となる、[[文書木]]側の[[言語]]の情報源は、
[[文書]]の[[マーク付け言語]]によって異なります。
[[HTML]] では [CODE(HTMLa)@@en[[[lang]]]]
[[属性]]や [[HTTP]] からの情報が使われますし、
[[XML]] では [CODE(XMLa)@@en[[[xml]]:[[lang]]]]
[[属性]]や[[マーク付け言語]]依存の方法で得られた情報が使われます。
[SRC@@en[[[CSS 2]], [[CSS 2.1]], Selectors]]

という話は仕様書では例として挙げられているだけのようで、
詳細は各[[マーク付け言語]]の仕様が規定するべきということと思われます。
但し [[CSS 2.1]] には、各[[文書]]や[[プロトコル]]で
[[RFC 3066]] の[[言語札]]を使うことや [[XML]]
では [CODE(XMLa)@@en[[[xml]]:[[lang]]]] 
[[属性]]を使うことが推奨されています。

[[#comment]]


** メモ

[34]
巷の [[CSS]] の解説の中には、
[PRE(CSS example code)[
:lang(ja)
]PRE]

と
[PRE(CSS example code)[
[lang|="ja"]
]PRE]

が同じだとしているものがありますが、
>>32 や >>33 の通り同じでは''ありません''。
似たような意味を持つことは確かですが、
似ているからこそ読者の誤解を招かないように正確な解説を心がけるべきです。

[[#comment]]


* メモ

[1] [CODE(HTML)[lang]] 属性の値で [[CJK]] [[字形]]を区別するのは、間違ってはいませんが良い考えではありません。 (でも [[Unicode]] には他に方法はないです。)

[2] >>1 [[異体字タグ]]? 萎えるな。それに [[XML]] でそれは使えるんだろうか?

[45]
d391 3
a393 3

([[名無しさん]])

@

