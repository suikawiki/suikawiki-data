head	1.32;
access;
symbols;
locks; strict;
comment	@# @;
expand	@b@;


1.32
date	2014.04.09.02.33.37;	author wakaba;	state Exp;
branches;
next	1.31;

1.31
date	2014.04.06.03.15.01;	author wakaba;	state Exp;
branches;
next	1.30;

1.30
date	2014.04.06.03.12.06;	author wakaba;	state Exp;
branches;
next	1.29;

1.29
date	2014.04.06.02.58.07;	author wakaba;	state Exp;
branches;
next	1.28;

1.28
date	2014.01.31.04.53.00;	author wakaba;	state Exp;
branches;
next	1.27;

1.27
date	2014.01.31.04.51.56;	author wakaba;	state Exp;
branches;
next	1.26;

1.26
date	2013.12.28.05.12.56;	author wakaba;	state Exp;
branches;
next	1.25;

1.25
date	2013.10.13.12.53.46;	author wakaba;	state Exp;
branches;
next	1.24;

1.24
date	2013.09.27.01.32.27;	author wakaba;	state Exp;
branches;
next	1.23;

1.23
date	2013.09.17.01.49.07;	author wakaba;	state Exp;
branches;
next	1.22;

1.22
date	2013.09.14.00.27.37;	author wakaba;	state Exp;
branches;
next	1.21;

1.21
date	2013.02.17.01.53.51;	author wakaba;	state Exp;
branches;
next	1.20;

1.20
date	2013.02.17.01.51.40;	author wakaba;	state Exp;
branches;
next	1.19;

1.19
date	2012.01.11.16.37.13;	author wakaba;	state Exp;
branches;
next	1.18;

1.18
date	2011.08.13.06.22.33;	author wakaba;	state Exp;
branches;
next	1.17;

1.17
date	2011.08.13.06.11.41;	author wakaba;	state Exp;
branches;
next	1.16;

1.16
date	2010.08.01.12.45.21;	author wakaba;	state Exp;
branches;
next	1.15;

1.15
date	2010.08.01.12.28.13;	author wakaba;	state Exp;
branches;
next	1.14;

1.14
date	2010.08.01.12.27.51;	author wakaba;	state Exp;
branches;
next	1.13;

1.13
date	2010.08.01.11.49.26;	author wakaba;	state Exp;
branches;
next	1.12;

1.12
date	2010.08.01.11.45.35;	author wakaba;	state Exp;
branches;
next	1.11;

1.11
date	2010.08.01.11.38.08;	author wakaba;	state Exp;
branches;
next	1.10;

1.10
date	2010.08.01.11.30.59;	author wakaba;	state Exp;
branches;
next	1.9;

1.9
date	2010.08.01.11.20.34;	author wakaba;	state Exp;
branches;
next	1.8;

1.8
date	2010.08.01.11.16.01;	author wakaba;	state Exp;
branches;
next	1.7;

1.7
date	2010.08.01.11.14.16;	author wakaba;	state Exp;
branches;
next	1.6;

1.6
date	2010.08.01.11.12.52;	author wakaba;	state Exp;
branches;
next	1.5;

1.5
date	2010.08.01.11.08.28;	author wakaba;	state Exp;
branches;
next	1.4;

1.4
date	2010.08.01.11.07.52;	author wakaba;	state Exp;
branches;
next	1.3;

1.3
date	2010.08.01.11.07.27;	author wakaba;	state Exp;
branches;
next	1.2;

1.2
date	2010.08.01.11.05.48;	author wakaba;	state Exp;
branches;
next	1.1;

1.1
date	2010.08.01.11.05.16;	author wakaba;	state Exp;
branches;
next	;


desc
@@


1.32
log
@updated by (anon)
@
text
@[1] [DFN[[RUBYB[[[フォーム被関連付け要素]]]@@en[form-associated element]]]]は、[[フォーム所有子]]を持つことができる[[要素]]です
[SRC[>>3]]。[[フォーム被関連付け要素]]は [CODE(HTMLe)@@en[[[form]]]] [[要素]]と関係を持つことができ、
これを[[要素]]の[DFN[[RUBYB[[[フォーム所有子]]]@@en[form owner]]]]といいます [SRC[>>24]]。

[71] [[フォーム所有子]]は[[木構造]]に基づき自動的に決まりますが、 [CODE(HTMLa)@@en[[[form]]]]
[[内容属性]]によって[[著者]]が上書きすることもできます。どの[[要素]]が[[フォーム所有子]]であるかは
[CODE(DOMa)@@en[[[form]]]] [[IDL属性]]によって取得できます。

* 仕様書

[REFS[
- [2] [[HTML Standard]]
-- [3] '''<http://www.whatwg.org/specs/web-apps/current-work/complete.html#form-associated-element>'''
--- [[フォーム被関連付け要素]]
-- [24] '''<http://www.whatwg.org/specs/web-apps/current-work/complete.html#association-of-controls-and-forms>'''
--- [[フォーム所有者]]
-- [94] <http://www.whatwg.org/specs/web-apps/current-work/complete.html#insert-an-html-element>
]REFS]

* 分類

[124] [[フォーム被関連付け可能要素]]には次のような小分類があります。

[FIG[
- [17] [[フォーム被関連付け要素]]
-- [123] [[再関連付け可能要素]]
-- [18] [[被列挙要素]]
-- [19] [[ラベル付け可能要素]]
-- [20] [[提出可能要素]]
--- [22] [[ボタン]]
---- [23] [[提出ボタン]]
-- [21] [[再設定可能要素]]
]FIG]

[138] ただし[[ラベル付け可能要素]]には、[[フォーム被関連付け可能要素]]でないものも含まれています。

** フォーム被関連付け要素の一覧

[FIG[
- [4] [CODE(HTMLe)@@en[[[button]]]]
- [5] [CODE(HTMLe)@@en[[[fieldset]]]]
- [122] [CODE(HTMLe)@@en[[[img]]]]
- [6] [CODE(HTMLe)@@en[[[input]]]]
- [7] [CODE(HTMLe)@@en[[[keygen]]]]
- [8] [CODE(HTMLe)@@en[[[label]]]]
- [9] [DEL[[CODE(HTMLe)@@en[[[meter]]]]]]
- [10] [CODE(HTMLe)@@en[[[object]]]]
- [11] [CODE(HTMLe)@@en[[[output]]]]
- [12] [DEL[[CODE(HTMLe)@@en[[[progress]]]]]]
- [13] [CODE(HTMLe)@@en[[[select]]]]
- [14] [CODE(HTMLe)@@en[[[textarea]]]]
]FIG]

[15] [CODE(HTMLe)@@en[[[option]]]], [CODE(HTMLe)@@en[[[optgroup]]]], [CODE(HTMLe)@@en[[[legend]]]],
[CODE(HTMLe)@@en[[[datalist]]]] は含まれていません。

[132] [CODE(HTMLe)@@en[[[object]]]] は理論上は[[フォーム制御子]]として使えるため、ここに含まれています。

[133] [CODE(HTMLe)@@en[[[img]]]] は歴史的経緯から [CODE(JS)@@en[document.forms[n].imgname]] のようにアクセスできるため、
内部的に[[フォーム]]との関連付けを保持しており、ここに含まれています。

[137] [CODE(HTMLe)@@en[[[meter]]]] と [CODE(HTMLe)@@en[[[progress]]]] は >>136
により一時的に含まれていました。

;; [139] これらはいずれも[[字句内容]]、[[フロー内容]]として使うことができる[[要素]]です。

** 再関連付け可能要素

[125] [DFN[[RUBYB[[[再関連付け可能要素]]]@@en[reassociateable element]]]]は、
[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]、[CODE(DOMa)@@en[[[form]]]] [[IDL属性]]を有する[[フォーム所有子]]を指定可能な[[フォーム被関連付け要素]]です。

[FIG[
- [CODE(HTMLe)@@en[[[button]]]]
- [CODE(HTMLe)@@en[[[fieldset]]]]
- [CODE(HTMLe)@@en[[[input]]]]
- [CODE(HTMLe)@@en[[[keygen]]]]
- [CODE(HTMLe)@@en[[[label]]]]
- [CODE(HTMLe)@@en[[[object]]]]
- [CODE(HTMLe)@@en[[[output]]]]
- [CODE(HTMLe)@@en[[[select]]]]
- [CODE(HTMLe)@@en[[[textarea]]]]
]FIG]

** 一覧

[127] 各分類に属する[[要素]]の一覧は >>126 にあります。

[REFS[
- [126] [CITE[data-web-defs/data/elements.json at master · manakai/data-web-defs]] ([TIME[2014-04-06 02:53:24 +09:00]] 版) <https://github.com/manakai/data-web-defs/blob/master/data/elements.json>
]REFS]

* フォーム所有子

[72] [[フォーム所有子]]は、[[null]] または [CODE(HTMLe)@@en[[[form]]]] [[要素]]1つです
[SRC[>>24]]。

- [74] [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]が [CODE(HTMLa)@@en[[[form]]]] [[要素]]の [[ID]]
を正しく指していれば、その [CODE(HTMLa)@@en[[[form]]]] [[要素]]が[[フォーム所有子]]です。
- [73] [[直近祖先]]の [CODE(HTMLe)@@en[[[form]]]] [[要素]]があれば、それが[[フォーム所有子]]です。
- [75] そうでなければ、[[フォーム所有子]]は [[null]] です。

** フォーム所有子の変化

[108] [[フォーム所有者]]は次の場合に変化します。

[FIG[
- [80] [[フォーム被関連付け要素]]が作られた時点では[[フォーム所有者]]は [[null]] でなければ[['''なりません''']] [SRC[>>24]]。
- [81] [[フォーム被関連付け要素]]が[[フォーム]]に[DFN[[RUBYB[関連付けられる]@@en[associated]]]] ([DFN[[RUBYB[フォーム関連付け]@@en[form association]]]]) と、[[フォーム所有者]]はその[[フォーム]]に設定されなければ[['''なりません''']] [SRC[>>24]]。
- [82] [[フォーム被関連付け要素]]かその[[祖先]]が[[文書に挿入]]されたら、[[フォーム所有者を再設定]]しなければ[['''なりません''']] [SRC[>>24]]。
- [120] [[フォーム被関連付け要素]]と[[親節点]]が別の [[home subtree]] になったとき、[[フォーム所有者を再設定]]してなければ[['''なりません''']] [SRC[>>24]]。
- [84] [[フォーム被関連付け要素]]の [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]が追加・変更・削除された時は、[[フォーム所有者を再設定]]しなければ[['''なりません''']] [SRC[>>24]]。
- [83] [[フォーム被関連付け要素]]が [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]を持つ場合、[[文書]]内の[[要素]]の [[ID]] が変化したり、[[ID]] を持った[[要素]]が[[文書]]に追加・削除されたりしたときは、[[フォーム所有者を再設定]]しなければ[['''なりません''']] [SRC[>>24]]。

- [95] [[HTML構文解析器]]による[RUBYB[[[HTML要素の挿入]]]@@en[insert an HTML element]]によって[[フォーム被関連付け要素]]が作られた場合であって、 [CODE(HTMLe)@@en[[[template]]]] [[要素]]の[[子孫]]でなく、[[[CODE(HTMLe)@@en[form]]要素指示子]]が [[null]] ではなく、[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]がなく、挿入先が場合、[[[CODE(HTMLe)@@en[form]]要素指示子]]と同じ[[家部分木]]に属する場合には、挿入の直前に[[[CODE(HTMLe)@@en[form]]要素指示子]]が指す [CODE(HTMLe)@@en[[[form]]]] [[要素]]を[RUBYB[関連付け]@@en[associate]]しなければなりません
[SRC[>>94]]。
]FIG]

** フォーム所有者の再設定

[85] [[フォーム被関連付け要素]]の[DFN[[RUBYB[フォーム所有者を再設定]@@en[reset the form owner]]]]する場合は次のようにしなければなりません [SRC[>>24]]。
= [86] [[フォーム所有者]]が [[null]] でなく、[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]がなく、[[祖先鎖]]が変化した後であっても[[フォーム所有者]]が[[直近祖先]]たる [CODE(HTMLa)@@en[[[form]]]] [[要素]]のままなら、
== 何もせずに終わります。
= [87] [[フォーム所有子]]を [[null]] とします。
= [88] [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]があれば、
== [89] [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]の値と一致する [[ID]] を持った[[文書]]中の最初の[[要素]]が
[CODE(HTMLe)@@en[[[form]]]] [[要素]]なら、
=== その [CODE(HTMLe)@@en[[[form]]]] と[RUBYB[関連付け]@@en[associate]]ます。
== 終わります。
= [90] そうではなく、[[祖先]]に [CODE(HTMLe)@@en[[[form]]]] [[要素]]があるなら、
== [[直近祖先]]たる [CODE(HTMLe)@@en[[[form]]]] [[要素]]と[RUBYB[関連付け]@@en[associate]]ます。
= [91] そうでないなら、どの[[フォーム]]とも関連付けないままにします。

[92] つまり、>>73-75 のような状況を新たな木構造の元で再構築するということですね。

** 例

[EG[
[93] 
[PRE(HTML bad example code)[
...
 <form id="a">
  <div id="b"></div>
 </form>
 <script>
  document.getElementById('b').innerHTML =
     '<table><tr><td><form id="c"><input id="d"></table>' +
     '<input id="e">';
 </script>
...
]PRE]

[CODE(HTML)@@en[e]] [[要素]]の[[フォーム所有子]]は [CODE(HTML)@@en[c]] ではなく
[CODE(HTML)@@en[a]] になります [SRC[>>24]]。

[CODE(HTMLa)@@en[[[innerHTML]]]] が内部的に[[HTML構文解析器]]で解釈を終えた時点では、確かに
[CODE(HTML)@@en[e]] の[[フォーム所有者]]は [CODE(HTML)@@en[c]] です ([CODE(HTML)@@en[[[form]]]]
[[要素]]が閉じられていませんから)。ところが [CODE(HTML)@@en[e]] [[要素]]が [CODE(HTML)@@en[b]]
[[要素]]の[[子供]]となった瞬間に、[[フォーム所有者の再設定]]が起こり、
[CODE(HTML)@@en[a]] に選び直されます。
]EG]

* form 要素指示子

[96] [[HTML構文解析器]]の [DFN[[CODE(HTMLe)@@en[form]] [RUBYB[要素指示子]@@en[element pointer]]]]は、
最後に開かれて閉じていない [CODE(HTMLe)@@en[[[form]]]] [[要素]]を指すものです
[SRC[>>98]]。

** 仕様書

[REFS[
- [97] [[HTML Standard]]
-- [98] '''<http://www.whatwg.org/specs/web-apps/current-work/complete.html#form-element-pointer>'''
-- [100] <http://www.whatwg.org/specs/web-apps/current-work/complete.html#insert-an-html-element>
-- [101] <http://www.whatwg.org/specs/web-apps/current-work/complete.html#parsing-html-fragments>
]REFS]

** 値の変化

- [99] 初期状態では値は [[null]] です [SRC[>>98]]。
- [102] [[HTML構文解析器]]によって [CODE(HTMLe)@@en[[[form]]]] [[要素]]が作られるときに、その[[要素]]に設定されます。
- [103] [[HTML構文解析器]]によって [CODE(HTMLe)@@en[[[form]]]] [[要素]]が閉じられるときに、 [[null]] に設定されます。
- [104] [[HTML素片構文解析算法]]において、文脈[[要素]]を含む[[祖先]]のいずれかが [CODE(HTMLe)@@en[[[form]]]] [[要素]]なら、[[直近祖先]]たる [CODE(HTMLe)@@en[[[form]]]] [[要素]]に設定されます
[SRC[>>101]]。

[105] つまり、[[開始タグ]]があって[[終了タグ]]が(まだ)ない最後の [CODE(HTMLe)@@en[[[form]]]] 
[[要素]]を指している状態になっています。

** 構文解析への影響

[106] [[[CODE(HTMLe)@@en[form]]要素指示子]]が [CODE(HTMLe)@@en[[[form]]]] [[要素]]を指している間は
[[HTML構文解析器]]が [CODE(HTMLe)@@en[[[form]]]] [[要素]]を新たに作ることはありません。
つまり、 [CODE(HTMLe)@@en[[[form]]]] [[要素]]の入れ子状態を [[HTML構文解析器]]自身が作り出すことはありません。

[119] [CODE(HTMLe)@@en[[[template]]]] [[要素]]内では[[[CODE(HTMLe)@@en[form]]要素指示子]]は無視され、
[[フォーム制御子]]と[[フォーム]]の関連付けは行われません。

** 関連

[107] [[[CODE(HTMLe)@@en[form]]要素指示子]]は、[[HTML構文解析器]]によって[[フォーム被関連付け要素]]が[[文書]]に挿入される時点で[[フォーム所有者]]の決定に使われます
(>>95)。

[109] [[フォーム所有者の再設定]]が起こる (>>108) と
[[[CODE(HTMLe)@@en[form]]要素指示子]]の影響で生じた[[フォーム]]との関連付けは解消されます。
従って[[[CODE(HTMLe)@@en[form]]要素指示子]]の影響は[[構文解析]]の直後に限定されます
[WEAK[(といっても[[構文解析]]は [CODE(DOMa)@@en[[[innerHTML]]]] などでいつでも発生し得ます)]]。
[[[CODE(HTMLe)@@en[form]]要素指示子]]がなかった場合との違いが生じるのは、
[CODE(HTMLe)@@en[[[form]]]] [[要素]]が[[終了タグ]]無しで閉じられた後に続く[[フォーム制御子]]が、 [CODE(HTMLe)@@en[[[form]]]] [[要素]]の[[子孫]]でもないのに関連付けられる場合だけです。

;; [110] [[HTML素片構文解析算法]]の中で [CODE(HTMLe)@@en[[[form]]]] [[要素]]が閉じられると、
その[[文脈節点]]の[[先祖]]である [CODE(HTMLe)@@en[[[form]]]] [[要素]]の[[子孫]]であるにも関わらず関連付けられる[[フォーム制御子]]が発生しそうに思えますが、
そのような状況で [CODE(HTMLe)@@en[[[form]]]] [[要素]]を開くことがそもそもできないはずです。

* [CODE(HTMLa)@@en[form]] 属性 (HTML)

@@@@ 以下は古い内容が含まれます。

[40]
[[HTML]] の[[フォーム制御子]]等の
[DFN[[CODE(HTMLa)@@en[form]] [[属性]]]]は、
[[フォーム制御子]]が所属する[[フォーム]]を指定します。

[41]
:状態:[[WHATWG]] [[WD]]
:[[要素型]]:[[フォーム制御子]]、[CODE(HTMLe)@@en[[[fieldset]]]]
:[[属性名]]:[CODE(HTMLa)@@en[[[form]]]]
([Q@@en[[[form]]]] ([Q@@en[[[フォーム]]]]) より)
:[[属性値]]:[CODE@@en[[[IDREFS]]]] (>>42)
:[[既定値]]:([[先祖]]により決定) (>>43)

** 仕様書

- [76] [[Web Applications 1.0]]
-- [77] '''<http://www.whatwg.org/specs/web-apps/current-work/complete.html#form-owner>'''

** 属性値

[79] [CODE(HTMLa)@@en[[[form]]]] [[内容属性]]の[[属性値]]は、同じ[[文書]]の
[CODE(HTMLe)@@en[[[form]]]] [[要素]]の [[ID]] でなければ[['''なりません''']] [SRC[>>77]]。

;;
[42]
[[Web Forms 2.0]] では、
[CODE(HTMLa)@@en[[[form]]]] [[属性値]]は、
零個以上の
[CODE(HTMLe)@@en[[[form]]]] [[要素]]の [CODE(XML)@@en[[[ID]]]]
の[[空白]]区切り[[並び]]とされていました
[SRC@@en[WF2 2.8]]。

** フォームの決定

[49]
[[利用者エージェント]]は、[[フォーム制御子]]や
[CODE(HTMLe)@@en[[[fieldset]]]]
[[要素]]に関連付ける[[フォーム]]を次のように決定[['''しなければなりません''']]
[SRC@@en[WF2 2.8]]:
= [CODE(HTMLa)@@en[[[form]]]] [[属性]]があれば、
それに従います。
= [[直近]]の[[先祖]]である [CODE(HTMLe)@@en[[[form]]]]
[[要素]]か、 [CODE(HTMLa)@@en[[[form]]]] [[属性]]がある
[CODE(HTMLe)@@en[[[fieldset]]]] [[要素]]があれば、
その[[フォーム]]とします。
= なければ、どの[[フォーム]]にも関連付けないとします。

[[#comment]]


** フォーム操作との関係

[50]
[[提出]][[ボタン]] ([CODE(HTML)@@en[[[submit]]]]) や[[画像]]
([CODE(HTMLe)@@en[[[image]]]]) は、
関連付けられた最初の[[フォーム]]のみを[[提出]][['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

[51]
[[再設定]][[ボタン]] ([CODE(HTML)@@en[[[reset]]]])
は、関連付けられたすべての[[フォーム]]を[[再設定]][['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

[[#comment]]


** 誤り処理

[52]
[[文書]]中に複数現れる [CODE(XML)@@en[[[ID]]]]
が [CODE(HTMLa)@@en[[[form]]]] に指定された時に選択される[[フォーム]]は、
[CODE(DOMm)@@en[[[getElementById]]]] [[メソッド]]と同じものと[['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

;; [CODE(DOMm)@@en[[[getElementById]]]] [[メソッド]]は、
その場合の動作は[[未定義]]としています。
しかし、 [CODE(HTMLa)@@en[[[form]]]]
もそれと同じように動作しなければならない、ということです。

[53]
[CODE(HTMLa)@@en[[[form]]]]
[[属性値]]中に同じ[[フォーム]]を複数回指定[['''してはなりません''']]。
[[利用者エージェント]]は、その場合、
最初の指定を除き、無視[['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

** 例

[54]
[PRE(HTML example code)[
<table>
 <thead>
  <tr>
   <th>Name</th>
   <th>Value</th>
   <th>Action</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>
    <form id="edit1" action="/edit" method="post">
     <input type="hidden" name="id" value="1"/>
     <input type="text" name="name" value="First Row"/>
    </form>
   </td>
   <td>
    <input form="edit1" type="text" name="value"/>
   </td>
   <td>
    <input form="edit1" type="submit" name="Edit"/>
   </td>
  </tr>
  <tr>
   <td>
    <form id="edit2" action="/edit" method="post">
     <input type="hidden" name="id" value="2"/>
     <input type="text" name="name" value="Second Row"/>
    </form>
   </td>
   <td>
    <input form="edit2" type="text" name="value"/>
   </td>
   <td>
    <input form="edit2" type="submit" name="Edit"/>
   </td>
  </tr>
 </tbody>
</table>
]PRE]

[[列]]ごとに別の[[フォーム]]になっています。
[SRC@@en[WF2 2.8]]
[CODE(HTMLe)@@en[[tbody]]]] の[[内容モデル]]の定義から、
[[Web Forms 1.0]] ではこのように[[表]]と[[フォーム]]を組合せることができませんでした。

[55]
[PRE(HTML example code)[
<form action="test.cgi">
 <input type="text" name="q" form="fg fy">
 <input type="submit" name="t" value="Test">
</form>
<form id="fg" action="google.cgi"><input type="submit" value="Google"></form>
<form id="fy" action="yahoo.cgi"><input type="submit" value="Yahoo"></form>
]PRE]

テキスト欄は2つの[[フォーム]]に関連付けられています。
また、[[フォーム]]が3つあり、それぞれが[[提出]][[ボタン]]を持っています。
[SRC@@en[WF2 2.8]]

[Q@@en[Google]] と [Q@@en[Yahoo]] の2つのボタンは、
それぞれ別の[[フォーム処理エージェント]]に、
同じテキスト欄の内容を[[提出]]します。

最初の [Q@@en[Test]] は、 [[Web Forms 2.0]]
に適合した[[利用者エージェント]]では、
テキスト欄の内容を[[提出]]しません。
未対応の[[利用者エージェント]]はテキスト欄の内容を[[提出]]します。
これは古い[[利用者エージェント]]のための fallback
として使うことができます。

* 歴史

[REFS[
- [61] [CITE[Cougar: ideas for <A>,<INPUT>]] ([TIME[2004-08-06 01:45:46 +09:00]] 版) <http://lists.w3.org/Archives/Public/www-html/1996Jul/0537.html>
]REFS]

[128] >>61 では後の [CODE(HTMLa)@@en[[[form]]]] [[属性]]に相当する [CODE(HTMLa)@@en[[[for]]]]
[[属性]]が提案されていました。

** Web Forms 2.0

[44] [CODE(HTMLa)@@en[[[form]]]] [[属性]]は [[Web Forms 2.0]] で導入されました。

[REFS[
-[78] [[Web Forms 2.0]] [CSECTION@@en[2.8. The [CODE(HTMLa)@@en[[[form]]]] attribute]]
<http://www.whatwg.org/specs/web-forms/current-work/#formAttribute>
]REFS]

*** 処理モデル

[43]
[[フォーム制御子]]は通常[[先祖]]の [CODE(HTMLe)@@en[[[form]]]]
と関連付けられますが、
[CODE(HTMLa)@@en[[[form]]]] [[属性]]はこれを上書きし、
関連付ける[[フォーム]]を明示的に指定します。
[SRC@@en[WF2 2.8]]

[46]
指定された [CODE(XML)@@en[[[ID]]]] のうち、
[[文書]]中の[[要素]]を[[識別]]しないものや、
[CODE(HTMLe)@@en[[[form]]]] [[要素]]を[[識別]]しないものは、
無視[['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

[47]
[[空文字列]]を[[属性値]]として指定する
(か、 >>46 の無視の結果 [CODE(XML)@@en[[[ID]]]]
が1つも含まれない) と、
[[フォーム制御子]]はどの[[フォーム]]にも関連付けられていない状態となります。
[SRC@@en[WF2 2.8]]

[48]
[CODE(HTMLe)@@en[[[fieldset]]]] [[要素]]に指定した場合は、
その[[子孫]]の[[フォーム制御子]]を関連付ける[[フォーム]]を指定します。
[SRC@@en[WF2 2.8]]

;; [[子孫]]の[[フォーム制御子]]や [CODE(HTMLe)@@en[[[fieldset]]]]
で更に [CODE(HTMLa)@@en[[[form]]]] が指定されている場合は、
そちらが優先します。

** HTML5

[129] [[WF2]] はその後 [[HTML5]] (旧 [[Web Applications 1.0]]、現在の [[HTML Standard]]) に統合されました。

[70] 一瞬だけ [[HTML5]] で [CODE(HTMLe)@@en[[[legend]]]] [[要素]]にも
[CODE(HTMLa)@@en[[[form]]]] [[属性]]が追加されていましたが、すぐに削除されました。

[136] [CODE(HTMLe)@@en[[[meter]]]] と [CODE(HTMLe)@@en[[[progress]]]] を[[フォーム被関連付け可能要素]]の一部である[[ラベル付け可能要素]]とするために
>>134 で [CODE(HTMLa)@@en[[[form]]]] [[属性]]が追加されましたが、 >>135 で[[ラベル付け可能要素]]が[[フォーム被関連付け可能要素]]でなくても良いこととされ、
[CODE(HTMLa)@@en[[[form]]]] [[属性]]も削除されました。

[REFS[
- [134] [CITE@@en[Web Applications 1.0 r4531       Make <progress>, <meter>, and <output> labelable with <label>.]] ([TIME[2010-01-07 12:40:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=4530&to=4531>
- [135] [CITE@@en[Web Applications 1.0 r6221      Remove <progress form> and <meter form> since they are basically useless.]] ([TIME[2011-06-14 09:33:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=6220&to=6221>
]REFS]

[130] [[HTML5]] では[[フォーム所有者]]の概念の詳細や[[構文解析]]との相互関係が歴史上はじめて明文化されました。

[REFS[
- [111] [CITE@@en[Bug 17845 – Some algorithms in the HTML Parser must also override the "reset the form owner" (e.g., Adoption Agency algorithm)]]
( ([TIME[2013-02-17 10:48:51 +09:00]] 版))
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=17845>
- [112] [CITE[IRC logs: freenode / #whatwg / 20130213]]
( ([TIME[2013-02-16 19:46:58 +09:00]] 版))
<http://krijnhoetmer.nl/irc-logs/whatwg/20130213>
- [113] [CITE@@en[Web Applications 1.0 r8186 Clarify which call to 'reset the form owner' is suppressed.]]
( ([TIME[2013-09-14 08:31:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=8185&to=8186>
- [114] [CITE[''''''[''''''whatwg'''''']'''''' Form-associated elements and the parser]]
( ([TIME[2013-09-17 00:43:23 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040843.html>
- [115] [CITE[''''''[''''''whatwg'''''']'''''' Elements should be removed from the past names map once it's no longer associated with the form element]]
( ([TIME[2013-09-26 22:45:44 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040898.html>
- [116] [CITE@@en[Web Applications 1.0 r8188       Make parser-driven form element pointer associations not happen when the element is inserted into a different home subtree than the form element, to avoid cross-subtree associations (which otherwise wouldn't be possible).]] ([TIME[2013-09-17 02:35:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8187&to=8188>
- [117] [CITE@@en[Web Applications 1.0 r8331       Change how the form element pointer affects parsing <template> elements, to reduce weirdness in templates (e.g. before you couldn't have a template that contained a form if it was itself inside a form).]] ([TIME[2013-12-05 04:02:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8330&to=8331>
- [118] [CITE@@en[Web Applications 1.0 r8337       innerHTML on template contents works like outside templates, when it comes to forms.]] ([TIME[2013-12-10 06:17:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8336&to=8337>
- [121] [CITE@@en[Web Applications 1.0 r8446     Turns out browsers reset the form owner not just when a node is taken from a document, but also when it's taken from a subtree. which makes sense.]]
( ([TIME[2014-01-31 06:51:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=8445&to=8446>
- [131] [CITE@@en[Web Applications 1.0 r8009     <img> is form-associated (because legacy), but doesn't have a form='' attribute (because sanity). So... update crazy town to be even more crazy.]] ([TIME[2013-07-03 06:17:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8008&to=8009>
]REFS]

[140] [CITE@@en[HTML Speech Incubator Group Final Report]]
( ([TIME[2011-12-05 17:46:22 +09:00]] 版))
<http://www.w3.org/2005/Incubator/htmlspeech/XGR-htmlspeech-20111206/#dfn-form>@


1.31
log
@updated by (anon)
@
text
@d469 5
a473 1
]REFS]@


1.30
log
@updated by (anon)
@
text
@d28 1
a28 1
-- [19] [[名札付け可能要素]]
d35 2
d65 2
@


1.29
log
@updated by (anon)
@
text
@d55 8
d431 9
d465 1
a465 1
]REFS]
@


1.28
log
@updated by (anon)
@
text
@d22 13
d40 1
d44 1
a44 1
- [9] [CODE(HTMLe)@@en[[[meter]]]]
d47 1
a47 1
- [12] [CODE(HTMLe)@@en[[[progress]]]]
d55 18
a72 1
** 小分類の一覧
d74 5
a78 7
- [17] [[フォーム被関連付け要素]]
-- [18] [[被列挙要素]]
-- [19] [[名札付け可能要素]]
-- [20] [[提出可能要素]]
--- [22] [[ボタン]]
---- [23] [[提出ボタン]]
-- [21] [[再設定可能要素]]
a290 56
** 歴史

[61]
[CITE[Cougar: ideas for <A>,<INPUT>]] ([TIME[2004-08-06 01:45:46 +09:00]] 版) <http://lists.w3.org/Archives/Public/www-html/1996Jul/0537.html>

[CODE(HTMLa)@@en[[[form]]]] [[属性]]に相当する [CODE(HTMLa)@@en[[[for]]]]
[[属性]]が提案されていました。

*** Web Forms 2.0

[56]
この[[属性]]は [[Web Forms 2.0]] で導入されました。

**** 仕様書

-[44] [[Web Forms 2.0]]
--[78] [CSECTION@@en[2.8. The [CODE(HTMLa)@@en[[[form]]]] attribute]]
<http://www.whatwg.org/specs/web-forms/current-work/#formAttribute>

**** 処理モデル

[43]
[[フォーム制御子]]は通常[[先祖]]の [CODE(HTMLe)@@en[[[form]]]]
と関連付けられますが、
[CODE(HTMLa)@@en[[[form]]]] [[属性]]はこれを上書きし、
関連付ける[[フォーム]]を明示的に指定します。
[SRC@@en[WF2 2.8]]

[46]
指定された [CODE(XML)@@en[[[ID]]]] のうち、
[[文書]]中の[[要素]]を[[識別]]しないものや、
[CODE(HTMLe)@@en[[[form]]]] [[要素]]を[[識別]]しないものは、
無視[['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

[47]
[[空文字列]]を[[属性値]]として指定する
(か、 >>46 の無視の結果 [CODE(XML)@@en[[[ID]]]]
が1つも含まれない) と、
[[フォーム制御子]]はどの[[フォーム]]にも関連付けられていない状態となります。
[SRC@@en[WF2 2.8]]

[48]
[CODE(HTMLe)@@en[[[fieldset]]]] [[要素]]に指定した場合は、
その[[子孫]]の[[フォーム制御子]]を関連付ける[[フォーム]]を指定します。
[SRC@@en[WF2 2.8]]

;; [[子孫]]の[[フォーム制御子]]や [CODE(HTMLe)@@en[[[fieldset]]]]
で更に [CODE(HTMLa)@@en[[[form]]]] が指定されている場合は、
そちらが優先します。

*** HTML5

[70] 一瞬だけ [[HTML5]] で [CODE(HTMLe)@@en[[[legend]]]] [[要素]]にも
[CODE(HTMLa)@@en[[[form]]]] [[属性]]が追加されていましたが、すぐに削除されました。

d366 58
a423 1
* メモ
d425 2
a426 1
[111] [CITE@@en[Bug 17845 – Some algorithms in the HTML Parser must also override the "reset the form owner" (e.g., Adoption Agency algorithm)]]
d429 1
a429 2

[112] [CITE[IRC logs: freenode / #whatwg / 20130213]]
d432 1
a432 2

[113] [CITE@@en[Web Applications 1.0 r8186 Clarify which call to 'reset the form owner' is suppressed.]]
d435 1
a435 3


[114] [CITE[''''''[''''''whatwg'''''']'''''' Form-associated elements and the parser]]
d438 1
a438 2

[115] [CITE[''''''[''''''whatwg'''''']'''''' Elements should be removed from the past names map once it's no longer associated with the form element]]
d441 8
a448 11

[116] [CITE@@en[Web Applications 1.0 r8188       Make parser-driven form element pointer associations not happen when the element is inserted into a different home subtree than the form element, to avoid cross-subtree associations (which otherwise wouldn't be possible).]] ([TIME[2013-09-17 02:35:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8187&to=8188>

[117] [CITE@@en[Web Applications 1.0 r8331       Change how the form element pointer affects parsing <template> elements, to reduce weirdness in templates (e.g. before you couldn't have a template that contained a form if it was itself inside a form).]] ([TIME[2013-12-05 04:02:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8330&to=8331>

[118] [CITE@@en[Web Applications 1.0 r8337       innerHTML on template contents works like outside templates, when it comes to forms.]] ([TIME[2013-12-10 06:17:00 +09:00]] 版) <http://html5.org/tools/web-apps-tracker?from=8336&to=8337>


[121] [CITE@@en[Web Applications 1.0 r8446     Turns out browsers reset the form owner not just when a node is taken from a document, but also when it's taken from a subtree. which makes sense.]]
( ([TIME[2014-01-31 06:51:00 +09:00]] 版))
<http://html5.org/tools/web-apps-tracker?from=8445&to=8446>@


1.27
log
@updated by (anon)
@
text
@d421 5
@


1.26
log
@updated by (anon)
@
text
@d65 1
d68 2
a69 1
- [82] [[フォーム被関連付け要素]]の[RUBYB[[[祖先鎖]]]@@en[ancestor chain]]に異動があれば、[[フォーム所有者を再設定]]しなければ[['''なりません''']] [SRC[>>24]]。
d72 1
d75 1
@


1.25
log
@updated by (anon)
@
text
@d149 3
d413 4
@


1.24
log
@updated by (anon)
@
text
@d11 2
a12 1
- [2] [[Web Applications 1.0]] ([[HTML5]])
d18 1
d24 1
d36 1
d70 1
a70 1
- [95] [[HTML構文解析器]]による[RUBYB[[[HTML要素の挿入]]]@@en[insert an HTML element]]によって[[フォーム被関連付け要素]]が作られた場合であって、[[[CODE(HTMLe)@@en[form]]要素指示子]]が [[null]] ではなく、[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]がない場合、挿入の直前に[[[CODE(HTMLe)@@en[form]]要素指示子]]が指す [CODE(HTMLe)@@en[[[form]]]] [[要素]]を[RUBYB[関連付け]@@en[associate]]しなければなりません
d92 1
d115 1
d125 2
a126 1
- [97] [[Web Applications 1.0]] ([[HTML5]])
d130 1
d386 1
d399 11
a409 9


[114] [CITE[''''''[''''''whatwg'''''']'''''' Form-associated elements and the parser]]
( ([TIME[2013-09-17 00:43:23 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040843.html>

[115] [CITE[''''''[''''''whatwg'''''']'''''' Elements should be removed from the past names map once it's no longer associated with the form element]]
( ([TIME[2013-09-26 22:45:44 +09:00]] 版))
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040898.html>@


1.23
log
@updated by (anon)
@
text
@d394 5
a398 1
<http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2013-September/040843.html>@


1.22
log
@updated by (anon)
@
text
@d390 5
@


1.21
log
@updated by (anon)
@
text
@d377 13
a389 9


[111] [CITE@@en[Bug 17845 – Some algorithms in the HTML Parser must also override the "reset the form owner" (e.g., Adoption Agency algorithm)]]
( ([TIME[2013-02-17 10:48:51 +09:00]] 版))
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=17845>

[112] [CITE[IRC logs: freenode / #whatwg / 20130213]]
( ([TIME[2013-02-16 19:46:58 +09:00]] 版))
<http://krijnhoetmer.nl/irc-logs/whatwg/20130213>@


1.20
log
@updated by (anon)
@
text
@d381 5
a385 1
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=17845>@


1.19
log
@updated by (anon)
@
text
@d377 5
@


1.18
log
@updated by (anon)
@
text
@d1 1
a1 1
[1] [DFN[[RUBYB[[[フォーム被関連付け要素]]]@@en[form-associated element]]]]は、[[フォーム所有者]]を持つことができる[[要素]]です
d3 1
a3 1
これを[[要素]]の[DFN[[RUBYB[[[フォーム所有者]]]@@en[form owner]]]]といいます [SRC[>>24]]。
d5 2
a6 2
[71] [[フォーム所有者]]は[[木構造]]に基づき自動的に決まりますが、 [CODE(HTMLa)@@en[[[form]]]]
[[内容属性]]によって[[著者]]が上書きすることもできます。どの[[要素]]が[[フォーム所有者]]であるかは
d47 1
a47 1
* フォーム所有者
d49 1
a49 1
[72] [[フォーム所有者]]は、[[null]] または [CODE(HTMLe)@@en[[[form]]]] [[要素]]1つです
d53 3
a55 3
を正しく指していれば、その [CODE(HTMLa)@@en[[[form]]]] [[要素]]が[[フォーム所有者]]です。
- [73] [[直近祖先]]の [CODE(HTMLe)@@en[[[form]]]] [[要素]]があれば、それが[[フォーム所有者]]です。
- [75] そうでなければ、[[フォーム所有者]]は [[null]] です。
d57 1
a57 1
** フォーム所有者の変化
d74 1
a74 1
= [87] [[フォーム所有者]]を [[null]] とします。
d102 1
a102 1
[CODE(HTML)@@en[e]] [[要素]]の[[フォーム所有者]]は [CODE(HTML)@@en[c]] ではなく
@


1.17
log
@updated by (anon)
@
text
@d148 8
@


1.16
log
@updated by (anon)
@
text
@d59 2
d146 3
@


1.15
log
@updated by (anon)
@
text
@d109 35
@


1.14
log
@updated by (anon)
@
text
@d64 2
a65 1
- [95] [[HTML構文解析器]]による[RUBYB[[[HTML要素の挿入]]]@@en[insert an HTML element]]によって[[フォーム被関連付け要素]]が作られた場合であって、[[[CODE(HTMLe)@@en[form]]要素指示子]]が [[null]] ではなく、[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]がない場合、挿入の直前に[[[CODE(HTMLe)@@en[form]]要素指示子]]が指す [CODE(HTMLe)@@en[[[form]]]] [[要素]]を[RUBYB[関連付け]@@en[associate]]しなければなりません。
@


1.13
log
@updated by (anon)
@
text
@d16 1
d64 1
d110 2
@


1.12
log
@updated by (anon)
@
text
@d81 25
@


1.11
log
@updated by (anon)
@
text
@d64 17
@


1.10
log
@updated by (anon)
@
text
@d52 1
a52 1
を正しく差していれば、その [CODE(HTMLa)@@en[[[form]]]] [[要素]]が[[フォーム所有者]]です。
d56 8
@


1.9
log
@updated by (anon)
@
text
@d46 10
d71 4
a74 4
[44] 仕様書:
- [[Web Forms 2.0]]
-- [CSECTION@@en[2.8. The [CODE(HTMLa)@@en[[[form]]]] attribute]]
<IW:WF2:"#formAttribute">
d78 4
d83 1
d87 2
a88 35
の[[空白]]区切り[[並び]]です。
[SRC@@en[WF2 2.8]]

[43]
[[フォーム制御子]]は通常[[先祖]]の [CODE(HTMLe)@@en[[[form]]]]
と関連付けられますが、
[CODE(HTMLa)@@en[[[form]]]] [[属性]]はこれを上書きし、
関連付ける[[フォーム]]を明示的に指定します。
[SRC@@en[WF2 2.8]]

[46]
指定された [CODE(XML)@@en[[[ID]]]] のうち、
[[文書]]中の[[要素]]を[[識別]]しないものや、
[CODE(HTMLe)@@en[[[form]]]] [[要素]]を[[識別]]しないものは、
無視[['''しなければなりません''']]。
[SRC@@en[WF2 2.8]]

[47]
[[空文字列]]を[[属性値]]として指定する
(か、 >>46 の無視の結果 [CODE(XML)@@en[[[ID]]]]
が1つも含まれない) と、
[[フォーム制御子]]はどの[[フォーム]]にも関連付けられていない状態となります。
[SRC@@en[WF2 2.8]]

[48]
[CODE(HTMLe)@@en[[[fieldset]]]] [[要素]]に指定した場合は、
その[[子孫]]の[[フォーム制御子]]を関連付ける[[フォーム]]を指定します。
[SRC@@en[WF2 2.8]]

;; [[子孫]]の[[フォーム制御子]]や [CODE(HTMLe)@@en[[[fieldset]]]]
で更に [CODE(HTMLa)@@en[[[form]]]] が指定されている場合は、
そちらが優先します。

[[#comment]]

d144 4
a147 1
[[#comment]]
d149 2
d152 1
a152 1
** 歴史
d157 21
d179 15
a193 2
[61]
[CITE[Cougar: ideas for <A>,<INPUT>]] ([TIME[2004-08-06 01:45:46 +09:00]] 版) <http://lists.w3.org/Archives/Public/www-html/1996Jul/0537.html>
d195 1
a195 2
[CODE(HTMLa)@@en[[[form]]]] [[属性]]に相当する [CODE(HTMLa)@@en[[[for]]]]
[[属性]]が提案されていました。
a199 1

@


1.8
log
@updated by (anon)
@
text
@a0 2
* フォーム被関連付け要素とフォーム所有者

d5 5
a9 1
** 仕様書
d17 1
a17 1
** 所属要素
d19 1
a19 1
*** 所属する要素
d36 1
a36 1
*** 所属する小グループ
a45 6
** 性質

[16] [[フォーム被関連付け要素]]の[[フォーム所有者]]は [CODE(DOMa)@@en[[[form]]]]
[[IDL属性]]を通じてアクセスできます。また、[[フォーム所有者]]を明示的に指定するための
[CODE(HTMLa)@@en[[[form]]]] [[内容属性]]を持っています。

@


1.7
log
@updated by (anon)
@
text
@d1 1
a1 1
* フォーム被関連付け要素
d4 2
a5 1
[SRC[>>3]]。
@


1.6
log
@updated by (anon)
@
text
@d1 2
d6 1
a6 1
* 仕様書
d14 1
a14 1
* 所属要素
d16 1
a16 1
** 所属する要素
d33 1
a33 1
** 所属する小グループ
d43 1
a43 1
* 性質
d48 210
@


1.5
log
@updated by (anon)
@
text
@d8 3
a10 1
-- [24] <http://www.whatwg.org/specs/web-apps/current-work/complete.html#association-of-controls-and-forms>
@


1.4
log
@updated by (anon)
@
text
@d7 2
a8 1
-- [3] <http://www.whatwg.org/specs/web-apps/current-work/complete.html#form-associated-element>
@


1.3
log
@updated by (anon)
@
text
@d9 1
a9 1
* 所属
@


1.2
log
@updated by (anon)
@
text
@d9 3
a11 1
* フォーム被関連付け要素の一覧
d28 10
@


1.1
log
@created by (anon)
@
text
@d29 2
a30 1
[[IDL属性]]を通じてアクセスできます。
@

